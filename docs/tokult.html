<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>tokult package &mdash; tokult  documentation</title>
      <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
        <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
        <script src="_static/doctools.js"></script>
        <script src="_static/sphinx_highlight.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="prev" title="tokult" href="modules.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="index.html" class="icon icon-home">
            tokult
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="gettingstarted.html">Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="visualization.html">Visualization</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Tips:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="how_to_make_noises.html">How to make mock noises?</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Modules:</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="modules.html">tokult</a><ul class="current">
<li class="toctree-l2 current"><a class="current reference internal" href="#">tokult package</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#submodules">Submodules</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-tokult">Module contents</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#tokult.Tokult"><code class="docutils literal notranslate"><span class="pre">Tokult</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tokult.Cube"><code class="docutils literal notranslate"><span class="pre">Cube</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tokult.DataCube"><code class="docutils literal notranslate"><span class="pre">DataCube</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tokult.ModelCube"><code class="docutils literal notranslate"><span class="pre">ModelCube</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tokult.DirtyBeam"><code class="docutils literal notranslate"><span class="pre">DirtyBeam</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tokult.GravLens"><code class="docutils literal notranslate"><span class="pre">GravLens</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tokult.InputParams"><code class="docutils literal notranslate"><span class="pre">InputParams</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tokult.FitParamsWithUnits"><code class="docutils literal notranslate"><span class="pre">FitParamsWithUnits</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tokult.get_bound_params"><code class="docutils literal notranslate"><span class="pre">get_bound_params()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#module-tokult.common">tokult.common module</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-tokult.fitting">tokult.fitting module</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#tokult.fitting.InputParams"><code class="docutils literal notranslate"><span class="pre">InputParams</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tokult.fitting.FitParamsWithUnits"><code class="docutils literal notranslate"><span class="pre">FitParamsWithUnits</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tokult.fitting.get_bound_params"><code class="docutils literal notranslate"><span class="pre">get_bound_params()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#module-tokult.function">tokult.function module</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#tokult.function.gaussian"><code class="docutils literal notranslate"><span class="pre">gaussian()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tokult.function.reciprocal_exp"><code class="docutils literal notranslate"><span class="pre">reciprocal_exp()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tokult.function.freeman_disk"><code class="docutils literal notranslate"><span class="pre">freeman_disk()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tokult.function.maximum_rotation_velocity"><code class="docutils literal notranslate"><span class="pre">maximum_rotation_velocity()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#module-tokult.misc">tokult.misc module</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-tokult.casa">tokult.casa module</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-tokult.casa_dummy">tokult.casa_dummy module</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-tokult.core">tokult.core module</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#tokult.core.Tokult"><code class="docutils literal notranslate"><span class="pre">Tokult</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tokult.core.Cube"><code class="docutils literal notranslate"><span class="pre">Cube</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tokult.core.DataCube"><code class="docutils literal notranslate"><span class="pre">DataCube</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tokult.core.ModelCube"><code class="docutils literal notranslate"><span class="pre">ModelCube</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tokult.core.DirtyBeam"><code class="docutils literal notranslate"><span class="pre">DirtyBeam</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tokult.core.GravLens"><code class="docutils literal notranslate"><span class="pre">GravLens</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#module-tokult.example">tokult.example module</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">tokult package</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#submodules">Submodules</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-tokult">Module contents</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#tokult.Tokult"><code class="docutils literal notranslate"><span class="pre">Tokult</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#tokult.Tokult.launch"><code class="docutils literal notranslate"><span class="pre">Tokult.launch()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tokult.Tokult.imagefit"><code class="docutils literal notranslate"><span class="pre">Tokult.imagefit()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tokult.Tokult.uvfit"><code class="docutils literal notranslate"><span class="pre">Tokult.uvfit()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tokult.Tokult.initialguess"><code class="docutils literal notranslate"><span class="pre">Tokult.initialguess()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tokult.Tokult.use_region"><code class="docutils literal notranslate"><span class="pre">Tokult.use_region()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tokult.Tokult.use_redshifts"><code class="docutils literal notranslate"><span class="pre">Tokult.use_redshifts()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tokult.Tokult.change_datacube"><code class="docutils literal notranslate"><span class="pre">Tokult.change_datacube()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tokult.Tokult.change_dirtybeam"><code class="docutils literal notranslate"><span class="pre">Tokult.change_dirtybeam()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tokult.Tokult.change_gravlens"><code class="docutils literal notranslate"><span class="pre">Tokult.change_gravlens()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tokult.Tokult.construct_modelcube"><code class="docutils literal notranslate"><span class="pre">Tokult.construct_modelcube()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tokult.Tokult.calculate_normweight"><code class="docutils literal notranslate"><span class="pre">Tokult.calculate_normweight()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#tokult.Cube"><code class="docutils literal notranslate"><span class="pre">Cube</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#tokult.Cube.imageplane"><code class="docutils literal notranslate"><span class="pre">Cube.imageplane</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tokult.Cube.uvplane"><code class="docutils literal notranslate"><span class="pre">Cube.uvplane</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tokult.Cube.original"><code class="docutils literal notranslate"><span class="pre">Cube.original</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tokult.Cube.header"><code class="docutils literal notranslate"><span class="pre">Cube.header</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tokult.Cube.cutout"><code class="docutils literal notranslate"><span class="pre">Cube.cutout()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tokult.Cube.rms"><code class="docutils literal notranslate"><span class="pre">Cube.rms()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tokult.Cube.moment0"><code class="docutils literal notranslate"><span class="pre">Cube.moment0()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tokult.Cube.rms_moment0"><code class="docutils literal notranslate"><span class="pre">Cube.rms_moment0()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tokult.Cube.pixmoment1"><code class="docutils literal notranslate"><span class="pre">Cube.pixmoment1()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tokult.Cube.pixmoment2"><code class="docutils literal notranslate"><span class="pre">Cube.pixmoment2()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tokult.Cube.noisy"><code class="docutils literal notranslate"><span class="pre">Cube.noisy()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tokult.Cube.rfft2"><code class="docutils literal notranslate"><span class="pre">Cube.rfft2()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tokult.Cube.create_noise"><code class="docutils literal notranslate"><span class="pre">Cube.create_noise()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#tokult.DataCube"><code class="docutils literal notranslate"><span class="pre">DataCube</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#tokult.DataCube.perturbed"><code class="docutils literal notranslate"><span class="pre">DataCube.perturbed()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tokult.DataCube.create"><code class="docutils literal notranslate"><span class="pre">DataCube.create()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tokult.DataCube.loadfits"><code class="docutils literal notranslate"><span class="pre">DataCube.loadfits()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#tokult.ModelCube"><code class="docutils literal notranslate"><span class="pre">ModelCube</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#tokult.ModelCube.create"><code class="docutils literal notranslate"><span class="pre">ModelCube.create()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tokult.ModelCube.to_mockcube"><code class="docutils literal notranslate"><span class="pre">ModelCube.to_mockcube()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#tokult.DirtyBeam"><code class="docutils literal notranslate"><span class="pre">DirtyBeam</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#tokult.DirtyBeam.create"><code class="docutils literal notranslate"><span class="pre">DirtyBeam.create()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tokult.DirtyBeam.convolve"><code class="docutils literal notranslate"><span class="pre">DirtyBeam.convolve()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tokult.DirtyBeam.fullconvolve"><code class="docutils literal notranslate"><span class="pre">DirtyBeam.fullconvolve()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tokult.DirtyBeam.cutout"><code class="docutils literal notranslate"><span class="pre">DirtyBeam.cutout()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tokult.DirtyBeam.cutout_to_match_with"><code class="docutils literal notranslate"><span class="pre">DirtyBeam.cutout_to_match_with()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tokult.DirtyBeam.loadfits"><code class="docutils literal notranslate"><span class="pre">DirtyBeam.loadfits()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#tokult.GravLens"><code class="docutils literal notranslate"><span class="pre">GravLens</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#tokult.GravLens.create"><code class="docutils literal notranslate"><span class="pre">GravLens.create()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tokult.GravLens.lensing"><code class="docutils literal notranslate"><span class="pre">GravLens.lensing()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tokult.GravLens.create_interpolate_lensing"><code class="docutils literal notranslate"><span class="pre">GravLens.create_interpolate_lensing()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tokult.GravLens.LensingInterpolate"><code class="docutils literal notranslate"><span class="pre">GravLens.LensingInterpolate</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tokult.GravLens.match_wcs_with"><code class="docutils literal notranslate"><span class="pre">GravLens.match_wcs_with()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tokult.GravLens.use_redshifts"><code class="docutils literal notranslate"><span class="pre">GravLens.use_redshifts()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tokult.GravLens.reset_redshifts"><code class="docutils literal notranslate"><span class="pre">GravLens.reset_redshifts()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tokult.GravLens.compute_deflection_angles"><code class="docutils literal notranslate"><span class="pre">GravLens.compute_deflection_angles()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tokult.GravLens.convert_xy_arcsec_to_pixel"><code class="docutils literal notranslate"><span class="pre">GravLens.convert_xy_arcsec_to_pixel()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tokult.GravLens.convert_xy_pixel_to_arcsec"><code class="docutils literal notranslate"><span class="pre">GravLens.convert_xy_pixel_to_arcsec()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tokult.GravLens.gradient"><code class="docutils literal notranslate"><span class="pre">GravLens.gradient()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tokult.GravLens.get_angular_distance_ratio"><code class="docutils literal notranslate"><span class="pre">GravLens.get_angular_distance_ratio()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tokult.GravLens.loadfits"><code class="docutils literal notranslate"><span class="pre">GravLens.loadfits()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#tokult.InputParams"><code class="docutils literal notranslate"><span class="pre">InputParams</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#tokult.InputParams.x0_dyn"><code class="docutils literal notranslate"><span class="pre">InputParams.x0_dyn</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tokult.InputParams.y0_dyn"><code class="docutils literal notranslate"><span class="pre">InputParams.y0_dyn</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tokult.InputParams.PA_dyn"><code class="docutils literal notranslate"><span class="pre">InputParams.PA_dyn</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tokult.InputParams.inclination_dyn"><code class="docutils literal notranslate"><span class="pre">InputParams.inclination_dyn</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tokult.InputParams.radius_dyn"><code class="docutils literal notranslate"><span class="pre">InputParams.radius_dyn</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tokult.InputParams.velocity_sys"><code class="docutils literal notranslate"><span class="pre">InputParams.velocity_sys</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tokult.InputParams.mass_dyn"><code class="docutils literal notranslate"><span class="pre">InputParams.mass_dyn</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tokult.InputParams.brightness_center"><code class="docutils literal notranslate"><span class="pre">InputParams.brightness_center</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tokult.InputParams.velocity_dispersion"><code class="docutils literal notranslate"><span class="pre">InputParams.velocity_dispersion</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tokult.InputParams.radius_emi"><code class="docutils literal notranslate"><span class="pre">InputParams.radius_emi</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tokult.InputParams.x0_emi"><code class="docutils literal notranslate"><span class="pre">InputParams.x0_emi</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tokult.InputParams.y0_emi"><code class="docutils literal notranslate"><span class="pre">InputParams.y0_emi</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tokult.InputParams.PA_emi"><code class="docutils literal notranslate"><span class="pre">InputParams.PA_emi</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tokult.InputParams.inclination_emi"><code class="docutils literal notranslate"><span class="pre">InputParams.inclination_emi</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tokult.InputParams.to_units"><code class="docutils literal notranslate"><span class="pre">InputParams.to_units()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#tokult.FitParamsWithUnits"><code class="docutils literal notranslate"><span class="pre">FitParamsWithUnits</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#tokult.FitParamsWithUnits.x0_dyn"><code class="docutils literal notranslate"><span class="pre">FitParamsWithUnits.x0_dyn</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tokult.FitParamsWithUnits.y0_dyn"><code class="docutils literal notranslate"><span class="pre">FitParamsWithUnits.y0_dyn</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tokult.FitParamsWithUnits.PA_dyn"><code class="docutils literal notranslate"><span class="pre">FitParamsWithUnits.PA_dyn</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tokult.FitParamsWithUnits.inclination_dyn"><code class="docutils literal notranslate"><span class="pre">FitParamsWithUnits.inclination_dyn</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tokult.FitParamsWithUnits.radius_dyn"><code class="docutils literal notranslate"><span class="pre">FitParamsWithUnits.radius_dyn</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tokult.FitParamsWithUnits.velocity_sys"><code class="docutils literal notranslate"><span class="pre">FitParamsWithUnits.velocity_sys</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tokult.FitParamsWithUnits.mass_dyn"><code class="docutils literal notranslate"><span class="pre">FitParamsWithUnits.mass_dyn</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tokult.FitParamsWithUnits.brightness_center"><code class="docutils literal notranslate"><span class="pre">FitParamsWithUnits.brightness_center</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tokult.FitParamsWithUnits.velocity_dispersion"><code class="docutils literal notranslate"><span class="pre">FitParamsWithUnits.velocity_dispersion</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tokult.FitParamsWithUnits.radius_emi"><code class="docutils literal notranslate"><span class="pre">FitParamsWithUnits.radius_emi</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tokult.FitParamsWithUnits.x0_emi"><code class="docutils literal notranslate"><span class="pre">FitParamsWithUnits.x0_emi</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tokult.FitParamsWithUnits.y0_emi"><code class="docutils literal notranslate"><span class="pre">FitParamsWithUnits.y0_emi</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tokult.FitParamsWithUnits.PA_emi"><code class="docutils literal notranslate"><span class="pre">FitParamsWithUnits.PA_emi</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tokult.FitParamsWithUnits.inclination_emi"><code class="docutils literal notranslate"><span class="pre">FitParamsWithUnits.inclination_emi</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tokult.FitParamsWithUnits.header"><code class="docutils literal notranslate"><span class="pre">FitParamsWithUnits.header</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tokult.FitParamsWithUnits.z"><code class="docutils literal notranslate"><span class="pre">FitParamsWithUnits.z</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tokult.FitParamsWithUnits.wcs"><code class="docutils literal notranslate"><span class="pre">FitParamsWithUnits.wcs</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tokult.FitParamsWithUnits.pixelscale"><code class="docutils literal notranslate"><span class="pre">FitParamsWithUnits.pixelscale</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tokult.FitParamsWithUnits.freq_rest"><code class="docutils literal notranslate"><span class="pre">FitParamsWithUnits.freq_rest</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tokult.FitParamsWithUnits.vpixelscale"><code class="docutils literal notranslate"><span class="pre">FitParamsWithUnits.vpixelscale</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tokult.FitParamsWithUnits.diskmassscale"><code class="docutils literal notranslate"><span class="pre">FitParamsWithUnits.diskmassscale</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tokult.FitParamsWithUnits.to_physicalscale"><code class="docutils literal notranslate"><span class="pre">FitParamsWithUnits.to_physicalscale()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tokult.FitParamsWithUnits.vmax"><code class="docutils literal notranslate"><span class="pre">FitParamsWithUnits.vmax()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tokult.FitParamsWithUnits.from_inputparams"><code class="docutils literal notranslate"><span class="pre">FitParamsWithUnits.from_inputparams()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#tokult.get_bound_params"><code class="docutils literal notranslate"><span class="pre">get_bound_params()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-tokult.common">tokult.common module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-tokult.fitting">tokult.fitting module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#tokult.fitting.InputParams"><code class="docutils literal notranslate"><span class="pre">InputParams</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#tokult.fitting.InputParams.x0_dyn"><code class="docutils literal notranslate"><span class="pre">InputParams.x0_dyn</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tokult.fitting.InputParams.y0_dyn"><code class="docutils literal notranslate"><span class="pre">InputParams.y0_dyn</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tokult.fitting.InputParams.PA_dyn"><code class="docutils literal notranslate"><span class="pre">InputParams.PA_dyn</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tokult.fitting.InputParams.inclination_dyn"><code class="docutils literal notranslate"><span class="pre">InputParams.inclination_dyn</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tokult.fitting.InputParams.radius_dyn"><code class="docutils literal notranslate"><span class="pre">InputParams.radius_dyn</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tokult.fitting.InputParams.velocity_sys"><code class="docutils literal notranslate"><span class="pre">InputParams.velocity_sys</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tokult.fitting.InputParams.mass_dyn"><code class="docutils literal notranslate"><span class="pre">InputParams.mass_dyn</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tokult.fitting.InputParams.brightness_center"><code class="docutils literal notranslate"><span class="pre">InputParams.brightness_center</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tokult.fitting.InputParams.velocity_dispersion"><code class="docutils literal notranslate"><span class="pre">InputParams.velocity_dispersion</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tokult.fitting.InputParams.radius_emi"><code class="docutils literal notranslate"><span class="pre">InputParams.radius_emi</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tokult.fitting.InputParams.x0_emi"><code class="docutils literal notranslate"><span class="pre">InputParams.x0_emi</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tokult.fitting.InputParams.y0_emi"><code class="docutils literal notranslate"><span class="pre">InputParams.y0_emi</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tokult.fitting.InputParams.PA_emi"><code class="docutils literal notranslate"><span class="pre">InputParams.PA_emi</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tokult.fitting.InputParams.inclination_emi"><code class="docutils literal notranslate"><span class="pre">InputParams.inclination_emi</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tokult.fitting.InputParams.to_units"><code class="docutils literal notranslate"><span class="pre">InputParams.to_units()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#tokult.fitting.FitParamsWithUnits"><code class="docutils literal notranslate"><span class="pre">FitParamsWithUnits</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#tokult.fitting.FitParamsWithUnits.x0_dyn"><code class="docutils literal notranslate"><span class="pre">FitParamsWithUnits.x0_dyn</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tokult.fitting.FitParamsWithUnits.y0_dyn"><code class="docutils literal notranslate"><span class="pre">FitParamsWithUnits.y0_dyn</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tokult.fitting.FitParamsWithUnits.PA_dyn"><code class="docutils literal notranslate"><span class="pre">FitParamsWithUnits.PA_dyn</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tokult.fitting.FitParamsWithUnits.inclination_dyn"><code class="docutils literal notranslate"><span class="pre">FitParamsWithUnits.inclination_dyn</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tokult.fitting.FitParamsWithUnits.radius_dyn"><code class="docutils literal notranslate"><span class="pre">FitParamsWithUnits.radius_dyn</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tokult.fitting.FitParamsWithUnits.velocity_sys"><code class="docutils literal notranslate"><span class="pre">FitParamsWithUnits.velocity_sys</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tokult.fitting.FitParamsWithUnits.mass_dyn"><code class="docutils literal notranslate"><span class="pre">FitParamsWithUnits.mass_dyn</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tokult.fitting.FitParamsWithUnits.brightness_center"><code class="docutils literal notranslate"><span class="pre">FitParamsWithUnits.brightness_center</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tokult.fitting.FitParamsWithUnits.velocity_dispersion"><code class="docutils literal notranslate"><span class="pre">FitParamsWithUnits.velocity_dispersion</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tokult.fitting.FitParamsWithUnits.radius_emi"><code class="docutils literal notranslate"><span class="pre">FitParamsWithUnits.radius_emi</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tokult.fitting.FitParamsWithUnits.x0_emi"><code class="docutils literal notranslate"><span class="pre">FitParamsWithUnits.x0_emi</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tokult.fitting.FitParamsWithUnits.y0_emi"><code class="docutils literal notranslate"><span class="pre">FitParamsWithUnits.y0_emi</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tokult.fitting.FitParamsWithUnits.PA_emi"><code class="docutils literal notranslate"><span class="pre">FitParamsWithUnits.PA_emi</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tokult.fitting.FitParamsWithUnits.inclination_emi"><code class="docutils literal notranslate"><span class="pre">FitParamsWithUnits.inclination_emi</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tokult.fitting.FitParamsWithUnits.header"><code class="docutils literal notranslate"><span class="pre">FitParamsWithUnits.header</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tokult.fitting.FitParamsWithUnits.z"><code class="docutils literal notranslate"><span class="pre">FitParamsWithUnits.z</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tokult.fitting.FitParamsWithUnits.wcs"><code class="docutils literal notranslate"><span class="pre">FitParamsWithUnits.wcs</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tokult.fitting.FitParamsWithUnits.pixelscale"><code class="docutils literal notranslate"><span class="pre">FitParamsWithUnits.pixelscale</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tokult.fitting.FitParamsWithUnits.freq_rest"><code class="docutils literal notranslate"><span class="pre">FitParamsWithUnits.freq_rest</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tokult.fitting.FitParamsWithUnits.vpixelscale"><code class="docutils literal notranslate"><span class="pre">FitParamsWithUnits.vpixelscale</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tokult.fitting.FitParamsWithUnits.diskmassscale"><code class="docutils literal notranslate"><span class="pre">FitParamsWithUnits.diskmassscale</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tokult.fitting.FitParamsWithUnits.to_physicalscale"><code class="docutils literal notranslate"><span class="pre">FitParamsWithUnits.to_physicalscale()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tokult.fitting.FitParamsWithUnits.vmax"><code class="docutils literal notranslate"><span class="pre">FitParamsWithUnits.vmax()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tokult.fitting.FitParamsWithUnits.from_inputparams"><code class="docutils literal notranslate"><span class="pre">FitParamsWithUnits.from_inputparams()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#tokult.fitting.get_bound_params"><code class="docutils literal notranslate"><span class="pre">get_bound_params()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-tokult.function">tokult.function module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#tokult.function.gaussian"><code class="docutils literal notranslate"><span class="pre">gaussian()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#tokult.function.reciprocal_exp"><code class="docutils literal notranslate"><span class="pre">reciprocal_exp()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#tokult.function.freeman_disk"><code class="docutils literal notranslate"><span class="pre">freeman_disk()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#tokult.function.maximum_rotation_velocity"><code class="docutils literal notranslate"><span class="pre">maximum_rotation_velocity()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-tokult.misc">tokult.misc module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-tokult.casa">tokult.casa module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-tokult.casa_dummy">tokult.casa_dummy module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-tokult.core">tokult.core module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#tokult.core.Tokult"><code class="docutils literal notranslate"><span class="pre">Tokult</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#tokult.core.Tokult.launch"><code class="docutils literal notranslate"><span class="pre">Tokult.launch()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tokult.core.Tokult.imagefit"><code class="docutils literal notranslate"><span class="pre">Tokult.imagefit()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tokult.core.Tokult.uvfit"><code class="docutils literal notranslate"><span class="pre">Tokult.uvfit()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tokult.core.Tokult.initialguess"><code class="docutils literal notranslate"><span class="pre">Tokult.initialguess()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tokult.core.Tokult.use_region"><code class="docutils literal notranslate"><span class="pre">Tokult.use_region()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tokult.core.Tokult.use_redshifts"><code class="docutils literal notranslate"><span class="pre">Tokult.use_redshifts()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tokult.core.Tokult.change_datacube"><code class="docutils literal notranslate"><span class="pre">Tokult.change_datacube()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tokult.core.Tokult.change_dirtybeam"><code class="docutils literal notranslate"><span class="pre">Tokult.change_dirtybeam()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tokult.core.Tokult.change_gravlens"><code class="docutils literal notranslate"><span class="pre">Tokult.change_gravlens()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tokult.core.Tokult.construct_modelcube"><code class="docutils literal notranslate"><span class="pre">Tokult.construct_modelcube()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tokult.core.Tokult.calculate_normweight"><code class="docutils literal notranslate"><span class="pre">Tokult.calculate_normweight()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#tokult.core.Cube"><code class="docutils literal notranslate"><span class="pre">Cube</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#tokult.core.Cube.imageplane"><code class="docutils literal notranslate"><span class="pre">Cube.imageplane</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tokult.core.Cube.uvplane"><code class="docutils literal notranslate"><span class="pre">Cube.uvplane</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tokult.core.Cube.original"><code class="docutils literal notranslate"><span class="pre">Cube.original</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tokult.core.Cube.header"><code class="docutils literal notranslate"><span class="pre">Cube.header</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tokult.core.Cube.cutout"><code class="docutils literal notranslate"><span class="pre">Cube.cutout()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tokult.core.Cube.rms"><code class="docutils literal notranslate"><span class="pre">Cube.rms()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tokult.core.Cube.moment0"><code class="docutils literal notranslate"><span class="pre">Cube.moment0()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tokult.core.Cube.rms_moment0"><code class="docutils literal notranslate"><span class="pre">Cube.rms_moment0()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tokult.core.Cube.pixmoment1"><code class="docutils literal notranslate"><span class="pre">Cube.pixmoment1()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tokult.core.Cube.pixmoment2"><code class="docutils literal notranslate"><span class="pre">Cube.pixmoment2()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tokult.core.Cube.noisy"><code class="docutils literal notranslate"><span class="pre">Cube.noisy()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tokult.core.Cube.rfft2"><code class="docutils literal notranslate"><span class="pre">Cube.rfft2()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tokult.core.Cube.create_noise"><code class="docutils literal notranslate"><span class="pre">Cube.create_noise()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#tokult.core.DataCube"><code class="docutils literal notranslate"><span class="pre">DataCube</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#tokult.core.DataCube.perturbed"><code class="docutils literal notranslate"><span class="pre">DataCube.perturbed()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tokult.core.DataCube.create"><code class="docutils literal notranslate"><span class="pre">DataCube.create()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tokult.core.DataCube.loadfits"><code class="docutils literal notranslate"><span class="pre">DataCube.loadfits()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#tokult.core.ModelCube"><code class="docutils literal notranslate"><span class="pre">ModelCube</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#tokult.core.ModelCube.create"><code class="docutils literal notranslate"><span class="pre">ModelCube.create()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tokult.core.ModelCube.to_mockcube"><code class="docutils literal notranslate"><span class="pre">ModelCube.to_mockcube()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#tokult.core.DirtyBeam"><code class="docutils literal notranslate"><span class="pre">DirtyBeam</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#tokult.core.DirtyBeam.create"><code class="docutils literal notranslate"><span class="pre">DirtyBeam.create()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tokult.core.DirtyBeam.convolve"><code class="docutils literal notranslate"><span class="pre">DirtyBeam.convolve()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tokult.core.DirtyBeam.fullconvolve"><code class="docutils literal notranslate"><span class="pre">DirtyBeam.fullconvolve()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tokult.core.DirtyBeam.cutout"><code class="docutils literal notranslate"><span class="pre">DirtyBeam.cutout()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tokult.core.DirtyBeam.cutout_to_match_with"><code class="docutils literal notranslate"><span class="pre">DirtyBeam.cutout_to_match_with()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tokult.core.DirtyBeam.loadfits"><code class="docutils literal notranslate"><span class="pre">DirtyBeam.loadfits()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#tokult.core.GravLens"><code class="docutils literal notranslate"><span class="pre">GravLens</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#tokult.core.GravLens.create"><code class="docutils literal notranslate"><span class="pre">GravLens.create()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tokult.core.GravLens.lensing"><code class="docutils literal notranslate"><span class="pre">GravLens.lensing()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tokult.core.GravLens.create_interpolate_lensing"><code class="docutils literal notranslate"><span class="pre">GravLens.create_interpolate_lensing()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tokult.core.GravLens.LensingInterpolate"><code class="docutils literal notranslate"><span class="pre">GravLens.LensingInterpolate</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tokult.core.GravLens.match_wcs_with"><code class="docutils literal notranslate"><span class="pre">GravLens.match_wcs_with()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tokult.core.GravLens.use_redshifts"><code class="docutils literal notranslate"><span class="pre">GravLens.use_redshifts()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tokult.core.GravLens.reset_redshifts"><code class="docutils literal notranslate"><span class="pre">GravLens.reset_redshifts()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tokult.core.GravLens.compute_deflection_angles"><code class="docutils literal notranslate"><span class="pre">GravLens.compute_deflection_angles()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tokult.core.GravLens.convert_xy_arcsec_to_pixel"><code class="docutils literal notranslate"><span class="pre">GravLens.convert_xy_arcsec_to_pixel()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tokult.core.GravLens.convert_xy_pixel_to_arcsec"><code class="docutils literal notranslate"><span class="pre">GravLens.convert_xy_pixel_to_arcsec()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tokult.core.GravLens.gradient"><code class="docutils literal notranslate"><span class="pre">GravLens.gradient()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tokult.core.GravLens.get_angular_distance_ratio"><code class="docutils literal notranslate"><span class="pre">GravLens.get_angular_distance_ratio()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tokult.core.GravLens.loadfits"><code class="docutils literal notranslate"><span class="pre">GravLens.loadfits()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-tokult.example">tokult.example module</a></li>
</ul>
</li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">tokult</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="modules.html">tokult</a></li>
      <li class="breadcrumb-item active">tokult package</li>
      <li class="wy-breadcrumbs-aside">
              <!-- User defined GitHub URL -->
              <a href="https://github.com/sugayu/tokult/tree/dev" class="fa fa-github"> Edit on GitHub</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="tokult-package">
<h1>tokult package<a class="headerlink" href="#tokult-package" title="Permalink to this heading"></a></h1>
<section id="submodules">
<h2>Submodules<a class="headerlink" href="#submodules" title="Permalink to this heading"></a></h2>
</section>
<section id="module-tokult">
<span id="module-contents"></span><h2>Module contents<a class="headerlink" href="#module-tokult" title="Permalink to this heading"></a></h2>
<p>Tokult — Tools of Kinematics on UV-plane for Lensed Targets</p>
<p>Tokult is a kinematics fitting tool.</p>
<dl class="py class">
<dt class="sig sig-object py" id="tokult.Tokult">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">tokult.</span></span><span class="sig-name descname"><span class="pre">Tokult</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">datacube</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dirtybeam</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gravlens</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tokult.Tokult" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Interface of Tokult.</p>
<p>Users specify data to launch an instance object and start fitting through
the instance. This class contains observed data, psf, and lensing parameters,
along with useful functions to manipulate data and models.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>datacube</strong> (<a class="reference internal" href="#tokult.DataCube" title="tokult.DataCube"><em>DataCube</em></a>) – </p></li>
<li><p><strong>dirtybeam</strong> (<em>Optional</em><em>[</em><a class="reference internal" href="#tokult.DirtyBeam" title="tokult.DirtyBeam"><em>DirtyBeam</em></a><em>]</em><em>, </em><em>optional</em>) – Defaults to None.</p></li>
<li><p><strong>gravlens</strong> (<em>Optional</em><em>[</em><a class="reference internal" href="#tokult.GravLens" title="tokult.GravLens"><em>GravLens</em></a><em>]</em><em>, </em><em>optional</em>) – Defaults to None.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">tokult</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tok</span> <span class="o">=</span> <span class="n">tokult</span><span class="o">.</span><span class="n">Tokult</span><span class="o">.</span><span class="n">launch</span><span class="p">(</span><span class="s1">&#39;data.fits&#39;</span><span class="p">,</span> <span class="s1">&#39;psf.fits&#39;</span><span class="p">,</span>
<span class="go">                             (&#39;x-arcsec-deflect.fits&#39;, &#39;y-arcsec-deflect.fits&#39;))</span>
</pre></div>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="tokult.Tokult.launch">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">launch</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">beam</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gravlens</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">header_data</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">header_beam</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">header_gravlens</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">index_data</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">index_beam</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">index_gravlens</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tokult.Tokult.launch" title="Permalink to this definition"></a></dt>
<dd><p>Constructer of <code class="docutils literal notranslate"><span class="pre">Tokult</span></code>.</p>
<p>Construct an instance easier than to use the init constructer.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> (<em>Union</em><em>[</em><em>np.ndarray</em><em>, </em><em>str</em><em>]</em>) – Observed data. The format is a data
array or a fits file name.</p></li>
<li><p><strong>beam</strong> (<em>Union</em><em>[</em><em>np.ndarray</em><em>, </em><em>str</em><em>, </em><em>None</em><em>]</em><em>, </em><em>optional</em>) – Dirty beam or point
spread function (PSF). The format is a data array or a fits file
name. Defaults to None.</p></li>
<li><p><strong>gravlens</strong> (<em>Union</em><em>[</em><em>tuple</em><em>[</em><em>np.ndarray</em><em>, </em><em>...</em><em>]</em><em>, </em><em>tuple</em><em>[</em><em>str</em><em>, </em><em>...</em><em>]</em><em>]</em><em>, </em><em>None</em><em>, </em><em>optional</em>) – Gravitational lensing parameters. The format is a tuple containing
the three data array or fits file names of parameters:
x_arcsec_deflect and y_arcsec_deflect. Defaults to None.</p></li>
<li><p><strong>header_data</strong> (<em>Optional</em><em>[</em><em>fits.Header</em><em>]</em><em>, </em><em>optional</em>) – Header of data.
Defaults to None.
This is necessary when the <code class="docutils literal notranslate"><span class="pre">data</span></code> is not given in a fits file.</p></li>
<li><p><strong>header_beam</strong> (<em>Optional</em><em>[</em><em>fits.Header</em><em>]</em><em>, </em><em>optional</em>) – Header of psf.
Defaults to None.
This is necessary when <code class="docutils literal notranslate"><span class="pre">beam</span></code> is not given in a fits file.</p></li>
<li><p><strong>header_gravlens</strong> (<em>Optional</em><em>[</em><em>fits.Header</em><em>]</em><em>, </em><em>optional</em>) – Header of gravlens.
Defaults to None.
This is necessary when <code class="docutils literal notranslate"><span class="pre">gravlens</span></code> is not given in fits files.</p></li>
<li><p><strong>index_data</strong> (<em>int</em><em>, </em><em>optional</em>) – Index of fits extensions of the data fits
file. Defaults to 0.</p></li>
<li><p><strong>index_beam</strong> (<em>int</em><em>, </em><em>optional</em>) – Index of fits extensions of the beam fits
file. Defaults to 0.</p></li>
<li><p><strong>index_gravlens</strong> (<em>int</em><em>, </em><em>optional</em>) – Index of fits extensions of the lens
fits files. Defaults to 0.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="#tokult.core.Tokult" title="tokult.core.Tokult"><em>Tokult</em></a></p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">tok</span> <span class="o">=</span> <span class="n">tokult</span><span class="o">.</span><span class="n">Tokult</span><span class="o">.</span><span class="n">launch</span><span class="p">(</span>
<span class="go">             &#39;data.fits&#39;, &#39;psf.fits&#39;,</span>
<span class="go">             (x_arcsec_deflect.fits&#39;, y_arcsec_deflect.fits&#39;))</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tokult.Tokult.imagefit">
<span class="sig-name descname"><span class="pre">imagefit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">init</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bound</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fix</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">optimization</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'mc'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">niter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nperturb</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nwalkers</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">64</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nsteps</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pool</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">is_separate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mask_for_fit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">uvcoverage</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">progressbar</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tokult.Tokult.imagefit" title="Permalink to this definition"></a></dt>
<dd><p>Fit a 3d model to the data cube on the image plane.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>init</strong> (<em>Sequence</em><em>[</em><em>float</em><em>]</em>) – Initial parameters of fitting.</p></li>
<li><p><strong>bound</strong> (<em>Optional</em><em>[</em><em>tuple</em><em>[</em><em>Sequence</em><em>[</em><em>float</em><em>]</em><em>, </em><em>Sequence</em><em>[</em><em>float</em><em>]</em><em>]</em><em>, </em><em>optional</em>) – Boundaries of parameters. Defaults to None.
When None is given, the default parameter boundaries are used.
The boundaries can be easily set using <code class="docutils literal notranslate"><span class="pre">get_bound_params</span></code>.
Currently, in the mcmc method, only flat prior distributions
are available through this argument.</p></li>
<li><p><strong>fix</strong> (<em>Optional</em><em>[</em><em>fitting.FixParams</em><em>]</em><em>, </em><em>optional</em>) – Defaults to None.</p></li>
<li><p><strong>optimization</strong> (<em>str</em><em>, </em><em>optional</em>) – Defaults to ‘mc’.</p></li>
<li><p><strong>niter</strong> (<em>int</em><em>, </em><em>optional</em>) – Number of iterations of fitting, used
in the least square method. Defaults to 1.</p></li>
<li><p><strong>nperturb</strong> (<em>int</em><em>, </em><em>optional</em>) – Number of perturbations in the Monte Carlo
method. Defaults to 1000.</p></li>
<li><p><strong>nwalkers</strong> (<em>int</em><em>, </em><em>optional</em>) – Number of walkers, used in the MCMC method.
Defaults to 64.</p></li>
<li><p><strong>nsteps</strong> (<em>int</em><em>, </em><em>optional</em>) – Number of steps, used in the MCMC method.
Defaults to 5000.</p></li>
<li><p><strong>pool</strong> (<em>Optional</em><em>[</em><em>Pool</em><em>]</em><em>, </em><em>optional</em>) – multiprocessing.pool for a multi-process
MCMC fitting. Defaults to None.</p></li>
<li><p><strong>is_separate</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, parameters regarding kinematics
and emission are separated; and thus fitting uses all the 14
parameters. If False, the parameters are the same and
the number of free parameters are reduced. Defaults to False.</p></li>
<li><p><strong>mask_for_fit</strong> (<em>Optional</em><em>[</em><em>np.ndarray</em><em>]</em><em>, </em><em>optional</em>) – Mask specifying pixels
used for fitting. Defaults to None.</p></li>
<li><p><strong>progressbar</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, a progress bar is shown.
Defaults to False.</p></li>
<li><p><strong>uvcoverage</strong> (<em>ndarray</em><em> | </em><em>None</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Fitting results and related parameters.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>fitting.Solution</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">sol</span> <span class="o">=</span> <span class="n">tok</span><span class="o">.</span><span class="n">imagefit</span><span class="p">(</span><span class="n">init</span><span class="p">,</span> <span class="n">bound</span><span class="p">,</span> <span class="n">optimization</span><span class="o">=</span><span class="s1">&#39;mc&#39;</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tokult.Tokult.uvfit">
<span class="sig-name descname"><span class="pre">uvfit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">init</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bound</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fix</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">optimization</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'mcmc'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">niter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nwalkers</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">64</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nsteps</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pool</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">is_separate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mask_for_fit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">progressbar</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tokult.Tokult.uvfit" title="Permalink to this definition"></a></dt>
<dd><p>Fit a 3d model to the data cube on the uv plane.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>init</strong> (<em>Sequence</em><em>[</em><em>float</em><em>]</em>) – Initial parameters of fitting.
a function to guess initial parameters: <code class="docutils literal notranslate"><span class="pre">tokult.initialguess()</span></code>.</p></li>
<li><p><strong>bound</strong> (<em>Optional</em><em>[</em><em>tuple</em><em>[</em><em>Sequence</em><em>[</em><em>float</em><em>]</em><em>, </em><em>Sequence</em><em>[</em><em>float</em><em>]</em><em>]</em><em>, </em><em>optional</em>) – Boundaries of parameters. Defaults to None.
When None is given, the default parameter boundaries are used.
The boundaries can be easily set using <code class="docutils literal notranslate"><span class="pre">get_bound_params</span></code>.
Currently, in the mcmc method, only flat prior distributions
are available through this argument.</p></li>
<li><p><strong>fix</strong> (<em>Optional</em><em>[</em><em>fitting.FixParams</em><em>]</em><em>, </em><em>optional</em>) – Fix parameters during
fitting. See <code class="docutils literal notranslate"><span class="pre">FixParams</span></code>. Defaults to None.</p></li>
<li><p><strong>optimization</strong> (<em>str</em><em>, </em><em>optional</em>) – Method to optimize the 3D model.
- ‘ls’: least square method.
- ‘mcmc’: Malcov Chain Monte Carlo method.
Defaults to ‘mcmc’.</p></li>
<li><p><strong>niter</strong> (<em>int</em><em>, </em><em>optional</em>) – Number of iterations of fitting, used
in the least square method. Defaults to 1.</p></li>
<li><p><strong>nperturb</strong> (<em>int</em><em>, </em><em>optional</em>) – Number of perturbations in the Monte Carlo
method. Defaults to 1000.</p></li>
<li><p><strong>nwalkers</strong> (<em>int</em><em>, </em><em>optional</em>) – Number of walkers, used in the MCMC method.
Defaults to 64.</p></li>
<li><p><strong>nsteps</strong> (<em>int</em><em>, </em><em>optional</em>) – Number of steps, used in the MCMC method.
Defaults to 5000.</p></li>
<li><p><strong>pool</strong> (<em>Optional</em><em>[</em><em>Pool</em><em>]</em><em>, </em><em>optional</em>) – multiprocessing.pool for a multi-process
MCMC fitting. Defaults to None.</p></li>
<li><p><strong>is_separate</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, parameters regarding kinematics
and emission are separated; and thus fitting uses all the 14
parameters. If False, the parameters are the same and
the number of free parameters are reduced. Defaults to False.</p></li>
<li><p><strong>mask_for_fit</strong> (<em>Optional</em><em>[</em><em>np.ndarray</em><em>]</em><em>, </em><em>optional</em>) – Mask specifying pixels
used for fitting. In uv fitting, specifying the uv-coverage is
important, which is passed through this argument. Defaults to None.</p></li>
<li><p><strong>progressbar</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, a progress bar is shown.
Defaults to False.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Fitting results and related parameters.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>fitting.Solution</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">sol</span> <span class="o">=</span> <span class="n">tok</span><span class="o">.</span><span class="n">uvfit</span><span class="p">(</span><span class="n">init</span><span class="p">,</span> <span class="n">bound</span><span class="p">,</span> <span class="n">optimization</span><span class="o">=</span><span class="s1">&#39;mcmc&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The input parameters are the same as <code class="docutils literal notranslate"><span class="pre">imagefit</span></code>.</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tokult.Tokult.initialguess">
<span class="sig-name descname"><span class="pre">initialguess</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">is_separate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tokult.Tokult.initialguess" title="Permalink to this definition"></a></dt>
<dd><p>Guess initial input parameters for fitting.</p>
<p>Fit tow-dimensional moment-0 (flux) map and moment-1 (velocity) map then
Estimate input parameters from the 2-d fitting results.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>is_separate</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, parameters regarding kinematics
and emission are separated; and thus fitting uses all the 14
parameters. If False, the parameters are the same and
the number of free parameters are reduced. Defaults to False.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Best-guessed input parameters.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#tokult.fitting.InputParams" title="tokult.fitting.InputParams">fitting.InputParams</a></p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">init</span> <span class="o">=</span> <span class="n">tok</span><span class="o">.</span><span class="n">initialguess</span><span class="p">()</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Initial parameters are crucial for parameter fitting, especially in
the least-square and Monte Carlo methods and being related with speed
of convergence in the MCMC method.</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tokult.Tokult.use_region">
<span class="sig-name descname"><span class="pre">use_region</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">xlim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ylim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vlim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tokult.Tokult.use_region" title="Permalink to this definition"></a></dt>
<dd><p>Use a region of datacube used for fitting.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>xlim</strong> (<em>Optional</em><em>[</em><em>tuple</em><em>[</em><em>int</em><em>, </em><em>int</em><em>]</em><em>]</em><em>, </em><em>optional</em>) – The limit of the x-axis.
Defaults to None.</p></li>
<li><p><strong>ylim</strong> (<em>Optional</em><em>[</em><em>tuple</em><em>[</em><em>int</em><em>, </em><em>int</em><em>]</em><em>]</em><em>, </em><em>optional</em>) – The limit of the y-axis.
Defaults to None.</p></li>
<li><p><strong>vlim</strong> (<em>Optional</em><em>[</em><em>tuple</em><em>[</em><em>int</em><em>, </em><em>int</em><em>]</em><em>]</em><em>, </em><em>optional</em>) – The limit of the v-axis.
Defaults to None.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">tok</span><span class="o">.</span><span class="n">use_region</span><span class="p">((</span><span class="mi">32</span><span class="p">,</span> <span class="mi">96</span><span class="p">),</span> <span class="p">(</span><span class="mi">32</span><span class="p">,</span> <span class="mi">96</span><span class="p">),</span> <span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">12</span><span class="p">))</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>In <code class="docutils literal notranslate"><span class="pre">uvfit</span></code>, the v-axis limit must be specified smaller than
original cube size, because <code class="docutils literal notranslate"><span class="pre">uvfit</span></code> estimates the noise level
using the pixels outside <code class="docutils literal notranslate"><span class="pre">vlim</span></code>.</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tokult.Tokult.use_redshifts">
<span class="sig-name descname"><span class="pre">use_redshifts</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">z_source</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z_lens</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z_assumed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">inf</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tokult.Tokult.use_redshifts" title="Permalink to this definition"></a></dt>
<dd><p>Set the redshifts of the source and the lens galaxies.</p>
<p>The redshifts are used to compute the gravitational lensing effects and
to convert the parameters to the physical units.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>z_source</strong> (<em>float</em>) – The source (galaxy) redshift.</p></li>
<li><p><strong>z_lens</strong> (<em>float</em>) – The lens (cluster) redshift.</p></li>
<li><p><strong>z_assumed</strong> (<em>float</em><em>, </em><em>optional</em>) – The redshift assumed in the
gravitational parameters. If D_s / D_L = 1, the value
should be infinite (<code class="docutils literal notranslate"><span class="pre">np.inf</span></code>). Defaults to <code class="docutils literal notranslate"><span class="pre">np.inf</span></code>.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">tok</span><span class="o">.</span><span class="n">use_redshift</span><span class="p">(</span><span class="n">z_source</span><span class="o">=</span><span class="mf">6.2</span><span class="p">,</span> <span class="n">z_lens</span><span class="o">=</span><span class="mf">0.9</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tokult.Tokult.change_datacube">
<span class="sig-name descname"><span class="pre">change_datacube</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data_or_fname</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">header</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">index_hdul</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xlim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ylim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vlim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tokult.Tokult.change_datacube" title="Permalink to this definition"></a></dt>
<dd><p>Change the variable <code class="docutils literal notranslate"><span class="pre">datacube</span></code>.</p>
<p>May be useful to change <code class="docutils literal notranslate"><span class="pre">datacube</span></code> of an instance.</p>
<dl class="simple">
<dt>Nonte:</dt><dd><p>This method should be used before <code class="docutils literal notranslate"><span class="pre">use_region</span></code> and <code class="docutils literal notranslate"><span class="pre">use_redshift</span></code>.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data_or_fname</strong> (<em>ndarray</em><em> | </em><em>str</em>) – </p></li>
<li><p><strong>header</strong> (<em>Header</em><em> | </em><em>None</em>) – </p></li>
<li><p><strong>index_hdul</strong> (<em>int</em>) – </p></li>
<li><p><strong>xlim</strong> (<em>tuple</em><em>[</em><em>int</em><em>, </em><em>int</em><em>] </em><em>| </em><em>None</em>) – </p></li>
<li><p><strong>ylim</strong> (<em>tuple</em><em>[</em><em>int</em><em>, </em><em>int</em><em>] </em><em>| </em><em>None</em>) – </p></li>
<li><p><strong>vlim</strong> (<em>tuple</em><em>[</em><em>int</em><em>, </em><em>int</em><em>] </em><em>| </em><em>None</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tokult.Tokult.change_dirtybeam">
<span class="sig-name descname"><span class="pre">change_dirtybeam</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data_or_fname</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">header</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">index_hdul</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tokult.Tokult.change_dirtybeam" title="Permalink to this definition"></a></dt>
<dd><p>Change the variable <code class="docutils literal notranslate"><span class="pre">dirtybeam</span></code>.</p>
<p>May be useful to change <code class="docutils literal notranslate"><span class="pre">dirtybeam</span></code> of an instance.</p>
<dl class="simple">
<dt>Nonte:</dt><dd><p>This method should be used before <code class="docutils literal notranslate"><span class="pre">use_region</span></code> and <code class="docutils literal notranslate"><span class="pre">use_redshift</span></code>.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data_or_fname</strong> (<em>ndarray</em><em> | </em><em>str</em>) – </p></li>
<li><p><strong>header</strong> (<em>Header</em><em> | </em><em>None</em>) – </p></li>
<li><p><strong>index_hdul</strong> (<em>int</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tokult.Tokult.change_gravlens">
<span class="sig-name descname"><span class="pre">change_gravlens</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_or_fname_xy_arcsec_deflect</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_or_fname_xy_pixel_deflect</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_or_fname_psi_arcsec</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">header</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">index_hdul</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tokult.Tokult.change_gravlens" title="Permalink to this definition"></a></dt>
<dd><p>Change the variable <code class="docutils literal notranslate"><span class="pre">gravlens</span></code>.</p>
<p>May be useful to change <code class="docutils literal notranslate"><span class="pre">gravlens</span></code> of an instance.</p>
<dl class="simple">
<dt>Nonte:</dt><dd><p>This method should be used before <code class="docutils literal notranslate"><span class="pre">use_region</span></code> and <code class="docutils literal notranslate"><span class="pre">use_redshift</span></code>.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data_or_fname_xy_arcsec_deflect</strong> (<em>tuple</em><em>[</em><em>numpy.ndarray</em><em>, </em><em>...</em><em>] </em><em>| </em><em>tuple</em><em>[</em><em>str</em><em>, </em><em>...</em><em>] </em><em>| </em><em>None</em>) – </p></li>
<li><p><strong>data_or_fname_xy_pixel_deflect</strong> (<em>tuple</em><em>[</em><em>numpy.ndarray</em><em>, </em><em>...</em><em>] </em><em>| </em><em>tuple</em><em>[</em><em>str</em><em>, </em><em>...</em><em>] </em><em>| </em><em>None</em>) – </p></li>
<li><p><strong>data_or_fname_psi_arcsec</strong> (<em>ndarray</em><em> | </em><em>str</em><em> | </em><em>None</em>) – </p></li>
<li><p><strong>header</strong> (<em>Header</em><em> | </em><em>None</em>) – </p></li>
<li><p><strong>index_hdul</strong> (<em>int</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tokult.Tokult.construct_modelcube">
<span class="sig-name descname"><span class="pre">construct_modelcube</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">params</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tokult.Tokult.construct_modelcube" title="Permalink to this definition"></a></dt>
<dd><p>Construct <code class="docutils literal notranslate"><span class="pre">modelcube</span></code> from the input parameters.</p>
<p>Construct a 3D model and set it to an internal variable <code class="docutils literal notranslate"><span class="pre">modelcube</span></code>.
If you want to use a model outside <code class="docutils literal notranslate"><span class="pre">Tokult</span></code> instances, please use
<code class="docutils literal notranslate"><span class="pre">ModelCube.create()</span></code> instead.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>params</strong> (<em>tuple</em><em>[</em><em>float</em><em>, </em><em>...</em><em>]</em>) – Input parameters.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<p>Change a part of the best-fit parameters and construct the model.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">params</span> <span class="o">=</span> <span class="n">sol</span><span class="o">.</span><span class="n">best</span><span class="o">.</span><span class="n">_replace</span><span class="p">(</span><span class="n">PA_dyn</span><span class="o">=</span><span class="mf">0.0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tok</span><span class="o">.</span><span class="n">construct_modelcube</span><span class="p">(</span><span class="n">params</span><span class="p">)</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This method needs the global parameters to be set already.
You may need to fit the data once, before using this method.</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tokult.Tokult.calculate_normweight">
<span class="sig-name descname"><span class="pre">calculate_normweight</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#tokult.Tokult.calculate_normweight" title="Permalink to this definition"></a></dt>
<dd><p>Calculate the normalization weight used in <code class="docutils literal notranslate"><span class="pre">uvfit</span></code>.</p>
<p>The obtained value is almost equal to sum-of-weight, but different by a
factor of a few.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>The normalization weight</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>float</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="tokult.Cube">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">tokult.</span></span><span class="sig-name descname"><span class="pre">Cube</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">imageplane</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">header</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xlim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ylim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vlim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tokult.Cube" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>3D data cube.</p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="go">&gt;&gt;&gt;</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>imageplane</strong> (<em>np.ndarray</em>) – </p></li>
<li><p><strong>header</strong> (<em>Optional</em><em>[</em><em>fits.Header</em><em>]</em>) – </p></li>
<li><p><strong>xlim</strong> (<em>Optional</em><em>[</em><em>tuple</em><em>[</em><em>int</em><em>, </em><em>int</em><em>]</em><em>]</em>) – </p></li>
<li><p><strong>ylim</strong> (<em>Optional</em><em>[</em><em>tuple</em><em>[</em><em>int</em><em>, </em><em>int</em><em>]</em><em>]</em>) – </p></li>
<li><p><strong>vlim</strong> (<em>Optional</em><em>[</em><em>tuple</em><em>[</em><em>int</em><em>, </em><em>int</em><em>]</em><em>]</em>) – </p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="tokult.Cube.imageplane">
<span class="sig-name descname"><span class="pre">imageplane</span></span><a class="headerlink" href="#tokult.Cube.imageplane" title="Permalink to this definition"></a></dt>
<dd><p>Cutout 3D data cube on the image plane.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="tokult.Cube.uvplane">
<span class="sig-name descname"><span class="pre">uvplane</span></span><a class="headerlink" href="#tokult.Cube.uvplane" title="Permalink to this definition"></a></dt>
<dd><p>Cutout 3D data cube on the uv plane.
This is the Fourier transformation of <code class="docutils literal notranslate"><span class="pre">imageplane</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="tokult.Cube.original">
<span class="sig-name descname"><span class="pre">original</span></span><a class="headerlink" href="#tokult.Cube.original" title="Permalink to this definition"></a></dt>
<dd><p>Original-size, 3D data cube.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="tokult.Cube.header">
<span class="sig-name descname"><span class="pre">header</span></span><a class="headerlink" href="#tokult.Cube.header" title="Permalink to this definition"></a></dt>
<dd><p>Header of the fits data.
Defaults to None.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Optional[fits.Header]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tokult.Cube.cutout">
<span class="sig-name descname"><span class="pre">cutout</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">xlim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ylim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vlim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tokult.Cube.cutout" title="Permalink to this definition"></a></dt>
<dd><p>Cutout 3D cube from <code class="docutils literal notranslate"><span class="pre">original</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>xlim</strong> (<em>Optional</em><em>[</em><em>tuple</em><em>[</em><em>int</em><em>, </em><em>int</em><em>]</em><em>]</em><em>, </em><em>optional</em>) – The limit of the x-axis.
Defaults to None.</p></li>
<li><p><strong>ylim</strong> (<em>Optional</em><em>[</em><em>tuple</em><em>[</em><em>int</em><em>, </em><em>int</em><em>]</em><em>]</em><em>, </em><em>optional</em>) – The limit of the y-axis.
Defaults to None.</p></li>
<li><p><strong>vlim</strong> (<em>Optional</em><em>[</em><em>tuple</em><em>[</em><em>int</em><em>, </em><em>int</em><em>]</em><em>]</em><em>, </em><em>optional</em>) – The limit of the v-axis.
Defaults to None.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">cube</span><span class="o">.</span><span class="n">cutout</span><span class="p">((</span><span class="mi">32</span><span class="p">,</span> <span class="mi">96</span><span class="p">),</span> <span class="p">(</span><span class="mi">32</span><span class="p">,</span> <span class="mi">96</span><span class="p">),</span> <span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">12</span><span class="p">))</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tokult.Cube.rms">
<span class="sig-name descname"><span class="pre">rms</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">is_originalsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tokult.Cube.rms" title="Permalink to this definition"></a></dt>
<dd><p>Compute the rms noise of the data cube.</p>
<p>Compute the rms noise using pixels outside of the region used for
<code class="docutils literal notranslate"><span class="pre">imageplane</span></code>, by assuming that the pixels are not affected by
any objects and reflect pure noises.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>is_originalsize</strong> (<em>bool</em><em>, </em><em>optional</em>) – If False, the computed rms noise is</p></li>
<li><p><strong>True</strong> (<em>limited at vlim</em><em> of </em><em>imageplane. If</em>) – </p></li>
<li><p><strong>is</strong> (<em>the rms noise</em>) – </p></li>
<li><p><strong>False.</strong> (<em>computed using the original-size data cube. Defaults to</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>the one-dimensional array containing the rms noises at
each pixel (channel) along the velocity axis.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">rms</span> <span class="o">=</span> <span class="n">cube</span><span class="o">.</span><span class="n">rms</span><span class="p">()</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This method may not return the correct rms if multiple objects are
detected in the Field of View.</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tokult.Cube.moment0">
<span class="sig-name descname"><span class="pre">moment0</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">is_originalsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tokult.Cube.moment0" title="Permalink to this definition"></a></dt>
<dd><p>Moment-0 (integrated-flux) map.</p>
<p>The moment-0 map is the flux map integrated along the velocity axis.
The default computed area is the one defined by <code class="docutils literal notranslate"><span class="pre">Cube.cutout()</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>is_originalsize</strong> (<em>bool</em><em>, </em><em>optional</em>) – If False, compute the moment-0 map
using the cutout region. If True, using the original-size data.
Defaults to False.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Two-dimensional moment-0 map.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">mom0</span> <span class="o">=</span> <span class="n">cube</span><span class="o">.</span><span class="n">moment0</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tokult.Cube.rms_moment0">
<span class="sig-name descname"><span class="pre">rms_moment0</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">is_originalsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tokult.Cube.rms_moment0" title="Permalink to this definition"></a></dt>
<dd><p>RMS noise of the moment 0 map.</p>
<p>RMS noise is computed using the region outside the cutout region, where
the object is located.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>is_originalsize</strong> (<em>bool</em><em>, </em><em>optional</em>) – If False, the moment-0 map is
computed using the cutout region. If True, using the original-
size data. Defaults to False.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>rms of the moment-0 map.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tokult.Cube.pixmoment1">
<span class="sig-name descname"><span class="pre">pixmoment1</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">thresh</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tokult.Cube.pixmoment1" title="Permalink to this definition"></a></dt>
<dd><p>Moment-1 (velocity) map.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>thresh</strong> (<em>float</em><em>, </em><em>optional</em>) – Threshold of the pixel values on the moment-</p></li>
<li><p><strong>threshold</strong> (<em>0 map. In the pixels below this</em>) – </p></li>
<li><p><strong>inserted.</strong> (<em>np.nan is</em>) – </p></li>
<li><p><strong>0.0.</strong> (<em>Defaults to</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Two-dimensional moment-1 map.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<p>To output pixels whose moment-0 values are two times higher than the
rms noise of the moment-0 map.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">mom1</span> <span class="o">=</span> <span class="n">cube</span><span class="o">.</span><span class="n">pixmoment1</span><span class="p">(</span><span class="n">thresh</span><span class="o">=</span><span class="mi">2</span> <span class="o">*</span> <span class="n">cube</span><span class="o">.</span><span class="n">rms_moment0</span><span class="p">())</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The units of the moment-1 map is <em>pixel</em>. You may change the units
by multiplying the results by the velocity-bin width.</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tokult.Cube.pixmoment2">
<span class="sig-name descname"><span class="pre">pixmoment2</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">thresh</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tokult.Cube.pixmoment2" title="Permalink to this definition"></a></dt>
<dd><p>Moment-2 (velocity-dispersion) map.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>thresh</strong> (<em>float</em><em>, </em><em>optional</em>) – Threshold of the pixel values on the moment-</p></li>
<li><p><strong>threshold</strong> (<em>0 map. In the pixels below this</em>) – </p></li>
<li><p><strong>inserted.</strong> (<em>np.nan is</em>) – </p></li>
<li><p><strong>0.0.</strong> (<em>Defaults to</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Two-dimensional moment-2 map.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<p>To output pixels whose moment-0 values are two times higher than the
rms noise of the moment-0 map.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">mom2</span> <span class="o">=</span> <span class="n">cube</span><span class="o">.</span><span class="n">pixmoment2</span><span class="p">(</span><span class="n">thresh</span><span class="o">=</span><span class="mi">2</span> <span class="o">*</span> <span class="n">cube</span><span class="o">.</span><span class="n">rms_moment0</span><span class="p">())</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The units of the moment-2 map is <em>pixel</em>. You may change the units
by multiplying the results by the velocity-bin width.</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tokult.Cube.noisy">
<span class="sig-name descname"><span class="pre">noisy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">rms</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">convolve</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">is_originalsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">uvcoverage</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rms_of_standardnoise</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tokult.Cube.noisy" title="Permalink to this definition"></a></dt>
<dd><p>Create a noisy mock data cube.</p>
<p>The noisy cube is created by adding noise to the contained 3D data cube.
This means that <code class="docutils literal notranslate"><span class="pre">convolve</span></code> should be the same as applied to the
contained data cube. This method is useful to perturb the data cube for
the Monte Carlo estiamtes of fitting errors.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>rms</strong> (<em>Union</em><em>[</em><em>float</em><em>, </em><em>np.ndarray</em><em>]</em>) – RMS of the added noise cube. The rms
is computed at each pixel (channel) along the velocity axis.</p></li>
<li><p><strong>convolve</strong> (<em>Optional</em><em>[</em><em>Callable</em><em>]</em><em>, </em><em>optional</em>) – Convolution function.
Defaults to None.</p></li>
<li><p><strong>seed</strong> (<em>Optional</em><em>[</em><em>int</em><em>]</em><em>, </em><em>optional</em>) – Random seed. Defaults to None.</p></li>
<li><p><strong>is_originalsize</strong> (<em>bool</em><em>, </em><em>optional</em>) – If False, the size of the noisy cube
the same as the cutout <code class="docutils literal notranslate"><span class="pre">imageplane</span></code>. If True, the cube is the
original size. Defaults to False.</p></li>
<li><p><strong>uvcoverage</strong> (<em>Optional</em><em>[</em><em>np.ndarray</em><em>]</em><em>, </em><em>optional</em>) – Mask on the uv plane. The
pixels with False are set to 0.0. Defaults to None.</p></li>
<li><p><strong>rms_of_standardnoise</strong> (<em>ndarray</em><em> | </em><em>None</em>) – </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tokult.Cube.rfft2">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">rfft2</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">zero_padding</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tokult.Cube.rfft2" title="Permalink to this definition"></a></dt>
<dd><p>Wrapper of misc.rfft2.</p>
<p>This method add the new argument <code class="docutils literal notranslate"><span class="pre">zero_padding</span></code> for observed data.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> (<em>np.ndarray</em>) – Data cube on the image plane.</p></li>
<li><p><strong>zero_padding</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, zero-padding the pixels with
<code class="docutils literal notranslate"><span class="pre">None</span></code>. Defaults to False.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Fourier-transformed data cube on the uv plane.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">uv</span> <span class="o">=</span> <span class="n">cube</span><span class="o">.</span><span class="n">rfft2</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="n">zero_padding</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tokult.Cube.create_noise">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">create_noise</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">rms</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shape</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">convolve</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">uvcoverage</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rms_of_standardnoise</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tokult.Cube.create_noise" title="Permalink to this definition"></a></dt>
<dd><p>Create a noise cube.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>rms</strong> (<em>Union</em><em>[</em><em>float</em><em>, </em><em>np.ndarray</em><em>]</em>) – RMS noise of the cube.</p></li>
<li><p><strong>shape</strong> (<em>tuple</em><em>[</em><em>int</em><em>, </em><em>...</em><em>]</em>) – Shape of the cube.</p></li>
<li><p><strong>convolve</strong> (<em>Optional</em><em>[</em><em>Callable</em><em>]</em><em>, </em><em>optional</em>) – Convolution function.
Defaults to None.</p></li>
<li><p><strong>seed</strong> (<em>Optional</em><em>[</em><em>int</em><em>]</em><em>, </em><em>optional</em>) – Random seed. Defaults to None.</p></li>
<li><p><strong>uvcoverage</strong> (<em>Optional</em><em>[</em><em>np.ndarray</em><em>]</em><em>, </em><em>optional</em>) – Mask on the uv plane.
Defaults to None.</p></li>
<li><p><strong>rms_of_standardnoise</strong> (<em>ndarray</em><em> | </em><em>None</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Noise cube.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">noise</span> <span class="o">=</span> <span class="n">cube</span><span class="o">.</span><span class="n">create_noise</span><span class="p">(</span><span class="n">rms</span><span class="p">,</span> <span class="n">shape</span><span class="p">,</span> <span class="n">func_convlution</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="tokult.DataCube">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">tokult.</span></span><span class="sig-name descname"><span class="pre">DataCube</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">imageplane</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">header</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xlim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ylim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vlim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tokult.DataCube" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#tokult.core.Cube" title="tokult.core.Cube"><code class="xref py py-class docutils literal notranslate"><span class="pre">Cube</span></code></a></p>
<p>Cube class to contain an observed datacube.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>imageplane</strong> (<em>np.ndarray</em>) – </p></li>
<li><p><strong>header</strong> (<em>Optional</em><em>[</em><em>fits.Header</em><em>]</em>) – </p></li>
<li><p><strong>xlim</strong> (<em>Optional</em><em>[</em><em>tuple</em><em>[</em><em>int</em><em>, </em><em>int</em><em>]</em><em>]</em>) – </p></li>
<li><p><strong>ylim</strong> (<em>Optional</em><em>[</em><em>tuple</em><em>[</em><em>int</em><em>, </em><em>int</em><em>]</em><em>]</em>) – </p></li>
<li><p><strong>vlim</strong> (<em>Optional</em><em>[</em><em>tuple</em><em>[</em><em>int</em><em>, </em><em>int</em><em>]</em><em>]</em>) – </p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="tokult.DataCube.perturbed">
<span class="sig-name descname"><span class="pre">perturbed</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">convolve</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">is_originalsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">uvcoverage</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rms_of_standardnoise</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tokult.DataCube.perturbed" title="Permalink to this definition"></a></dt>
<dd><p>Perturb the data cube with the same noise level and return it.</p>
<p>This method is useful to perturb the data cube for the Monte Carlo
estiamtes of fitting errors.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>convolve</strong> (<em>Optional</em><em>[</em><em>Callable</em><em>]</em><em>, </em><em>optional</em>) – Convolution function.
Defaults to None.</p></li>
<li><p><strong>seed</strong> (<em>Optional</em><em>[</em><em>int</em><em>]</em><em>, </em><em>optional</em>) – Random seed. Defaults to None.</p></li>
<li><p><strong>is_originalsize</strong> (<em>bool</em><em>, </em><em>optional</em>) – If False, the output is the
perturbed <code class="docutils literal notranslate"><span class="pre">imagepalne</span></code>. If True, the perturbed <code class="docutils literal notranslate"><span class="pre">original</span></code>
Defaults to False.</p></li>
<li><p><strong>uvcoverage</strong> (<em>Optional</em><em>[</em><em>np.ndarray</em><em>]</em><em>, </em><em>optional</em>) – Mask on the uv plane.
Defaults to None.</p></li>
<li><p><strong>rms_of_standardnoise</strong> (<em>ndarray</em><em> | </em><em>None</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Perturbed data cube.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">cube_perturbed</span> <span class="o">=</span> <span class="n">datacube</span><span class="o">.</span><span class="n">perturbed</span><span class="p">(</span><span class="n">convolve</span><span class="o">=</span><span class="n">func_fullconvolve</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tokult.DataCube.create">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">create</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data_or_fname</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">header</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">index_hdul</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tokult.DataCube.create" title="Permalink to this definition"></a></dt>
<dd><p>Constructer of <code class="docutils literal notranslate"><span class="pre">DataCube</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data_or_fname</strong> (<em>Union</em><em>[</em><em>np.ndarray</em><em>, </em><em>str</em><em>]</em>) – Data array or fits file name.</p></li>
<li><p><strong>header</strong> (<em>Optional</em><em>[</em><em>fits.Header</em><em>]</em><em>, </em><em>optional</em>) – Header of the fits file,
necessary if <code class="docutils literal notranslate"><span class="pre">data_or_fname</span></code> is a data array. Defaults to None.</p></li>
<li><p><strong>index_hdul</strong> (<em>int</em><em>, </em><em>optional</em>) – Index of fits extensions of the fits file.
Defaults to 0.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Data cube.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#tokult.DataCube" title="tokult.DataCube">DataCube</a></p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">datacube</span> <span class="o">=</span> <span class="n">DataCube</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="s1">&#39;data.fits&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>When the file name is give, the loaded data is squeezed; that is, the
axis with zero size is dropped. Specifically, the polarization axis of
the ALMA fits data may be dropped.</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tokult.DataCube.loadfits">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">loadfits</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fname</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">index_hdul</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tokult.DataCube.loadfits" title="Permalink to this definition"></a></dt>
<dd><p>Read a data cube from a fits file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>fname</strong> (<em>str</em>) – Fits file name.</p></li>
<li><p><strong>index_hdul</strong> (<em>int</em><em>, </em><em>optional</em>) – Index of fits extensions of the fits file.
Defaults to 0.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Tuple of the data and the fits header.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>tuple[np.ndarray, fits.Header]</p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>When the file name is give, the loaded data is squeezed; that is, the
axis with zero size is dropped. Specifically, the polarization axis of
the ALMA fits data may be dropped.</p>
</div>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="tokult.ModelCube">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">tokult.</span></span><span class="sig-name descname"><span class="pre">ModelCube</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">imageplane</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">raw</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xlim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ylim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vlim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tokult.ModelCube" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#tokult.core.Cube" title="tokult.core.Cube"><code class="xref py py-class docutils literal notranslate"><span class="pre">Cube</span></code></a></p>
<p>Cube class to contain a modeled datacube.</p>
<p>This class is especially for the best-fit model cube.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>imageplane</strong> (<em>np.ndarray</em>) – </p></li>
<li><p><strong>raw</strong> (<em>Optional</em><em>[</em><em>np.ndarray</em><em>]</em>) – </p></li>
<li><p><strong>xlim</strong> (<em>Optional</em><em>[</em><em>tuple</em><em>[</em><em>int</em><em>, </em><em>int</em><em>]</em><em>]</em>) – </p></li>
<li><p><strong>ylim</strong> (<em>Optional</em><em>[</em><em>tuple</em><em>[</em><em>int</em><em>, </em><em>int</em><em>]</em><em>]</em>) – </p></li>
<li><p><strong>vlim</strong> (<em>Optional</em><em>[</em><em>tuple</em><em>[</em><em>int</em><em>, </em><em>int</em><em>]</em><em>]</em>) – </p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="tokult.ModelCube.create">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">create</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">params</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">datacube</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lensing</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">convolve</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">create_interpolate_lensing</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">upsampling_rate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(1,</span> <span class="pre">1,</span> <span class="pre">1)</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tokult.ModelCube.create" title="Permalink to this definition"></a></dt>
<dd><p>Constructer of <code class="docutils literal notranslate"><span class="pre">ModelCube</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>params</strong> (<em>tuple</em><em>[</em><em>float</em><em>, </em><em>...</em><em>]</em>) – Input parameters.</p></li>
<li><p><strong>datacube</strong> (<a class="reference internal" href="#tokult.DataCube" title="tokult.DataCube"><em>DataCube</em></a>) – Data cube. The size of the model cube is based on
this data cube.</p></li>
<li><p><strong>lensing</strong> (<em>Optional</em><em>[</em><em>Callable</em><em>]</em><em>, </em><em>optional</em>) – Lensing function.
Defaults to None.</p></li>
<li><p><strong>convolve</strong> (<em>Optional</em><em>[</em><em>Callable</em><em>]</em><em>, </em><em>optional</em>) – Convolving function.
Defaults to None.</p></li>
<li><p><strong>create_interpolate_lensing</strong> (<em>Callable</em><em> | </em><em>None</em>) – </p></li>
<li><p><strong>upsampling_rate</strong> (<em>tuple</em><em>[</em><em>int</em><em>, </em><em>...</em><em>]</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Model cube.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#tokult.ModelCube" title="tokult.ModelCube">ModelCube</a></p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">model</span> <span class="o">=</span> <span class="n">ModelCube</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="n">params</span><span class="p">,</span> <span class="n">tok</span><span class="o">.</span><span class="n">datacube</span><span class="p">,</span>
<span class="go">                             lensing=tok.gravlens.lensing,</span>
<span class="go">                             convolve=tok.dirtybeam.fullconvolve)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tokult.ModelCube.to_mockcube">
<span class="sig-name descname"><span class="pre">to_mockcube</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">rms</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">convolve</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">is_originalsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">uvcoverage</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tokult.ModelCube.to_mockcube" title="Permalink to this definition"></a></dt>
<dd><p>Convert to and output noisy mock cube.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>rms</strong> (<em>Union</em><em>[</em><em>float</em><em>, </em><em>np.ndarray</em><em>]</em>) – RMS noise added to the model cube,
after convolution.</p></li>
<li><p><strong>convolve</strong> (<em>Optional</em><em>[</em><em>Callable</em><em>]</em><em>, </em><em>optional</em>) – Convolution function. This
convolve both <em>raw</em> model cube and noise. Defaults to None.</p></li>
<li><p><strong>seed</strong> (<em>Optional</em><em>[</em><em>int</em><em>]</em><em>, </em><em>optional</em>) – Random seed. Defaults to None.</p></li>
<li><p><strong>is_originalsize</strong> (<em>bool</em><em>, </em><em>optional</em>) – If False, the output mock cube is
the same size as <code class="docutils literal notranslate"><span class="pre">imageplane</span></code>. If True, the size is the same
as <code class="docutils literal notranslate"><span class="pre">original</span></code>. Defaults to False.</p></li>
<li><p><strong>uvcoverage</strong> (<em>Optional</em><em>[</em><em>np.ndarray</em><em>]</em><em>, </em><em>optional</em>) – Mask on the uv plane.
Defaults to None.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Mock data cube.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">mock</span> <span class="o">=</span> <span class="n">modelcube</span><span class="o">.</span><span class="n">to_mockcube</span><span class="p">(</span>
<span class="go">               tok.datacube.rms(),</span>
<span class="go">               tok.dirtybeam.fullconvolve,</span>
<span class="go">               is_original=True)</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="tokult.DirtyBeam">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">tokult.</span></span><span class="sig-name descname"><span class="pre">DirtyBeam</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">beam</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">header</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tokult.DirtyBeam" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Contains dirtybeam, i.e., Point Spread Functions (PSF) of Cube.</p>
<p>Contained data is dirtybeam images as a function of frequency.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>beam</strong> (<em>np.ndarray</em>) – </p></li>
<li><p><strong>header</strong> (<em>Optional</em><em>[</em><em>fits.Header</em><em>]</em>) – </p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="tokult.DirtyBeam.create">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">create</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data_or_fname</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">header</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">index_hdul</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tokult.DirtyBeam.create" title="Permalink to this definition"></a></dt>
<dd><p>Constructer of <code class="docutils literal notranslate"><span class="pre">DirtyBeam</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data_or_fname</strong> (<em>Union</em><em>[</em><em>np.ndarray</em><em>, </em><em>str</em><em>]</em>) – Data array or fits file name.</p></li>
<li><p><strong>header</strong> (<em>Optional</em><em>[</em><em>fits.Header</em><em>]</em><em>, </em><em>optional</em>) – Header of the fits file.
Defaults to None.</p></li>
<li><p><strong>index_hdul</strong> (<em>int</em><em>, </em><em>optional</em>) – Index of fits extensions of the fits file.
Defaults to 0.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>instance of <code class="docutils literal notranslate"><span class="pre">DirtyBeam</span></code>.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#tokult.DirtyBeam" title="tokult.DirtyBeam">DirtyBeam</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tokult.DirtyBeam.convolve">
<span class="sig-name descname"><span class="pre">convolve</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">image</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tokult.DirtyBeam.convolve" title="Permalink to this definition"></a></dt>
<dd><p>Convolve <code class="docutils literal notranslate"><span class="pre">imageplane</span></code> with dirtybeam (psf) in two dimension.</p>
<p>Perform two-dimensional convolution at each pixel (channel) along the
velocity axis.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>image</strong> (<em>np.ndarray</em>) – Image to be convolved. Note that the size must be
the same as the attribute <code class="docutils literal notranslate"><span class="pre">imageplane</span></code>.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>2D-convolved cube.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">convolved_image</span> <span class="o">=</span> <span class="n">dirtybeam</span><span class="o">.</span><span class="n">convole</span><span class="p">(</span><span class="n">image</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tokult.DirtyBeam.fullconvolve">
<span class="sig-name descname"><span class="pre">fullconvolve</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">image</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">uvcoverage</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">is_noise</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tokult.DirtyBeam.fullconvolve" title="Permalink to this definition"></a></dt>
<dd><p>Convolve <code class="docutils literal notranslate"><span class="pre">original</span></code> with dirtybeam (psf) in two dimension.</p>
<p>Difference between <code class="docutils literal notranslate"><span class="pre">convolve()</span></code> and <code class="docutils literal notranslate"><span class="pre">fullconvolve()</span></code> is the size of
the input <code class="docutils literal notranslate"><span class="pre">image</span></code>. This method <code class="docutils literal notranslate"><span class="pre">fullconvolve</span></code> treat the image with the
same size as the <code class="docutils literal notranslate"><span class="pre">dirtybeam.original</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>image</strong> (<em>np.ndarray</em>) – Image to be convolved. Note that the size must be
the same as the attribute <code class="docutils literal notranslate"><span class="pre">original</span></code>.</p></li>
<li><p><strong>uvcoverage</strong> (<em>Optional</em><em>[</em><em>np.ndarray</em><em>]</em><em>, </em><em>optional</em>) – Mask on the uv plane.
Defaults to None.</p></li>
<li><p><strong>is_noise</strong> (<em>bool</em><em>, </em><em>optional</em>) – True if <code class="docutils literal notranslate"><span class="pre">image</span></code> is data. False if noise.
Defaults to False.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>2D-convolved cube.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">convolved_image</span> <span class="o">=</span> <span class="n">dirtybeam</span><span class="o">.</span><span class="n">fullconvole</span><span class="p">(</span><span class="n">tok</span><span class="o">.</span><span class="n">modelcube</span><span class="o">.</span><span class="n">raw</span><span class="p">)</span>
</pre></div>
</div>
<p>How to create convolved noise.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">rng</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">default_rng</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">noise</span> <span class="o">=</span> <span class="n">rng</span><span class="o">.</span><span class="n">standard_normal</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="n">shape</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">noise</span> <span class="o">=</span> <span class="n">dirtybeam</span><span class="o">.</span><span class="n">fullconvolve</span><span class="p">(</span>
<span class="go">                noise, uvcoverage=uvcoverage, is_noise=True)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tokult.DirtyBeam.cutout">
<span class="sig-name descname"><span class="pre">cutout</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">xlim</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ylim</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vlim</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tokult.DirtyBeam.cutout" title="Permalink to this definition"></a></dt>
<dd><p>Cutout a cubic region from the dirty beam cube.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>xlim</strong> (<em>Union</em><em>[</em><em>tuple</em><em>[</em><em>int</em><em>, </em><em>int</em><em>]</em><em>, </em><em>slice</em><em>]</em>) – The limit of the x-axis.</p></li>
<li><p><strong>ylim</strong> (<em>Union</em><em>[</em><em>tuple</em><em>[</em><em>int</em><em>, </em><em>int</em><em>]</em><em>, </em><em>slice</em><em>]</em>) – The limit of the y-axis.</p></li>
<li><p><strong>vlim</strong> (<em>Union</em><em>[</em><em>tuple</em><em>[</em><em>int</em><em>, </em><em>int</em><em>]</em><em>, </em><em>slice</em><em>]</em>) – The limit of the v-axis.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tokult.DirtyBeam.cutout_to_match_with">
<span class="sig-name descname"><span class="pre">cutout_to_match_with</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cube</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tokult.DirtyBeam.cutout_to_match_with" title="Permalink to this definition"></a></dt>
<dd><p>Cutout a region with the same size of the input <code class="docutils literal notranslate"><span class="pre">cube</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>cube</strong> (<a class="reference internal" href="#tokult.DataCube" title="tokult.DataCube"><em>DataCube</em></a>) – Datacube. The size of <code class="docutils literal notranslate"><span class="pre">cube.original</span></code> must be the
same as the <code class="docutils literal notranslate"><span class="pre">dirtybeam.original</span></code>. This method makes the size of
the <code class="docutils literal notranslate"><span class="pre">dirtybeam.imageplane</span></code> the same as <code class="docutils literal notranslate"><span class="pre">cube.imageplane</span></code>.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tokult.DirtyBeam.loadfits">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">loadfits</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fname</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">index_hdul</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tokult.DirtyBeam.loadfits" title="Permalink to this definition"></a></dt>
<dd><p>Read the dirty beam from a fits file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>fname</strong> (<em>str</em>) – Fits file name.</p></li>
<li><p><strong>index_hdul</strong> (<em>int</em><em>, </em><em>optional</em>) – Index of fits extensions of the fits file.
Defaults to 0.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Tuple of the data and the fits header.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>tuple[np.ndarray, fits.Header]</p>
</dd>
</dl>
<div class="admonition caution">
<p class="admonition-title">Caution</p>
<p>The data shape of <code class="docutils literal notranslate"><span class="pre">DirtyBeam</span></code> must be the same as the <code class="docutils literal notranslate"><span class="pre">Datacube</span></code>.
This requirement is naturaly satisfied if the input dirty-beam and
the image-cube fits files are simulationsly created with CASA.</p>
</div>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="tokult.GravLens">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">tokult.</span></span><span class="sig-name descname"><span class="pre">GravLens</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x_arcsec_deflect</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_arcsec_deflect</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">header</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z_source</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z_lens</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z_assumed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tokult.GravLens" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Deal with gravitational lensing effects based on a given lens models.</p>
<p>Contents are lensing parameters depending on positions.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x_arcsec_deflect</strong> (<em>np.ndarray</em>) – </p></li>
<li><p><strong>y_arcsec_deflect</strong> (<em>np.ndarray</em>) – </p></li>
<li><p><strong>header</strong> (<em>fits.Header</em>) – </p></li>
<li><p><strong>z_source</strong> (<em>Optional</em><em>[</em><em>float</em><em>]</em>) – </p></li>
<li><p><strong>z_lens</strong> (<em>Optional</em><em>[</em><em>float</em><em>]</em>) – </p></li>
<li><p><strong>z_assumed</strong> (<em>Optional</em><em>[</em><em>float</em><em>]</em>) – </p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="tokult.GravLens.create">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">create</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_or_fname_xy_arcsec_deflect</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_or_fname_xy_pixel_deflect</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_or_fname_psi_arcsec</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">header</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">index_hdul</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z_source</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z_lens</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z_assumed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">inf</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tokult.GravLens.create" title="Permalink to this definition"></a></dt>
<dd><p>Constructer of <code class="docutils literal notranslate"><span class="pre">GravLens</span></code>.</p>
<p>Either of the first three arguments are required to construct <code class="docutils literal notranslate"><span class="pre">GravLens</span></code>.
If more thean one among the three are given, the earier argument take a priority
(i.e., xy_arcsec_deflect &gt; xy_pixel_deflect &gt; psi_arcsec).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>(</strong><strong>Optional</strong><strong>[</strong><strong>Union</strong><strong>[</strong><strong>tuple</strong><strong>[</strong><strong>np.ndarray</strong> (<em>data_or_fname_xy_arcsec_deflect</em>) – tuple[str, …]]]): Tuple of the data arrays or fits file names of
lensing parmeters, x-arcsec-deflect and y-arcsec-deflect.
Defaults to None.</p></li>
<li><p><strong>...</strong><strong>]</strong> – tuple[str, …]]]): Tuple of the data arrays or fits file names of
lensing parmeters, x-arcsec-deflect and y-arcsec-deflect.
Defaults to None.</p></li>
<li><p><strong>data_or_fname_xy_arcsec_deflect</strong> (<em>tuple</em><em>[</em><em>numpy.ndarray</em><em>, </em><em>...</em><em>] </em><em>| </em><em>tuple</em><em>[</em><em>str</em><em>, </em><em>...</em><em>] </em><em>| </em><em>None</em>) – </p></li>
<li><p><strong>data_or_fname_xy_pixel_deflect</strong> (<em>tuple</em><em>[</em><em>numpy.ndarray</em><em>, </em><em>...</em><em>] </em><em>| </em><em>tuple</em><em>[</em><em>str</em><em>, </em><em>...</em><em>] </em><em>| </em><em>None</em>) – </p></li>
<li><p><strong>data_or_fname_psi_arcsec</strong> (<em>ndarray</em><em> | </em><em>str</em><em> | </em><em>None</em>) – </p></li>
<li><p><strong>header</strong> (<em>Header</em><em> | </em><em>None</em>) – </p></li>
<li><p><strong>index_hdul</strong> (<em>int</em>) – </p></li>
<li><p><strong>z_source</strong> (<em>float</em><em> | </em><em>None</em>) – </p></li>
<li><p><strong>z_lens</strong> (<em>float</em><em> | </em><em>None</em>) – </p></li>
<li><p><strong>z_assumed</strong> (<em>float</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="#tokult.core.GravLens" title="tokult.core.GravLens"><em>GravLens</em></a></p>
</dd>
</dl>
<dl class="simple">
<dt>:param<span class="classifier">tuple[str, …]]]): Tuple of the data arrays or fits file names of</span></dt><dd><p>lensing parmeters, x-arcsec-deflect and y-arcsec-deflect.
Defaults to None.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>(</strong><strong>Optional</strong><strong>[</strong><strong>Union</strong><strong>[</strong><strong>tuple</strong><strong>[</strong><strong>np.ndarray</strong> (<em>data_or_fname_xy_pixel_deflect</em>) – tuple[str, …]]]): Tuple of the data arrays or fits file names of
lensing parmeters, x-pixel-deflect and y-pixel-deflect.
Defaults to None.</p></li>
<li><p><strong>...</strong><strong>]</strong> – tuple[str, …]]]): Tuple of the data arrays or fits file names of
lensing parmeters, x-pixel-deflect and y-pixel-deflect.
Defaults to None.</p></li>
<li><p><strong>data_or_fname_xy_arcsec_deflect</strong> (<em>tuple</em><em>[</em><em>numpy.ndarray</em><em>, </em><em>...</em><em>] </em><em>| </em><em>tuple</em><em>[</em><em>str</em><em>, </em><em>...</em><em>] </em><em>| </em><em>None</em>) – </p></li>
<li><p><strong>data_or_fname_xy_pixel_deflect</strong> (<em>tuple</em><em>[</em><em>numpy.ndarray</em><em>, </em><em>...</em><em>] </em><em>| </em><em>tuple</em><em>[</em><em>str</em><em>, </em><em>...</em><em>] </em><em>| </em><em>None</em>) – </p></li>
<li><p><strong>data_or_fname_psi_arcsec</strong> (<em>ndarray</em><em> | </em><em>str</em><em> | </em><em>None</em>) – </p></li>
<li><p><strong>header</strong> (<em>Header</em><em> | </em><em>None</em>) – </p></li>
<li><p><strong>index_hdul</strong> (<em>int</em>) – </p></li>
<li><p><strong>z_source</strong> (<em>float</em><em> | </em><em>None</em>) – </p></li>
<li><p><strong>z_lens</strong> (<em>float</em><em> | </em><em>None</em>) – </p></li>
<li><p><strong>z_assumed</strong> (<em>float</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="#tokult.core.GravLens" title="tokult.core.GravLens"><em>GravLens</em></a></p>
</dd>
</dl>
<dl class="simple">
<dt>:param<span class="classifier">tuple[str, …]]]): Tuple of the data arrays or fits file names of</span></dt><dd><p>lensing parmeters, x-pixel-deflect and y-pixel-deflect.
Defaults to None.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data_or_fname_psi_arcsec</strong> (<em>Optional</em><em>[</em><em>Union</em><em>[</em><em>np.ndarray</em><em>, </em><em>str</em><em>]</em><em>]</em>) – Data array
or fits file name of a lensing parmeter, psi. Note that this method
compute the gradient of psi to obtain the deflection angles, so that
significantly strong gravitational lensing might not be traced by psi.
Defaults to None.</p></li>
<li><p><strong>header</strong> (<em>Optional</em><em>[</em><em>fits.Header</em><em>]</em><em>, </em><em>optional</em>) – Header of the fits file.
This method assumes that lensing parameter maps, x-arcsec-deflect and
y-arcsec-deflect, have the same size and coordinates. Defaults to None.</p></li>
<li><p><strong>index_hdul</strong> (<em>int</em><em>, </em><em>optional</em>) – Index of fits extensions of the fits file.
Defaults to 0.</p></li>
<li><p><strong>z_source</strong> (<em>Optional</em><em>[</em><em>float</em><em>]</em><em>, </em><em>optional</em>) – The source (galaxy) redshift.
Defaults to None.</p></li>
<li><p><strong>z_lens</strong> (<em>Optional</em><em>[</em><em>float</em><em>]</em><em>, </em><em>optional</em>) – The lens (cluster) redshift.
Defaults to None.</p></li>
<li><p><strong>z_assumed</strong> (<em>float</em><em>, </em><em>optional</em>) – The redshift assumed in the gravitational
parameters. If D_s / D_L = 1, the value should be infinite (<code class="docutils literal notranslate"><span class="pre">np.inf</span></code>).
Defaults to np.inf.</p></li>
<li><p><strong>data_or_fname_xy_arcsec_deflect</strong> (<em>tuple</em><em>[</em><em>numpy.ndarray</em><em>, </em><em>...</em><em>] </em><em>| </em><em>tuple</em><em>[</em><em>str</em><em>, </em><em>...</em><em>] </em><em>| </em><em>None</em>) – </p></li>
<li><p><strong>data_or_fname_xy_pixel_deflect</strong> (<em>tuple</em><em>[</em><em>numpy.ndarray</em><em>, </em><em>...</em><em>] </em><em>| </em><em>tuple</em><em>[</em><em>str</em><em>, </em><em>...</em><em>] </em><em>| </em><em>None</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Instance of <code class="docutils literal notranslate"><span class="pre">GravLens</span></code>.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#tokult.GravLens" title="tokult.GravLens">GravLens</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tokult.GravLens.lensing">
<span class="sig-name descname"><span class="pre">lensing</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">xgrid</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ygrid</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tokult.GravLens.lensing" title="Permalink to this definition"></a></dt>
<dd><p>Convert coordinates (x, y) from the image plane to the source plane.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>xgrid</strong> (<em>np.ndarray</em>) – Array of the x coordinates on the image plane.</p></li>
<li><p><strong>ygrid</strong> (<em>np.ndarray</em>) – Array of the y coordinates on the image plane.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Tuple of coordinates on the source plane.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>tuple[np.ndarray, …]</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">xx_source</span><span class="p">,</span> <span class="n">yy_source</span> <span class="o">=</span> <span class="n">lensing</span><span class="p">(</span><span class="n">xx_image</span><span class="p">,</span> <span class="n">yy_image</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tokult.GravLens.create_interpolate_lensing">
<span class="sig-name descname"><span class="pre">create_interpolate_lensing</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">xgrid</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ygrid</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tokult.GravLens.create_interpolate_lensing" title="Permalink to this definition"></a></dt>
<dd><p>Retrun a LensingInterpolate instance.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>xgrid</strong> (<em>np.ndarray</em>) – 2D array of the x coordinate.</p></li>
<li><p><strong>ygrid</strong> (<em>np.ndarray</em>) – 2D array of the y coordinate.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>[description]</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#tokult.GravLens.LensingInterpolate" title="tokult.GravLens.LensingInterpolate">LensingInterpolate</a></p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">lensing_interp</span> <span class="o">=</span> <span class="n">gl</span><span class="o">.</span><span class="n">create_interpolate_lensing</span><span class="p">(</span><span class="n">xgrid</span><span class="p">,</span> <span class="n">ygrid</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x0_s</span><span class="p">,</span> <span class="n">y0_s</span> <span class="o">=</span> <span class="n">lensing_interp</span><span class="p">(</span><span class="n">x0_i</span><span class="p">,</span> <span class="n">y0_i</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="tokult.GravLens.LensingInterpolate">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">LensingInterpolate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">xx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">yy</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x_pixel_deflect</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_pixel_deflect</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tokult.GravLens.LensingInterpolate" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Interpolate lensing effects to a data point.</p>
<p>This class method is implemented to convert the center of the model disk to
the image plane.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>xx</strong> (<em>np.ndarray</em>) – </p></li>
<li><p><strong>yy</strong> (<em>np.ndarray</em>) – </p></li>
<li><p><strong>x_pixel_deflect</strong> (<em>np.ndarray</em>) – </p></li>
<li><p><strong>y_pixel_deflect</strong> (<em>np.ndarray</em>) – </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tokult.GravLens.match_wcs_with">
<span class="sig-name descname"><span class="pre">match_wcs_with</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cube</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tokult.GravLens.match_wcs_with" title="Permalink to this definition"></a></dt>
<dd><p>Match the world coordinate system with the input data cube.</p>
<p>Use the wcs of <code class="docutils literal notranslate"><span class="pre">cube.imageplane</span></code>; therefore, the matched lensing
parameter map become smaller than the original map.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>cube</strong> (<a class="reference internal" href="#tokult.DataCube" title="tokult.DataCube"><em>DataCube</em></a>) – <code class="docutils literal notranslate"><span class="pre">DataCube</span></code> including the header information. This
method uses the wcs included in the header of the data cube and
the <code class="docutils literal notranslate"><span class="pre">GravLens</span></code> instance.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">gravlens</span><span class="o">.</span><span class="n">match_wcs_with</span><span class="p">(</span><span class="n">datacube</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tokult.GravLens.use_redshifts">
<span class="sig-name descname"><span class="pre">use_redshifts</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">z_source</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z_lens</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z_assumed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">inf</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tokult.GravLens.use_redshifts" title="Permalink to this definition"></a></dt>
<dd><p>Correct the lensing parameters using the redshifts.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>z_source</strong> (<em>float</em>) – The source (galaxy) redshift.</p></li>
<li><p><strong>z_lens</strong> (<em>float</em>) – The lens (cluster) redshift.</p></li>
<li><p><strong>z_assumed</strong> (<em>float</em><em>, </em><em>optional</em>) – The redshift assumed in the
gravitational parameters. If D_s / D_L = 1, the value
should be infinite (<code class="docutils literal notranslate"><span class="pre">np.inf</span></code>). Defaults to <code class="docutils literal notranslate"><span class="pre">np.inf</span></code>.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tokult.GravLens.reset_redshifts">
<span class="sig-name descname"><span class="pre">reset_redshifts</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#tokult.GravLens.reset_redshifts" title="Permalink to this definition"></a></dt>
<dd><p>Reset the redshift infomation.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tokult.GravLens.compute_deflection_angles">
<span class="sig-name descname"><span class="pre">compute_deflection_angles</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#tokult.GravLens.compute_deflection_angles" title="Permalink to this definition"></a></dt>
<dd><p>Compute deflection angles in arcsec and pixels using redshifts</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tokult.GravLens.convert_xy_arcsec_to_pixel">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">convert_xy_arcsec_to_pixel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x_arcsec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_arcsec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">header</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tokult.GravLens.convert_xy_arcsec_to_pixel" title="Permalink to this definition"></a></dt>
<dd><p>Convert deflection angles of x and y in arcsec to in pixels.</p>
<p>Use the internal header “CDELT” for the conversion.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x_arcsec</strong> (<em>np.ndarray</em>) – Deflection angle of x given in arcsec.</p></li>
<li><p><strong>y_arcsec</strong> (<em>np.ndarray</em>) – Deflection angle of y given in arcsec.</p></li>
<li><p><strong>header</strong> (<em>fits.Header</em>) – Header including units information</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>Tuple of the deflection angles of x</dt><dd><p>and y in pixels.</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>tuple[np.ndarray, np.ndarray]</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">x_pix</span><span class="p">,</span> <span class="n">y_pix</span> <span class="o">=</span> <span class="n">gl</span><span class="o">.</span><span class="n">convert_xy_arcsec_to_pixel</span><span class="p">(</span><span class="n">x_arcsec</span><span class="p">,</span> <span class="n">y_arcsec</span><span class="p">)</span>
</pre></div>
</div>
<dl class="simple">
<dt>Nonte:</dt><dd><p>Assumes that the units of “CDELT1” and “CDELT2” are degree.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tokult.GravLens.convert_xy_pixel_to_arcsec">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">convert_xy_pixel_to_arcsec</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x_pixel</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_pixel</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">header</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tokult.GravLens.convert_xy_pixel_to_arcsec" title="Permalink to this definition"></a></dt>
<dd><p>Convert deflection angles of x and y in pixel to in arcsec.</p>
<p>Use the internal header “CDELT” for the conversion.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x_pixel</strong> (<em>np.ndarray</em>) – Deflection angle of x given in pixel.</p></li>
<li><p><strong>y_pixel</strong> (<em>np.ndarray</em>) – Deflection angle of y given in pixel.</p></li>
<li><p><strong>header</strong> (<em>fits.Header</em>) – Header including units information.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>Tuple of the deflection angles of x</dt><dd><p>and y in arcsec.</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>tuple[np.ndarray, np.ndarray]</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">x_arcsec</span><span class="p">,</span> <span class="n">y_arcsec</span> <span class="o">=</span> <span class="n">gl</span><span class="o">.</span><span class="n">convert_xy_pixel_to_arcsec</span><span class="p">(</span><span class="n">x_pix</span><span class="p">,</span> <span class="n">y_pix</span><span class="p">,</span> <span class="n">header</span><span class="p">)</span>
</pre></div>
</div>
<dl class="simple">
<dt>Nonte:</dt><dd><p>Assumes that the units of “CDELT1” and “CDELT2” are degree.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tokult.GravLens.gradient">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">gradient</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">psi</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">header</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tokult.GravLens.gradient" title="Permalink to this definition"></a></dt>
<dd><p>Compute gradient of 2D image.</p>
<p>This method is used to compute deflection angles from the deflection
potential psi.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>psi</strong> (<em>np.ndarray</em>) – 2D image of the deflection potential. The units are
given in arcsec, meaning that differentiation of psi with respect
to the angle in arcsec gives the deflection angles in arcsec.</p></li>
<li><p><strong>header</strong> (<em>fits.Header</em>) – Header including units information.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>Tuple of the deflection angles of y</dt><dd><p>and x. Note that the order is (y, x).</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>tuple[np.ndarray, np.ndarray]</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">y_arcsec</span><span class="p">,</span> <span class="n">x_arcsec</span> <span class="o">=</span> <span class="n">gl</span><span class="o">.</span><span class="n">gradient</span><span class="p">(</span><span class="n">psi</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="n">header</span><span class="p">)</span>
</pre></div>
</div>
<dl class="simple">
<dt>Nonte:</dt><dd><p>Assumes that the units of “CDELT1” and “CDELT2” are degree.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tokult.GravLens.get_angular_distance_ratio">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">get_angular_distance_ratio</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">z_source</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z_lens</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z_assumed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">inf</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tokult.GravLens.get_angular_distance_ratio" title="Permalink to this definition"></a></dt>
<dd><p>Angular distance ratio of D_LS to D_S, normalized by assumed D_LS/D_S.</p>
<p>Lensing parameter maps are distributed using some D_LS/D_S at specific
redshifts. This method provides a new factor that can be multiplied by
the lensing parameter maps to correct the redshift dependency.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>z_source</strong> (<em>float</em>) – The source (galaxy) redshift.</p></li>
<li><p><strong>z_lens</strong> (<em>float</em>) – The lens (cluster) redshift.</p></li>
<li><p><strong>z_assumed</strong> (<em>float</em><em>, </em><em>optional</em>) – The redshift assumed in the
gravitational parameters. If D_s / D_L = 1, the value
should be infinite (<code class="docutils literal notranslate"><span class="pre">np.inf</span></code>). Defaults to <code class="docutils literal notranslate"><span class="pre">np.inf</span></code>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Angular distance ratio, D_LS/D_S</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">distance_ratio</span> <span class="o">=</span> <span class="n">gravlens</span><span class="o">.</span><span class="n">get_angular_distance_ratio</span><span class="p">(</span><span class="mf">6.2</span><span class="p">,</span> <span class="mf">0.9</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x_deflect_new</span> <span class="o">=</span> <span class="n">x_deflect_old</span> <span class="o">*</span> <span class="n">distance_ratio</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tokult.GravLens.loadfits">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">loadfits</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fname_x_deflect</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fname_y_deflect</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">index_hdul</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tokult.GravLens.loadfits" title="Permalink to this definition"></a></dt>
<dd><p>Read gravlens from fits file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>fname_x_deflect</strong> (<em>str</em>) – Fits file name of the deflect map of x.</p></li>
<li><p><strong>fname_y_deflect</strong> (<em>str</em>) – Fits file name of the deflect map of y.</p></li>
<li><p><strong>index_hdul</strong> (<em>int</em><em>, </em><em>optional</em>) – Index of fits extensions of the fits file.
Assumes that all the fits files include the lensing parameter maps
at the same extension index. Defaults to 0.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>Tuple of three objects;</dt><dd><p>deflection angles (x and y) and header.</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>tuple[np.ndarray, np.ndarray, fits.Header]</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="tokult.InputParams">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">tokult.</span></span><span class="sig-name descname"><span class="pre">InputParams</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x0_dyn</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y0_dyn</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">PA_dyn</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inclination_dyn</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">radius_dyn</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">velocity_sys</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mass_dyn</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">brightness_center</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">velocity_dispersion</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">radius_emi</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x0_emi</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y0_emi</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">PA_emi</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inclination_emi</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tokult.InputParams" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">NamedTuple</span></code></p>
<p>Input parameters for construct_model_at_imageplane.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x0_dyn</strong> (<em>float</em>) – </p></li>
<li><p><strong>y0_dyn</strong> (<em>float</em>) – </p></li>
<li><p><strong>PA_dyn</strong> (<em>float</em>) – </p></li>
<li><p><strong>inclination_dyn</strong> (<em>float</em>) – </p></li>
<li><p><strong>radius_dyn</strong> (<em>float</em>) – </p></li>
<li><p><strong>velocity_sys</strong> (<em>float</em>) – </p></li>
<li><p><strong>mass_dyn</strong> (<em>float</em>) – </p></li>
<li><p><strong>brightness_center</strong> (<em>float</em>) – </p></li>
<li><p><strong>velocity_dispersion</strong> (<em>float</em>) – </p></li>
<li><p><strong>radius_emi</strong> (<em>float</em>) – </p></li>
<li><p><strong>x0_emi</strong> (<em>float</em>) – </p></li>
<li><p><strong>y0_emi</strong> (<em>float</em>) – </p></li>
<li><p><strong>PA_emi</strong> (<em>float</em>) – </p></li>
<li><p><strong>inclination_emi</strong> (<em>float</em>) – </p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="tokult.InputParams.x0_dyn">
<span class="sig-name descname"><span class="pre">x0_dyn</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">float</span></em><a class="headerlink" href="#tokult.InputParams.x0_dyn" title="Permalink to this definition"></a></dt>
<dd><p>the coordinate on x-axis</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="tokult.InputParams.y0_dyn">
<span class="sig-name descname"><span class="pre">y0_dyn</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">float</span></em><a class="headerlink" href="#tokult.InputParams.y0_dyn" title="Permalink to this definition"></a></dt>
<dd><p>Alias for field number 1</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="tokult.InputParams.PA_dyn">
<span class="sig-name descname"><span class="pre">PA_dyn</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">float</span></em><a class="headerlink" href="#tokult.InputParams.PA_dyn" title="Permalink to this definition"></a></dt>
<dd><p>Alias for field number 2</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="tokult.InputParams.inclination_dyn">
<span class="sig-name descname"><span class="pre">inclination_dyn</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">float</span></em><a class="headerlink" href="#tokult.InputParams.inclination_dyn" title="Permalink to this definition"></a></dt>
<dd><p>Alias for field number 3</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="tokult.InputParams.radius_dyn">
<span class="sig-name descname"><span class="pre">radius_dyn</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">float</span></em><a class="headerlink" href="#tokult.InputParams.radius_dyn" title="Permalink to this definition"></a></dt>
<dd><p>Alias for field number 4</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="tokult.InputParams.velocity_sys">
<span class="sig-name descname"><span class="pre">velocity_sys</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">float</span></em><a class="headerlink" href="#tokult.InputParams.velocity_sys" title="Permalink to this definition"></a></dt>
<dd><p>Alias for field number 5</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="tokult.InputParams.mass_dyn">
<span class="sig-name descname"><span class="pre">mass_dyn</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">float</span></em><a class="headerlink" href="#tokult.InputParams.mass_dyn" title="Permalink to this definition"></a></dt>
<dd><p>Alias for field number 6</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="tokult.InputParams.brightness_center">
<span class="sig-name descname"><span class="pre">brightness_center</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">float</span></em><a class="headerlink" href="#tokult.InputParams.brightness_center" title="Permalink to this definition"></a></dt>
<dd><p>Alias for field number 7</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="tokult.InputParams.velocity_dispersion">
<span class="sig-name descname"><span class="pre">velocity_dispersion</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">float</span></em><a class="headerlink" href="#tokult.InputParams.velocity_dispersion" title="Permalink to this definition"></a></dt>
<dd><p>Alias for field number 8</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="tokult.InputParams.radius_emi">
<span class="sig-name descname"><span class="pre">radius_emi</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">float</span></em><a class="headerlink" href="#tokult.InputParams.radius_emi" title="Permalink to this definition"></a></dt>
<dd><p>Alias for field number 9</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="tokult.InputParams.x0_emi">
<span class="sig-name descname"><span class="pre">x0_emi</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">float</span></em><a class="headerlink" href="#tokult.InputParams.x0_emi" title="Permalink to this definition"></a></dt>
<dd><p>Alias for field number 10</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="tokult.InputParams.y0_emi">
<span class="sig-name descname"><span class="pre">y0_emi</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">float</span></em><a class="headerlink" href="#tokult.InputParams.y0_emi" title="Permalink to this definition"></a></dt>
<dd><p>Alias for field number 11</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="tokult.InputParams.PA_emi">
<span class="sig-name descname"><span class="pre">PA_emi</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">float</span></em><a class="headerlink" href="#tokult.InputParams.PA_emi" title="Permalink to this definition"></a></dt>
<dd><p>Alias for field number 12</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="tokult.InputParams.inclination_emi">
<span class="sig-name descname"><span class="pre">inclination_emi</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">float</span></em><a class="headerlink" href="#tokult.InputParams.inclination_emi" title="Permalink to this definition"></a></dt>
<dd><p>Alias for field number 13</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tokult.InputParams.to_units">
<span class="sig-name descname"><span class="pre">to_units</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">header</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">redshift</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tokult.InputParams.to_units" title="Permalink to this definition"></a></dt>
<dd><p>Return input parameters with units.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>header</strong> (<em>Header</em>) – </p></li>
<li><p><strong>redshift</strong> (<em>float</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="#tokult.fitting.FitParamsWithUnits" title="tokult.fitting.FitParamsWithUnits"><em>FitParamsWithUnits</em></a></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="tokult.FitParamsWithUnits">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">tokult.</span></span><span class="sig-name descname"><span class="pre">FitParamsWithUnits</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x0_dyn</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y0_dyn</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">PA_dyn</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inclination_dyn</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">radius_dyn</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">velocity_sys</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mass_dyn</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">brightness_center</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">velocity_dispersion</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">radius_emi</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x0_emi</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y0_emi</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">PA_emi</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inclination_emi</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">header</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tokult.FitParamsWithUnits" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Fitting parameters with units.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x0_dyn</strong> (<em>u.Quantity</em>) – </p></li>
<li><p><strong>y0_dyn</strong> (<em>u.Quantities</em>) – </p></li>
<li><p><strong>PA_dyn</strong> (<em>u.Quantities</em>) – </p></li>
<li><p><strong>inclination_dyn</strong> (<em>u.Quantities</em>) – </p></li>
<li><p><strong>radius_dyn</strong> (<em>u.Quantities</em>) – </p></li>
<li><p><strong>velocity_sys</strong> (<em>u.Quantities</em>) – </p></li>
<li><p><strong>mass_dyn</strong> (<em>u.Quantities</em>) – </p></li>
<li><p><strong>brightness_center</strong> (<em>u.Quantities</em>) – </p></li>
<li><p><strong>velocity_dispersion</strong> (<em>u.Quantities</em>) – </p></li>
<li><p><strong>radius_emi</strong> (<em>u.Quantities</em>) – </p></li>
<li><p><strong>x0_emi</strong> (<em>u.Quantities</em>) – </p></li>
<li><p><strong>y0_emi</strong> (<em>u.Quantities</em>) – </p></li>
<li><p><strong>PA_emi</strong> (<em>u.Quantities</em>) – </p></li>
<li><p><strong>inclination_emi</strong> (<em>u.Quantities</em>) – </p></li>
<li><p><strong>header</strong> (<em>Optional</em><em>[</em><em>fits.Header</em><em>]</em>) – </p></li>
<li><p><strong>z</strong> (<em>float</em>) – </p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="tokult.FitParamsWithUnits.x0_dyn">
<span class="sig-name descname"><span class="pre">x0_dyn</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">u.Quantity</span></em><a class="headerlink" href="#tokult.FitParamsWithUnits.x0_dyn" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="tokult.FitParamsWithUnits.y0_dyn">
<span class="sig-name descname"><span class="pre">y0_dyn</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">u.Quantities</span></em><a class="headerlink" href="#tokult.FitParamsWithUnits.y0_dyn" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="tokult.FitParamsWithUnits.PA_dyn">
<span class="sig-name descname"><span class="pre">PA_dyn</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">u.Quantities</span></em><a class="headerlink" href="#tokult.FitParamsWithUnits.PA_dyn" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="tokult.FitParamsWithUnits.inclination_dyn">
<span class="sig-name descname"><span class="pre">inclination_dyn</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">u.Quantities</span></em><a class="headerlink" href="#tokult.FitParamsWithUnits.inclination_dyn" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="tokult.FitParamsWithUnits.radius_dyn">
<span class="sig-name descname"><span class="pre">radius_dyn</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">u.Quantities</span></em><a class="headerlink" href="#tokult.FitParamsWithUnits.radius_dyn" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="tokult.FitParamsWithUnits.velocity_sys">
<span class="sig-name descname"><span class="pre">velocity_sys</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">u.Quantities</span></em><a class="headerlink" href="#tokult.FitParamsWithUnits.velocity_sys" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="tokult.FitParamsWithUnits.mass_dyn">
<span class="sig-name descname"><span class="pre">mass_dyn</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">u.Quantities</span></em><a class="headerlink" href="#tokult.FitParamsWithUnits.mass_dyn" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="tokult.FitParamsWithUnits.brightness_center">
<span class="sig-name descname"><span class="pre">brightness_center</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">u.Quantities</span></em><a class="headerlink" href="#tokult.FitParamsWithUnits.brightness_center" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="tokult.FitParamsWithUnits.velocity_dispersion">
<span class="sig-name descname"><span class="pre">velocity_dispersion</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">u.Quantities</span></em><a class="headerlink" href="#tokult.FitParamsWithUnits.velocity_dispersion" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="tokult.FitParamsWithUnits.radius_emi">
<span class="sig-name descname"><span class="pre">radius_emi</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">u.Quantities</span></em><a class="headerlink" href="#tokult.FitParamsWithUnits.radius_emi" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="tokult.FitParamsWithUnits.x0_emi">
<span class="sig-name descname"><span class="pre">x0_emi</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">u.Quantities</span></em><a class="headerlink" href="#tokult.FitParamsWithUnits.x0_emi" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="tokult.FitParamsWithUnits.y0_emi">
<span class="sig-name descname"><span class="pre">y0_emi</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">u.Quantities</span></em><a class="headerlink" href="#tokult.FitParamsWithUnits.y0_emi" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="tokult.FitParamsWithUnits.PA_emi">
<span class="sig-name descname"><span class="pre">PA_emi</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">u.Quantities</span></em><a class="headerlink" href="#tokult.FitParamsWithUnits.PA_emi" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="tokult.FitParamsWithUnits.inclination_emi">
<span class="sig-name descname"><span class="pre">inclination_emi</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">u.Quantities</span></em><a class="headerlink" href="#tokult.FitParamsWithUnits.inclination_emi" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="tokult.FitParamsWithUnits.header">
<span class="sig-name descname"><span class="pre">header</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">fits.Header</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#tokult.FitParamsWithUnits.header" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="tokult.FitParamsWithUnits.z">
<span class="sig-name descname"><span class="pre">z</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">float</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">0.0</span></em><a class="headerlink" href="#tokult.FitParamsWithUnits.z" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="tokult.FitParamsWithUnits.wcs">
<span class="sig-name descname"><span class="pre">wcs</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">WCS</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#tokult.FitParamsWithUnits.wcs" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="tokult.FitParamsWithUnits.pixelscale">
<span class="sig-name descname"><span class="pre">pixelscale</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">u.Equivalency</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#tokult.FitParamsWithUnits.pixelscale" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="tokult.FitParamsWithUnits.freq_rest">
<span class="sig-name descname"><span class="pre">freq_rest</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">u.Quantities</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#tokult.FitParamsWithUnits.freq_rest" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="tokult.FitParamsWithUnits.vpixelscale">
<span class="sig-name descname"><span class="pre">vpixelscale</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">u.Equivalency</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#tokult.FitParamsWithUnits.vpixelscale" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="tokult.FitParamsWithUnits.diskmassscale">
<span class="sig-name descname"><span class="pre">diskmassscale</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">u.Equivalency</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#tokult.FitParamsWithUnits.diskmassscale" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tokult.FitParamsWithUnits.to_physicalscale">
<span class="sig-name descname"><span class="pre">to_physicalscale</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#tokult.FitParamsWithUnits.to_physicalscale" title="Permalink to this definition"></a></dt>
<dd><p>Convert values to physicalscales.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tokult.FitParamsWithUnits.vmax">
<span class="sig-name descname"><span class="pre">vmax</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#tokult.FitParamsWithUnits.vmax" title="Permalink to this definition"></a></dt>
<dd><p>Maximum rotation velcoity.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tokult.FitParamsWithUnits.from_inputparams">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">from_inputparams</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">inputparams</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">header</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tokult.FitParamsWithUnits.from_inputparams" title="Permalink to this definition"></a></dt>
<dd><p>Constructer from InputParams</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>inputparams</strong> (<a class="reference internal" href="#tokult.fitting.InputParams" title="tokult.fitting.InputParams"><em>InputParams</em></a><em> | </em><em>InputParamsArray</em>) – </p></li>
<li><p><strong>header</strong> (<em>Header</em><em> | </em><em>None</em>) – </p></li>
<li><p><strong>z</strong> (<em>float</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="#tokult.fitting.FitParamsWithUnits" title="tokult.fitting.FitParamsWithUnits"><em>FitParamsWithUnits</em></a></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tokult.get_bound_params">
<span class="sig-prename descclassname"><span class="pre">tokult.</span></span><span class="sig-name descname"><span class="pre">get_bound_params</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x0_dyn</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(-inf,</span> <span class="pre">inf)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y0_dyn</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(-inf,</span> <span class="pre">inf)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">PA_dyn</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(0.0,</span> <span class="pre">6.283185307179586)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inclination_dyn</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(0.0,</span> <span class="pre">1.5707963267948966)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">radius_dyn</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(0.0,</span> <span class="pre">inf)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">velocity_sys</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(-inf,</span> <span class="pre">inf)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mass_dyn</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(-inf,</span> <span class="pre">inf)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">brightness_center</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(0.0,</span> <span class="pre">inf)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">velocity_dispersion</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(0.0,</span> <span class="pre">inf)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">radius_emi</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(0.0,</span> <span class="pre">inf)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x0_emi</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(-inf,</span> <span class="pre">inf)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y0_emi</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(-inf,</span> <span class="pre">inf)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">PA_emi</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(0.0,</span> <span class="pre">6.283185307179586)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inclination_emi</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(0.0,</span> <span class="pre">1.5707963267948966)</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tokult.get_bound_params" title="Permalink to this definition"></a></dt>
<dd><p>Return bound parameters.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x0_dyn</strong> (<em>tuple</em><em>[</em><em>float</em><em>, </em><em>float</em><em>]</em>) – </p></li>
<li><p><strong>y0_dyn</strong> (<em>tuple</em><em>[</em><em>float</em><em>, </em><em>float</em><em>]</em>) – </p></li>
<li><p><strong>PA_dyn</strong> (<em>tuple</em><em>[</em><em>float</em><em>, </em><em>float</em><em>]</em>) – </p></li>
<li><p><strong>inclination_dyn</strong> (<em>tuple</em><em>[</em><em>float</em><em>, </em><em>float</em><em>]</em>) – </p></li>
<li><p><strong>radius_dyn</strong> (<em>tuple</em><em>[</em><em>float</em><em>, </em><em>float</em><em>]</em>) – </p></li>
<li><p><strong>velocity_sys</strong> (<em>tuple</em><em>[</em><em>float</em><em>, </em><em>float</em><em>]</em>) – </p></li>
<li><p><strong>mass_dyn</strong> (<em>tuple</em><em>[</em><em>float</em><em>, </em><em>float</em><em>]</em>) – </p></li>
<li><p><strong>brightness_center</strong> (<em>tuple</em><em>[</em><em>float</em><em>, </em><em>float</em><em>]</em>) – </p></li>
<li><p><strong>velocity_dispersion</strong> (<em>tuple</em><em>[</em><em>float</em><em>, </em><em>float</em><em>]</em>) – </p></li>
<li><p><strong>radius_emi</strong> (<em>tuple</em><em>[</em><em>float</em><em>, </em><em>float</em><em>]</em>) – </p></li>
<li><p><strong>x0_emi</strong> (<em>tuple</em><em>[</em><em>float</em><em>, </em><em>float</em><em>]</em>) – </p></li>
<li><p><strong>y0_emi</strong> (<em>tuple</em><em>[</em><em>float</em><em>, </em><em>float</em><em>]</em>) – </p></li>
<li><p><strong>PA_emi</strong> (<em>tuple</em><em>[</em><em>float</em><em>, </em><em>float</em><em>]</em>) – </p></li>
<li><p><strong>inclination_emi</strong> (<em>tuple</em><em>[</em><em>float</em><em>, </em><em>float</em><em>]</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>tuple[<a class="reference internal" href="#tokult.fitting.InputParams" title="tokult.fitting.InputParams">tokult.fitting.InputParams</a>, <a class="reference internal" href="#tokult.fitting.InputParams" title="tokult.fitting.InputParams">tokult.fitting.InputParams</a>]</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-tokult.common">
<span id="tokult-common-module"></span><h2>tokult.common module<a class="headerlink" href="#module-tokult.common" title="Permalink to this heading"></a></h2>
<p>Common utilities</p>
</section>
<section id="module-tokult.fitting">
<span id="tokult-fitting-module"></span><h2>tokult.fitting module<a class="headerlink" href="#module-tokult.fitting" title="Permalink to this heading"></a></h2>
<p>Modules of fitting functions</p>
<dl class="py class">
<dt class="sig sig-object py" id="tokult.fitting.InputParams">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">tokult.fitting.</span></span><span class="sig-name descname"><span class="pre">InputParams</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x0_dyn</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y0_dyn</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">PA_dyn</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inclination_dyn</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">radius_dyn</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">velocity_sys</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mass_dyn</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">brightness_center</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">velocity_dispersion</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">radius_emi</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x0_emi</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y0_emi</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">PA_emi</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inclination_emi</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tokult.fitting.InputParams" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">NamedTuple</span></code></p>
<p>Input parameters for construct_model_at_imageplane.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x0_dyn</strong> (<em>float</em>) – </p></li>
<li><p><strong>y0_dyn</strong> (<em>float</em>) – </p></li>
<li><p><strong>PA_dyn</strong> (<em>float</em>) – </p></li>
<li><p><strong>inclination_dyn</strong> (<em>float</em>) – </p></li>
<li><p><strong>radius_dyn</strong> (<em>float</em>) – </p></li>
<li><p><strong>velocity_sys</strong> (<em>float</em>) – </p></li>
<li><p><strong>mass_dyn</strong> (<em>float</em>) – </p></li>
<li><p><strong>brightness_center</strong> (<em>float</em>) – </p></li>
<li><p><strong>velocity_dispersion</strong> (<em>float</em>) – </p></li>
<li><p><strong>radius_emi</strong> (<em>float</em>) – </p></li>
<li><p><strong>x0_emi</strong> (<em>float</em>) – </p></li>
<li><p><strong>y0_emi</strong> (<em>float</em>) – </p></li>
<li><p><strong>PA_emi</strong> (<em>float</em>) – </p></li>
<li><p><strong>inclination_emi</strong> (<em>float</em>) – </p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="tokult.fitting.InputParams.x0_dyn">
<span class="sig-name descname"><span class="pre">x0_dyn</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">float</span></em><a class="headerlink" href="#tokult.fitting.InputParams.x0_dyn" title="Permalink to this definition"></a></dt>
<dd><p>the coordinate on x-axis</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="tokult.fitting.InputParams.y0_dyn">
<span class="sig-name descname"><span class="pre">y0_dyn</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">float</span></em><a class="headerlink" href="#tokult.fitting.InputParams.y0_dyn" title="Permalink to this definition"></a></dt>
<dd><p>Alias for field number 1</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="tokult.fitting.InputParams.PA_dyn">
<span class="sig-name descname"><span class="pre">PA_dyn</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">float</span></em><a class="headerlink" href="#tokult.fitting.InputParams.PA_dyn" title="Permalink to this definition"></a></dt>
<dd><p>Alias for field number 2</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="tokult.fitting.InputParams.inclination_dyn">
<span class="sig-name descname"><span class="pre">inclination_dyn</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">float</span></em><a class="headerlink" href="#tokult.fitting.InputParams.inclination_dyn" title="Permalink to this definition"></a></dt>
<dd><p>Alias for field number 3</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="tokult.fitting.InputParams.radius_dyn">
<span class="sig-name descname"><span class="pre">radius_dyn</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">float</span></em><a class="headerlink" href="#tokult.fitting.InputParams.radius_dyn" title="Permalink to this definition"></a></dt>
<dd><p>Alias for field number 4</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="tokult.fitting.InputParams.velocity_sys">
<span class="sig-name descname"><span class="pre">velocity_sys</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">float</span></em><a class="headerlink" href="#tokult.fitting.InputParams.velocity_sys" title="Permalink to this definition"></a></dt>
<dd><p>Alias for field number 5</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="tokult.fitting.InputParams.mass_dyn">
<span class="sig-name descname"><span class="pre">mass_dyn</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">float</span></em><a class="headerlink" href="#tokult.fitting.InputParams.mass_dyn" title="Permalink to this definition"></a></dt>
<dd><p>Alias for field number 6</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="tokult.fitting.InputParams.brightness_center">
<span class="sig-name descname"><span class="pre">brightness_center</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">float</span></em><a class="headerlink" href="#tokult.fitting.InputParams.brightness_center" title="Permalink to this definition"></a></dt>
<dd><p>Alias for field number 7</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="tokult.fitting.InputParams.velocity_dispersion">
<span class="sig-name descname"><span class="pre">velocity_dispersion</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">float</span></em><a class="headerlink" href="#tokult.fitting.InputParams.velocity_dispersion" title="Permalink to this definition"></a></dt>
<dd><p>Alias for field number 8</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="tokult.fitting.InputParams.radius_emi">
<span class="sig-name descname"><span class="pre">radius_emi</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">float</span></em><a class="headerlink" href="#tokult.fitting.InputParams.radius_emi" title="Permalink to this definition"></a></dt>
<dd><p>Alias for field number 9</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="tokult.fitting.InputParams.x0_emi">
<span class="sig-name descname"><span class="pre">x0_emi</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">float</span></em><a class="headerlink" href="#tokult.fitting.InputParams.x0_emi" title="Permalink to this definition"></a></dt>
<dd><p>Alias for field number 10</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="tokult.fitting.InputParams.y0_emi">
<span class="sig-name descname"><span class="pre">y0_emi</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">float</span></em><a class="headerlink" href="#tokult.fitting.InputParams.y0_emi" title="Permalink to this definition"></a></dt>
<dd><p>Alias for field number 11</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="tokult.fitting.InputParams.PA_emi">
<span class="sig-name descname"><span class="pre">PA_emi</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">float</span></em><a class="headerlink" href="#tokult.fitting.InputParams.PA_emi" title="Permalink to this definition"></a></dt>
<dd><p>Alias for field number 12</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="tokult.fitting.InputParams.inclination_emi">
<span class="sig-name descname"><span class="pre">inclination_emi</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">float</span></em><a class="headerlink" href="#tokult.fitting.InputParams.inclination_emi" title="Permalink to this definition"></a></dt>
<dd><p>Alias for field number 13</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tokult.fitting.InputParams.to_units">
<span class="sig-name descname"><span class="pre">to_units</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">header</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">redshift</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tokult.fitting.InputParams.to_units" title="Permalink to this definition"></a></dt>
<dd><p>Return input parameters with units.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>header</strong> (<em>Header</em>) – </p></li>
<li><p><strong>redshift</strong> (<em>float</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="#tokult.fitting.FitParamsWithUnits" title="tokult.fitting.FitParamsWithUnits"><em>FitParamsWithUnits</em></a></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="tokult.fitting.FitParamsWithUnits">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">tokult.fitting.</span></span><span class="sig-name descname"><span class="pre">FitParamsWithUnits</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x0_dyn</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y0_dyn</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">PA_dyn</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inclination_dyn</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">radius_dyn</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">velocity_sys</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mass_dyn</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">brightness_center</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">velocity_dispersion</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">radius_emi</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x0_emi</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y0_emi</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">PA_emi</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inclination_emi</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">header</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tokult.fitting.FitParamsWithUnits" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Fitting parameters with units.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x0_dyn</strong> (<em>u.Quantity</em>) – </p></li>
<li><p><strong>y0_dyn</strong> (<em>u.Quantities</em>) – </p></li>
<li><p><strong>PA_dyn</strong> (<em>u.Quantities</em>) – </p></li>
<li><p><strong>inclination_dyn</strong> (<em>u.Quantities</em>) – </p></li>
<li><p><strong>radius_dyn</strong> (<em>u.Quantities</em>) – </p></li>
<li><p><strong>velocity_sys</strong> (<em>u.Quantities</em>) – </p></li>
<li><p><strong>mass_dyn</strong> (<em>u.Quantities</em>) – </p></li>
<li><p><strong>brightness_center</strong> (<em>u.Quantities</em>) – </p></li>
<li><p><strong>velocity_dispersion</strong> (<em>u.Quantities</em>) – </p></li>
<li><p><strong>radius_emi</strong> (<em>u.Quantities</em>) – </p></li>
<li><p><strong>x0_emi</strong> (<em>u.Quantities</em>) – </p></li>
<li><p><strong>y0_emi</strong> (<em>u.Quantities</em>) – </p></li>
<li><p><strong>PA_emi</strong> (<em>u.Quantities</em>) – </p></li>
<li><p><strong>inclination_emi</strong> (<em>u.Quantities</em>) – </p></li>
<li><p><strong>header</strong> (<em>Optional</em><em>[</em><em>fits.Header</em><em>]</em>) – </p></li>
<li><p><strong>z</strong> (<em>float</em>) – </p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="tokult.fitting.FitParamsWithUnits.x0_dyn">
<span class="sig-name descname"><span class="pre">x0_dyn</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">u.Quantity</span></em><a class="headerlink" href="#tokult.fitting.FitParamsWithUnits.x0_dyn" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="tokult.fitting.FitParamsWithUnits.y0_dyn">
<span class="sig-name descname"><span class="pre">y0_dyn</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">u.Quantities</span></em><a class="headerlink" href="#tokult.fitting.FitParamsWithUnits.y0_dyn" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="tokult.fitting.FitParamsWithUnits.PA_dyn">
<span class="sig-name descname"><span class="pre">PA_dyn</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">u.Quantities</span></em><a class="headerlink" href="#tokult.fitting.FitParamsWithUnits.PA_dyn" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="tokult.fitting.FitParamsWithUnits.inclination_dyn">
<span class="sig-name descname"><span class="pre">inclination_dyn</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">u.Quantities</span></em><a class="headerlink" href="#tokult.fitting.FitParamsWithUnits.inclination_dyn" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="tokult.fitting.FitParamsWithUnits.radius_dyn">
<span class="sig-name descname"><span class="pre">radius_dyn</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">u.Quantities</span></em><a class="headerlink" href="#tokult.fitting.FitParamsWithUnits.radius_dyn" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="tokult.fitting.FitParamsWithUnits.velocity_sys">
<span class="sig-name descname"><span class="pre">velocity_sys</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">u.Quantities</span></em><a class="headerlink" href="#tokult.fitting.FitParamsWithUnits.velocity_sys" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="tokult.fitting.FitParamsWithUnits.mass_dyn">
<span class="sig-name descname"><span class="pre">mass_dyn</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">u.Quantities</span></em><a class="headerlink" href="#tokult.fitting.FitParamsWithUnits.mass_dyn" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="tokult.fitting.FitParamsWithUnits.brightness_center">
<span class="sig-name descname"><span class="pre">brightness_center</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">u.Quantities</span></em><a class="headerlink" href="#tokult.fitting.FitParamsWithUnits.brightness_center" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="tokult.fitting.FitParamsWithUnits.velocity_dispersion">
<span class="sig-name descname"><span class="pre">velocity_dispersion</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">u.Quantities</span></em><a class="headerlink" href="#tokult.fitting.FitParamsWithUnits.velocity_dispersion" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="tokult.fitting.FitParamsWithUnits.radius_emi">
<span class="sig-name descname"><span class="pre">radius_emi</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">u.Quantities</span></em><a class="headerlink" href="#tokult.fitting.FitParamsWithUnits.radius_emi" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="tokult.fitting.FitParamsWithUnits.x0_emi">
<span class="sig-name descname"><span class="pre">x0_emi</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">u.Quantities</span></em><a class="headerlink" href="#tokult.fitting.FitParamsWithUnits.x0_emi" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="tokult.fitting.FitParamsWithUnits.y0_emi">
<span class="sig-name descname"><span class="pre">y0_emi</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">u.Quantities</span></em><a class="headerlink" href="#tokult.fitting.FitParamsWithUnits.y0_emi" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="tokult.fitting.FitParamsWithUnits.PA_emi">
<span class="sig-name descname"><span class="pre">PA_emi</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">u.Quantities</span></em><a class="headerlink" href="#tokult.fitting.FitParamsWithUnits.PA_emi" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="tokult.fitting.FitParamsWithUnits.inclination_emi">
<span class="sig-name descname"><span class="pre">inclination_emi</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">u.Quantities</span></em><a class="headerlink" href="#tokult.fitting.FitParamsWithUnits.inclination_emi" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="tokult.fitting.FitParamsWithUnits.header">
<span class="sig-name descname"><span class="pre">header</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">fits.Header</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#tokult.fitting.FitParamsWithUnits.header" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="tokult.fitting.FitParamsWithUnits.z">
<span class="sig-name descname"><span class="pre">z</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">float</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">0.0</span></em><a class="headerlink" href="#tokult.fitting.FitParamsWithUnits.z" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="tokult.fitting.FitParamsWithUnits.wcs">
<span class="sig-name descname"><span class="pre">wcs</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">WCS</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#tokult.fitting.FitParamsWithUnits.wcs" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="tokult.fitting.FitParamsWithUnits.pixelscale">
<span class="sig-name descname"><span class="pre">pixelscale</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">u.Equivalency</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#tokult.fitting.FitParamsWithUnits.pixelscale" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="tokult.fitting.FitParamsWithUnits.freq_rest">
<span class="sig-name descname"><span class="pre">freq_rest</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">u.Quantities</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#tokult.fitting.FitParamsWithUnits.freq_rest" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="tokult.fitting.FitParamsWithUnits.vpixelscale">
<span class="sig-name descname"><span class="pre">vpixelscale</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">u.Equivalency</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#tokult.fitting.FitParamsWithUnits.vpixelscale" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="tokult.fitting.FitParamsWithUnits.diskmassscale">
<span class="sig-name descname"><span class="pre">diskmassscale</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">u.Equivalency</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#tokult.fitting.FitParamsWithUnits.diskmassscale" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tokult.fitting.FitParamsWithUnits.to_physicalscale">
<span class="sig-name descname"><span class="pre">to_physicalscale</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#tokult.fitting.FitParamsWithUnits.to_physicalscale" title="Permalink to this definition"></a></dt>
<dd><p>Convert values to physicalscales.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tokult.fitting.FitParamsWithUnits.vmax">
<span class="sig-name descname"><span class="pre">vmax</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#tokult.fitting.FitParamsWithUnits.vmax" title="Permalink to this definition"></a></dt>
<dd><p>Maximum rotation velcoity.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tokult.fitting.FitParamsWithUnits.from_inputparams">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">from_inputparams</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">inputparams</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">header</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tokult.fitting.FitParamsWithUnits.from_inputparams" title="Permalink to this definition"></a></dt>
<dd><p>Constructer from InputParams</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>inputparams</strong> (<a class="reference internal" href="#tokult.fitting.InputParams" title="tokult.fitting.InputParams"><em>InputParams</em></a><em> | </em><em>InputParamsArray</em>) – </p></li>
<li><p><strong>header</strong> (<em>Header</em><em> | </em><em>None</em>) – </p></li>
<li><p><strong>z</strong> (<em>float</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="#tokult.fitting.FitParamsWithUnits" title="tokult.fitting.FitParamsWithUnits"><em>FitParamsWithUnits</em></a></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tokult.fitting.get_bound_params">
<span class="sig-prename descclassname"><span class="pre">tokult.fitting.</span></span><span class="sig-name descname"><span class="pre">get_bound_params</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x0_dyn</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(-inf,</span> <span class="pre">inf)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y0_dyn</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(-inf,</span> <span class="pre">inf)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">PA_dyn</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(0.0,</span> <span class="pre">6.283185307179586)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inclination_dyn</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(0.0,</span> <span class="pre">1.5707963267948966)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">radius_dyn</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(0.0,</span> <span class="pre">inf)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">velocity_sys</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(-inf,</span> <span class="pre">inf)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mass_dyn</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(-inf,</span> <span class="pre">inf)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">brightness_center</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(0.0,</span> <span class="pre">inf)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">velocity_dispersion</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(0.0,</span> <span class="pre">inf)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">radius_emi</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(0.0,</span> <span class="pre">inf)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x0_emi</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(-inf,</span> <span class="pre">inf)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y0_emi</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(-inf,</span> <span class="pre">inf)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">PA_emi</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(0.0,</span> <span class="pre">6.283185307179586)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inclination_emi</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(0.0,</span> <span class="pre">1.5707963267948966)</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tokult.fitting.get_bound_params" title="Permalink to this definition"></a></dt>
<dd><p>Return bound parameters.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x0_dyn</strong> (<em>tuple</em><em>[</em><em>float</em><em>, </em><em>float</em><em>]</em>) – </p></li>
<li><p><strong>y0_dyn</strong> (<em>tuple</em><em>[</em><em>float</em><em>, </em><em>float</em><em>]</em>) – </p></li>
<li><p><strong>PA_dyn</strong> (<em>tuple</em><em>[</em><em>float</em><em>, </em><em>float</em><em>]</em>) – </p></li>
<li><p><strong>inclination_dyn</strong> (<em>tuple</em><em>[</em><em>float</em><em>, </em><em>float</em><em>]</em>) – </p></li>
<li><p><strong>radius_dyn</strong> (<em>tuple</em><em>[</em><em>float</em><em>, </em><em>float</em><em>]</em>) – </p></li>
<li><p><strong>velocity_sys</strong> (<em>tuple</em><em>[</em><em>float</em><em>, </em><em>float</em><em>]</em>) – </p></li>
<li><p><strong>mass_dyn</strong> (<em>tuple</em><em>[</em><em>float</em><em>, </em><em>float</em><em>]</em>) – </p></li>
<li><p><strong>brightness_center</strong> (<em>tuple</em><em>[</em><em>float</em><em>, </em><em>float</em><em>]</em>) – </p></li>
<li><p><strong>velocity_dispersion</strong> (<em>tuple</em><em>[</em><em>float</em><em>, </em><em>float</em><em>]</em>) – </p></li>
<li><p><strong>radius_emi</strong> (<em>tuple</em><em>[</em><em>float</em><em>, </em><em>float</em><em>]</em>) – </p></li>
<li><p><strong>x0_emi</strong> (<em>tuple</em><em>[</em><em>float</em><em>, </em><em>float</em><em>]</em>) – </p></li>
<li><p><strong>y0_emi</strong> (<em>tuple</em><em>[</em><em>float</em><em>, </em><em>float</em><em>]</em>) – </p></li>
<li><p><strong>PA_emi</strong> (<em>tuple</em><em>[</em><em>float</em><em>, </em><em>float</em><em>]</em>) – </p></li>
<li><p><strong>inclination_emi</strong> (<em>tuple</em><em>[</em><em>float</em><em>, </em><em>float</em><em>]</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>tuple[<a class="reference internal" href="#tokult.fitting.InputParams" title="tokult.fitting.InputParams">tokult.fitting.InputParams</a>, <a class="reference internal" href="#tokult.fitting.InputParams" title="tokult.fitting.InputParams">tokult.fitting.InputParams</a>]</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-tokult.function">
<span id="tokult-function-module"></span><h2>tokult.function module<a class="headerlink" href="#module-tokult.function" title="Permalink to this heading"></a></h2>
<p>Modules of functions</p>
<dl class="py function">
<dt class="sig sig-object py" id="tokult.function.gaussian">
<span class="sig-prename descclassname"><span class="pre">tokult.function.</span></span><span class="sig-name descname"><span class="pre">gaussian</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">center</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sigma</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">area</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tokult.function.gaussian" title="Permalink to this definition"></a></dt>
<dd><p>Gaussian function.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<em>ndarray</em>) – </p></li>
<li><p><strong>center</strong> (<em>ArrayLike</em>) – </p></li>
<li><p><strong>sigma</strong> (<em>float</em>) – </p></li>
<li><p><strong>area</strong> (<em>ArrayLike</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><em>ndarray</em></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tokult.function.reciprocal_exp">
<span class="sig-prename descclassname"><span class="pre">tokult.function.</span></span><span class="sig-name descname"><span class="pre">reciprocal_exp</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">r</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norm</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rnorm</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tokult.function.reciprocal_exp" title="Permalink to this definition"></a></dt>
<dd><p>Exponential function</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>r</strong> (<em>ndarray</em>) – </p></li>
<li><p><strong>norm</strong> (<em>float</em>) – </p></li>
<li><p><strong>rnorm</strong> (<em>float</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><em>ndarray</em></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tokult.function.freeman_disk">
<span class="sig-prename descclassname"><span class="pre">tokult.function.</span></span><span class="sig-name descname"><span class="pre">freeman_disk</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">r</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">phi</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mass_dyn</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rnorm</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">incl</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tokult.function.freeman_disk" title="Permalink to this definition"></a></dt>
<dd><p>Freeman disk function</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>r</strong> (<em>ndarray</em>) – </p></li>
<li><p><strong>phi</strong> (<em>ndarray</em>) – </p></li>
<li><p><strong>mass_dyn</strong> (<em>float</em>) – </p></li>
<li><p><strong>rnorm</strong> (<em>float</em>) – </p></li>
<li><p><strong>incl</strong> (<em>float</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><em>ndarray</em></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tokult.function.maximum_rotation_velocity">
<span class="sig-prename descclassname"><span class="pre">tokult.function.</span></span><span class="sig-name descname"><span class="pre">maximum_rotation_velocity</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mass_dyn</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rnorm</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tokult.function.maximum_rotation_velocity" title="Permalink to this definition"></a></dt>
<dd><p>Maximum rotation velocity of Freeman disk function</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mass_dyn</strong> (<em>Quantity</em><em> | </em><em>ndarray</em><em> | </em><em>float</em>) – </p></li>
<li><p><strong>rnorm</strong> (<em>Quantity</em><em> | </em><em>ndarray</em><em> | </em><em>float</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><em>Quantity</em> | <em>ndarray</em> | float</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-tokult.misc">
<span id="tokult-misc-module"></span><h2>tokult.misc module<a class="headerlink" href="#module-tokult.misc" title="Permalink to this heading"></a></h2>
<p>miscellaneous functions</p>
</section>
<section id="module-tokult.casa">
<span id="tokult-casa-module"></span><h2>tokult.casa module<a class="headerlink" href="#module-tokult.casa" title="Permalink to this heading"></a></h2>
<p>Modules to analyze measurement sets.
These modules are under construction.</p>
</section>
<section id="module-tokult.casa_dummy">
<span id="tokult-casa-dummy-module"></span><h2>tokult.casa_dummy module<a class="headerlink" href="#module-tokult.casa_dummy" title="Permalink to this heading"></a></h2>
<p>Dummy CASA modules</p>
</section>
<section id="module-tokult.core">
<span id="tokult-core-module"></span><h2>tokult.core module<a class="headerlink" href="#module-tokult.core" title="Permalink to this heading"></a></h2>
<p>Core modules of tokult.</p>
<dl class="py class">
<dt class="sig sig-object py" id="tokult.core.Tokult">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">tokult.core.</span></span><span class="sig-name descname"><span class="pre">Tokult</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">datacube</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dirtybeam</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gravlens</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tokult.core.Tokult" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Interface of Tokult.</p>
<p>Users specify data to launch an instance object and start fitting through
the instance. This class contains observed data, psf, and lensing parameters,
along with useful functions to manipulate data and models.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>datacube</strong> (<a class="reference internal" href="#tokult.core.DataCube" title="tokult.core.DataCube"><em>DataCube</em></a>) – </p></li>
<li><p><strong>dirtybeam</strong> (<em>Optional</em><em>[</em><a class="reference internal" href="#tokult.core.DirtyBeam" title="tokult.core.DirtyBeam"><em>DirtyBeam</em></a><em>]</em><em>, </em><em>optional</em>) – Defaults to None.</p></li>
<li><p><strong>gravlens</strong> (<em>Optional</em><em>[</em><a class="reference internal" href="#tokult.core.GravLens" title="tokult.core.GravLens"><em>GravLens</em></a><em>]</em><em>, </em><em>optional</em>) – Defaults to None.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">tokult</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tok</span> <span class="o">=</span> <span class="n">tokult</span><span class="o">.</span><span class="n">Tokult</span><span class="o">.</span><span class="n">launch</span><span class="p">(</span><span class="s1">&#39;data.fits&#39;</span><span class="p">,</span> <span class="s1">&#39;psf.fits&#39;</span><span class="p">,</span>
<span class="go">                             (&#39;x-arcsec-deflect.fits&#39;, &#39;y-arcsec-deflect.fits&#39;))</span>
</pre></div>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="tokult.core.Tokult.launch">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">launch</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">beam</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gravlens</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">header_data</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">header_beam</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">header_gravlens</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">index_data</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">index_beam</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">index_gravlens</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tokult.core.Tokult.launch" title="Permalink to this definition"></a></dt>
<dd><p>Constructer of <code class="docutils literal notranslate"><span class="pre">Tokult</span></code>.</p>
<p>Construct an instance easier than to use the init constructer.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> (<em>Union</em><em>[</em><em>np.ndarray</em><em>, </em><em>str</em><em>]</em>) – Observed data. The format is a data
array or a fits file name.</p></li>
<li><p><strong>beam</strong> (<em>Union</em><em>[</em><em>np.ndarray</em><em>, </em><em>str</em><em>, </em><em>None</em><em>]</em><em>, </em><em>optional</em>) – Dirty beam or point
spread function (PSF). The format is a data array or a fits file
name. Defaults to None.</p></li>
<li><p><strong>gravlens</strong> (<em>Union</em><em>[</em><em>tuple</em><em>[</em><em>np.ndarray</em><em>, </em><em>...</em><em>]</em><em>, </em><em>tuple</em><em>[</em><em>str</em><em>, </em><em>...</em><em>]</em><em>]</em><em>, </em><em>None</em><em>, </em><em>optional</em>) – Gravitational lensing parameters. The format is a tuple containing
the three data array or fits file names of parameters:
x_arcsec_deflect and y_arcsec_deflect. Defaults to None.</p></li>
<li><p><strong>header_data</strong> (<em>Optional</em><em>[</em><em>fits.Header</em><em>]</em><em>, </em><em>optional</em>) – Header of data.
Defaults to None.
This is necessary when the <code class="docutils literal notranslate"><span class="pre">data</span></code> is not given in a fits file.</p></li>
<li><p><strong>header_beam</strong> (<em>Optional</em><em>[</em><em>fits.Header</em><em>]</em><em>, </em><em>optional</em>) – Header of psf.
Defaults to None.
This is necessary when <code class="docutils literal notranslate"><span class="pre">beam</span></code> is not given in a fits file.</p></li>
<li><p><strong>header_gravlens</strong> (<em>Optional</em><em>[</em><em>fits.Header</em><em>]</em><em>, </em><em>optional</em>) – Header of gravlens.
Defaults to None.
This is necessary when <code class="docutils literal notranslate"><span class="pre">gravlens</span></code> is not given in fits files.</p></li>
<li><p><strong>index_data</strong> (<em>int</em><em>, </em><em>optional</em>) – Index of fits extensions of the data fits
file. Defaults to 0.</p></li>
<li><p><strong>index_beam</strong> (<em>int</em><em>, </em><em>optional</em>) – Index of fits extensions of the beam fits
file. Defaults to 0.</p></li>
<li><p><strong>index_gravlens</strong> (<em>int</em><em>, </em><em>optional</em>) – Index of fits extensions of the lens
fits files. Defaults to 0.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="#tokult.core.Tokult" title="tokult.core.Tokult"><em>Tokult</em></a></p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">tok</span> <span class="o">=</span> <span class="n">tokult</span><span class="o">.</span><span class="n">Tokult</span><span class="o">.</span><span class="n">launch</span><span class="p">(</span>
<span class="go">             &#39;data.fits&#39;, &#39;psf.fits&#39;,</span>
<span class="go">             (x_arcsec_deflect.fits&#39;, y_arcsec_deflect.fits&#39;))</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tokult.core.Tokult.imagefit">
<span class="sig-name descname"><span class="pre">imagefit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">init</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bound</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fix</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">optimization</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'mc'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">niter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nperturb</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nwalkers</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">64</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nsteps</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pool</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">is_separate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mask_for_fit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">uvcoverage</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">progressbar</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tokult.core.Tokult.imagefit" title="Permalink to this definition"></a></dt>
<dd><p>Fit a 3d model to the data cube on the image plane.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>init</strong> (<em>Sequence</em><em>[</em><em>float</em><em>]</em>) – Initial parameters of fitting.</p></li>
<li><p><strong>bound</strong> (<em>Optional</em><em>[</em><em>tuple</em><em>[</em><em>Sequence</em><em>[</em><em>float</em><em>]</em><em>, </em><em>Sequence</em><em>[</em><em>float</em><em>]</em><em>]</em><em>, </em><em>optional</em>) – Boundaries of parameters. Defaults to None.
When None is given, the default parameter boundaries are used.
The boundaries can be easily set using <code class="docutils literal notranslate"><span class="pre">get_bound_params</span></code>.
Currently, in the mcmc method, only flat prior distributions
are available through this argument.</p></li>
<li><p><strong>fix</strong> (<em>Optional</em><em>[</em><em>fitting.FixParams</em><em>]</em><em>, </em><em>optional</em>) – Defaults to None.</p></li>
<li><p><strong>optimization</strong> (<em>str</em><em>, </em><em>optional</em>) – Defaults to ‘mc’.</p></li>
<li><p><strong>niter</strong> (<em>int</em><em>, </em><em>optional</em>) – Number of iterations of fitting, used
in the least square method. Defaults to 1.</p></li>
<li><p><strong>nperturb</strong> (<em>int</em><em>, </em><em>optional</em>) – Number of perturbations in the Monte Carlo
method. Defaults to 1000.</p></li>
<li><p><strong>nwalkers</strong> (<em>int</em><em>, </em><em>optional</em>) – Number of walkers, used in the MCMC method.
Defaults to 64.</p></li>
<li><p><strong>nsteps</strong> (<em>int</em><em>, </em><em>optional</em>) – Number of steps, used in the MCMC method.
Defaults to 5000.</p></li>
<li><p><strong>pool</strong> (<em>Optional</em><em>[</em><em>Pool</em><em>]</em><em>, </em><em>optional</em>) – multiprocessing.pool for a multi-process
MCMC fitting. Defaults to None.</p></li>
<li><p><strong>is_separate</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, parameters regarding kinematics
and emission are separated; and thus fitting uses all the 14
parameters. If False, the parameters are the same and
the number of free parameters are reduced. Defaults to False.</p></li>
<li><p><strong>mask_for_fit</strong> (<em>Optional</em><em>[</em><em>np.ndarray</em><em>]</em><em>, </em><em>optional</em>) – Mask specifying pixels
used for fitting. Defaults to None.</p></li>
<li><p><strong>progressbar</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, a progress bar is shown.
Defaults to False.</p></li>
<li><p><strong>uvcoverage</strong> (<em>ndarray</em><em> | </em><em>None</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Fitting results and related parameters.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>fitting.Solution</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">sol</span> <span class="o">=</span> <span class="n">tok</span><span class="o">.</span><span class="n">imagefit</span><span class="p">(</span><span class="n">init</span><span class="p">,</span> <span class="n">bound</span><span class="p">,</span> <span class="n">optimization</span><span class="o">=</span><span class="s1">&#39;mc&#39;</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tokult.core.Tokult.uvfit">
<span class="sig-name descname"><span class="pre">uvfit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">init</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bound</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fix</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">optimization</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'mcmc'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">niter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nwalkers</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">64</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nsteps</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pool</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">is_separate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mask_for_fit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">progressbar</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tokult.core.Tokult.uvfit" title="Permalink to this definition"></a></dt>
<dd><p>Fit a 3d model to the data cube on the uv plane.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>init</strong> (<em>Sequence</em><em>[</em><em>float</em><em>]</em>) – Initial parameters of fitting.
a function to guess initial parameters: <code class="docutils literal notranslate"><span class="pre">tokult.initialguess()</span></code>.</p></li>
<li><p><strong>bound</strong> (<em>Optional</em><em>[</em><em>tuple</em><em>[</em><em>Sequence</em><em>[</em><em>float</em><em>]</em><em>, </em><em>Sequence</em><em>[</em><em>float</em><em>]</em><em>]</em><em>, </em><em>optional</em>) – Boundaries of parameters. Defaults to None.
When None is given, the default parameter boundaries are used.
The boundaries can be easily set using <code class="docutils literal notranslate"><span class="pre">get_bound_params</span></code>.
Currently, in the mcmc method, only flat prior distributions
are available through this argument.</p></li>
<li><p><strong>fix</strong> (<em>Optional</em><em>[</em><em>fitting.FixParams</em><em>]</em><em>, </em><em>optional</em>) – Fix parameters during
fitting. See <code class="docutils literal notranslate"><span class="pre">FixParams</span></code>. Defaults to None.</p></li>
<li><p><strong>optimization</strong> (<em>str</em><em>, </em><em>optional</em>) – Method to optimize the 3D model.
- ‘ls’: least square method.
- ‘mcmc’: Malcov Chain Monte Carlo method.
Defaults to ‘mcmc’.</p></li>
<li><p><strong>niter</strong> (<em>int</em><em>, </em><em>optional</em>) – Number of iterations of fitting, used
in the least square method. Defaults to 1.</p></li>
<li><p><strong>nperturb</strong> (<em>int</em><em>, </em><em>optional</em>) – Number of perturbations in the Monte Carlo
method. Defaults to 1000.</p></li>
<li><p><strong>nwalkers</strong> (<em>int</em><em>, </em><em>optional</em>) – Number of walkers, used in the MCMC method.
Defaults to 64.</p></li>
<li><p><strong>nsteps</strong> (<em>int</em><em>, </em><em>optional</em>) – Number of steps, used in the MCMC method.
Defaults to 5000.</p></li>
<li><p><strong>pool</strong> (<em>Optional</em><em>[</em><em>Pool</em><em>]</em><em>, </em><em>optional</em>) – multiprocessing.pool for a multi-process
MCMC fitting. Defaults to None.</p></li>
<li><p><strong>is_separate</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, parameters regarding kinematics
and emission are separated; and thus fitting uses all the 14
parameters. If False, the parameters are the same and
the number of free parameters are reduced. Defaults to False.</p></li>
<li><p><strong>mask_for_fit</strong> (<em>Optional</em><em>[</em><em>np.ndarray</em><em>]</em><em>, </em><em>optional</em>) – Mask specifying pixels
used for fitting. In uv fitting, specifying the uv-coverage is
important, which is passed through this argument. Defaults to None.</p></li>
<li><p><strong>progressbar</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, a progress bar is shown.
Defaults to False.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Fitting results and related parameters.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>fitting.Solution</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">sol</span> <span class="o">=</span> <span class="n">tok</span><span class="o">.</span><span class="n">uvfit</span><span class="p">(</span><span class="n">init</span><span class="p">,</span> <span class="n">bound</span><span class="p">,</span> <span class="n">optimization</span><span class="o">=</span><span class="s1">&#39;mcmc&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The input parameters are the same as <code class="docutils literal notranslate"><span class="pre">imagefit</span></code>.</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tokult.core.Tokult.initialguess">
<span class="sig-name descname"><span class="pre">initialguess</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">is_separate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tokult.core.Tokult.initialguess" title="Permalink to this definition"></a></dt>
<dd><p>Guess initial input parameters for fitting.</p>
<p>Fit tow-dimensional moment-0 (flux) map and moment-1 (velocity) map then
Estimate input parameters from the 2-d fitting results.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>is_separate</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, parameters regarding kinematics
and emission are separated; and thus fitting uses all the 14
parameters. If False, the parameters are the same and
the number of free parameters are reduced. Defaults to False.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Best-guessed input parameters.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#tokult.fitting.InputParams" title="tokult.fitting.InputParams">fitting.InputParams</a></p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">init</span> <span class="o">=</span> <span class="n">tok</span><span class="o">.</span><span class="n">initialguess</span><span class="p">()</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Initial parameters are crucial for parameter fitting, especially in
the least-square and Monte Carlo methods and being related with speed
of convergence in the MCMC method.</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tokult.core.Tokult.use_region">
<span class="sig-name descname"><span class="pre">use_region</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">xlim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ylim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vlim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tokult.core.Tokult.use_region" title="Permalink to this definition"></a></dt>
<dd><p>Use a region of datacube used for fitting.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>xlim</strong> (<em>Optional</em><em>[</em><em>tuple</em><em>[</em><em>int</em><em>, </em><em>int</em><em>]</em><em>]</em><em>, </em><em>optional</em>) – The limit of the x-axis.
Defaults to None.</p></li>
<li><p><strong>ylim</strong> (<em>Optional</em><em>[</em><em>tuple</em><em>[</em><em>int</em><em>, </em><em>int</em><em>]</em><em>]</em><em>, </em><em>optional</em>) – The limit of the y-axis.
Defaults to None.</p></li>
<li><p><strong>vlim</strong> (<em>Optional</em><em>[</em><em>tuple</em><em>[</em><em>int</em><em>, </em><em>int</em><em>]</em><em>]</em><em>, </em><em>optional</em>) – The limit of the v-axis.
Defaults to None.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">tok</span><span class="o">.</span><span class="n">use_region</span><span class="p">((</span><span class="mi">32</span><span class="p">,</span> <span class="mi">96</span><span class="p">),</span> <span class="p">(</span><span class="mi">32</span><span class="p">,</span> <span class="mi">96</span><span class="p">),</span> <span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">12</span><span class="p">))</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>In <code class="docutils literal notranslate"><span class="pre">uvfit</span></code>, the v-axis limit must be specified smaller than
original cube size, because <code class="docutils literal notranslate"><span class="pre">uvfit</span></code> estimates the noise level
using the pixels outside <code class="docutils literal notranslate"><span class="pre">vlim</span></code>.</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tokult.core.Tokult.use_redshifts">
<span class="sig-name descname"><span class="pre">use_redshifts</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">z_source</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z_lens</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z_assumed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">inf</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tokult.core.Tokult.use_redshifts" title="Permalink to this definition"></a></dt>
<dd><p>Set the redshifts of the source and the lens galaxies.</p>
<p>The redshifts are used to compute the gravitational lensing effects and
to convert the parameters to the physical units.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>z_source</strong> (<em>float</em>) – The source (galaxy) redshift.</p></li>
<li><p><strong>z_lens</strong> (<em>float</em>) – The lens (cluster) redshift.</p></li>
<li><p><strong>z_assumed</strong> (<em>float</em><em>, </em><em>optional</em>) – The redshift assumed in the
gravitational parameters. If D_s / D_L = 1, the value
should be infinite (<code class="docutils literal notranslate"><span class="pre">np.inf</span></code>). Defaults to <code class="docutils literal notranslate"><span class="pre">np.inf</span></code>.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">tok</span><span class="o">.</span><span class="n">use_redshift</span><span class="p">(</span><span class="n">z_source</span><span class="o">=</span><span class="mf">6.2</span><span class="p">,</span> <span class="n">z_lens</span><span class="o">=</span><span class="mf">0.9</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tokult.core.Tokult.change_datacube">
<span class="sig-name descname"><span class="pre">change_datacube</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data_or_fname</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">header</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">index_hdul</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xlim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ylim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vlim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tokult.core.Tokult.change_datacube" title="Permalink to this definition"></a></dt>
<dd><p>Change the variable <code class="docutils literal notranslate"><span class="pre">datacube</span></code>.</p>
<p>May be useful to change <code class="docutils literal notranslate"><span class="pre">datacube</span></code> of an instance.</p>
<dl class="simple">
<dt>Nonte:</dt><dd><p>This method should be used before <code class="docutils literal notranslate"><span class="pre">use_region</span></code> and <code class="docutils literal notranslate"><span class="pre">use_redshift</span></code>.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data_or_fname</strong> (<em>ndarray</em><em> | </em><em>str</em>) – </p></li>
<li><p><strong>header</strong> (<em>Header</em><em> | </em><em>None</em>) – </p></li>
<li><p><strong>index_hdul</strong> (<em>int</em>) – </p></li>
<li><p><strong>xlim</strong> (<em>tuple</em><em>[</em><em>int</em><em>, </em><em>int</em><em>] </em><em>| </em><em>None</em>) – </p></li>
<li><p><strong>ylim</strong> (<em>tuple</em><em>[</em><em>int</em><em>, </em><em>int</em><em>] </em><em>| </em><em>None</em>) – </p></li>
<li><p><strong>vlim</strong> (<em>tuple</em><em>[</em><em>int</em><em>, </em><em>int</em><em>] </em><em>| </em><em>None</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tokult.core.Tokult.change_dirtybeam">
<span class="sig-name descname"><span class="pre">change_dirtybeam</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data_or_fname</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">header</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">index_hdul</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tokult.core.Tokult.change_dirtybeam" title="Permalink to this definition"></a></dt>
<dd><p>Change the variable <code class="docutils literal notranslate"><span class="pre">dirtybeam</span></code>.</p>
<p>May be useful to change <code class="docutils literal notranslate"><span class="pre">dirtybeam</span></code> of an instance.</p>
<dl class="simple">
<dt>Nonte:</dt><dd><p>This method should be used before <code class="docutils literal notranslate"><span class="pre">use_region</span></code> and <code class="docutils literal notranslate"><span class="pre">use_redshift</span></code>.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data_or_fname</strong> (<em>ndarray</em><em> | </em><em>str</em>) – </p></li>
<li><p><strong>header</strong> (<em>Header</em><em> | </em><em>None</em>) – </p></li>
<li><p><strong>index_hdul</strong> (<em>int</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tokult.core.Tokult.change_gravlens">
<span class="sig-name descname"><span class="pre">change_gravlens</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_or_fname_xy_arcsec_deflect</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_or_fname_xy_pixel_deflect</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_or_fname_psi_arcsec</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">header</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">index_hdul</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tokult.core.Tokult.change_gravlens" title="Permalink to this definition"></a></dt>
<dd><p>Change the variable <code class="docutils literal notranslate"><span class="pre">gravlens</span></code>.</p>
<p>May be useful to change <code class="docutils literal notranslate"><span class="pre">gravlens</span></code> of an instance.</p>
<dl class="simple">
<dt>Nonte:</dt><dd><p>This method should be used before <code class="docutils literal notranslate"><span class="pre">use_region</span></code> and <code class="docutils literal notranslate"><span class="pre">use_redshift</span></code>.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data_or_fname_xy_arcsec_deflect</strong> (<em>tuple</em><em>[</em><em>numpy.ndarray</em><em>, </em><em>...</em><em>] </em><em>| </em><em>tuple</em><em>[</em><em>str</em><em>, </em><em>...</em><em>] </em><em>| </em><em>None</em>) – </p></li>
<li><p><strong>data_or_fname_xy_pixel_deflect</strong> (<em>tuple</em><em>[</em><em>numpy.ndarray</em><em>, </em><em>...</em><em>] </em><em>| </em><em>tuple</em><em>[</em><em>str</em><em>, </em><em>...</em><em>] </em><em>| </em><em>None</em>) – </p></li>
<li><p><strong>data_or_fname_psi_arcsec</strong> (<em>ndarray</em><em> | </em><em>str</em><em> | </em><em>None</em>) – </p></li>
<li><p><strong>header</strong> (<em>Header</em><em> | </em><em>None</em>) – </p></li>
<li><p><strong>index_hdul</strong> (<em>int</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tokult.core.Tokult.construct_modelcube">
<span class="sig-name descname"><span class="pre">construct_modelcube</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">params</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tokult.core.Tokult.construct_modelcube" title="Permalink to this definition"></a></dt>
<dd><p>Construct <code class="docutils literal notranslate"><span class="pre">modelcube</span></code> from the input parameters.</p>
<p>Construct a 3D model and set it to an internal variable <code class="docutils literal notranslate"><span class="pre">modelcube</span></code>.
If you want to use a model outside <code class="docutils literal notranslate"><span class="pre">Tokult</span></code> instances, please use
<code class="docutils literal notranslate"><span class="pre">ModelCube.create()</span></code> instead.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>params</strong> (<em>tuple</em><em>[</em><em>float</em><em>, </em><em>...</em><em>]</em>) – Input parameters.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<p>Change a part of the best-fit parameters and construct the model.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">params</span> <span class="o">=</span> <span class="n">sol</span><span class="o">.</span><span class="n">best</span><span class="o">.</span><span class="n">_replace</span><span class="p">(</span><span class="n">PA_dyn</span><span class="o">=</span><span class="mf">0.0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tok</span><span class="o">.</span><span class="n">construct_modelcube</span><span class="p">(</span><span class="n">params</span><span class="p">)</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This method needs the global parameters to be set already.
You may need to fit the data once, before using this method.</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tokult.core.Tokult.calculate_normweight">
<span class="sig-name descname"><span class="pre">calculate_normweight</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#tokult.core.Tokult.calculate_normweight" title="Permalink to this definition"></a></dt>
<dd><p>Calculate the normalization weight used in <code class="docutils literal notranslate"><span class="pre">uvfit</span></code>.</p>
<p>The obtained value is almost equal to sum-of-weight, but different by a
factor of a few.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>The normalization weight</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>float</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="tokult.core.Cube">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">tokult.core.</span></span><span class="sig-name descname"><span class="pre">Cube</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">imageplane</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">header</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xlim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ylim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vlim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tokult.core.Cube" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>3D data cube.</p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="go">&gt;&gt;&gt;</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>imageplane</strong> (<em>np.ndarray</em>) – </p></li>
<li><p><strong>header</strong> (<em>Optional</em><em>[</em><em>fits.Header</em><em>]</em>) – </p></li>
<li><p><strong>xlim</strong> (<em>Optional</em><em>[</em><em>tuple</em><em>[</em><em>int</em><em>, </em><em>int</em><em>]</em><em>]</em>) – </p></li>
<li><p><strong>ylim</strong> (<em>Optional</em><em>[</em><em>tuple</em><em>[</em><em>int</em><em>, </em><em>int</em><em>]</em><em>]</em>) – </p></li>
<li><p><strong>vlim</strong> (<em>Optional</em><em>[</em><em>tuple</em><em>[</em><em>int</em><em>, </em><em>int</em><em>]</em><em>]</em>) – </p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="tokult.core.Cube.imageplane">
<span class="sig-name descname"><span class="pre">imageplane</span></span><a class="headerlink" href="#tokult.core.Cube.imageplane" title="Permalink to this definition"></a></dt>
<dd><p>Cutout 3D data cube on the image plane.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="tokult.core.Cube.uvplane">
<span class="sig-name descname"><span class="pre">uvplane</span></span><a class="headerlink" href="#tokult.core.Cube.uvplane" title="Permalink to this definition"></a></dt>
<dd><p>Cutout 3D data cube on the uv plane.
This is the Fourier transformation of <code class="docutils literal notranslate"><span class="pre">imageplane</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="tokult.core.Cube.original">
<span class="sig-name descname"><span class="pre">original</span></span><a class="headerlink" href="#tokult.core.Cube.original" title="Permalink to this definition"></a></dt>
<dd><p>Original-size, 3D data cube.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="tokult.core.Cube.header">
<span class="sig-name descname"><span class="pre">header</span></span><a class="headerlink" href="#tokult.core.Cube.header" title="Permalink to this definition"></a></dt>
<dd><p>Header of the fits data.
Defaults to None.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Optional[fits.Header]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tokult.core.Cube.cutout">
<span class="sig-name descname"><span class="pre">cutout</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">xlim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ylim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vlim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tokult.core.Cube.cutout" title="Permalink to this definition"></a></dt>
<dd><p>Cutout 3D cube from <code class="docutils literal notranslate"><span class="pre">original</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>xlim</strong> (<em>Optional</em><em>[</em><em>tuple</em><em>[</em><em>int</em><em>, </em><em>int</em><em>]</em><em>]</em><em>, </em><em>optional</em>) – The limit of the x-axis.
Defaults to None.</p></li>
<li><p><strong>ylim</strong> (<em>Optional</em><em>[</em><em>tuple</em><em>[</em><em>int</em><em>, </em><em>int</em><em>]</em><em>]</em><em>, </em><em>optional</em>) – The limit of the y-axis.
Defaults to None.</p></li>
<li><p><strong>vlim</strong> (<em>Optional</em><em>[</em><em>tuple</em><em>[</em><em>int</em><em>, </em><em>int</em><em>]</em><em>]</em><em>, </em><em>optional</em>) – The limit of the v-axis.
Defaults to None.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">cube</span><span class="o">.</span><span class="n">cutout</span><span class="p">((</span><span class="mi">32</span><span class="p">,</span> <span class="mi">96</span><span class="p">),</span> <span class="p">(</span><span class="mi">32</span><span class="p">,</span> <span class="mi">96</span><span class="p">),</span> <span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">12</span><span class="p">))</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tokult.core.Cube.rms">
<span class="sig-name descname"><span class="pre">rms</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">is_originalsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tokult.core.Cube.rms" title="Permalink to this definition"></a></dt>
<dd><p>Compute the rms noise of the data cube.</p>
<p>Compute the rms noise using pixels outside of the region used for
<code class="docutils literal notranslate"><span class="pre">imageplane</span></code>, by assuming that the pixels are not affected by
any objects and reflect pure noises.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>is_originalsize</strong> (<em>bool</em><em>, </em><em>optional</em>) – If False, the computed rms noise is</p></li>
<li><p><strong>True</strong> (<em>limited at vlim</em><em> of </em><em>imageplane. If</em>) – </p></li>
<li><p><strong>is</strong> (<em>the rms noise</em>) – </p></li>
<li><p><strong>False.</strong> (<em>computed using the original-size data cube. Defaults to</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>the one-dimensional array containing the rms noises at
each pixel (channel) along the velocity axis.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">rms</span> <span class="o">=</span> <span class="n">cube</span><span class="o">.</span><span class="n">rms</span><span class="p">()</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This method may not return the correct rms if multiple objects are
detected in the Field of View.</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tokult.core.Cube.moment0">
<span class="sig-name descname"><span class="pre">moment0</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">is_originalsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tokult.core.Cube.moment0" title="Permalink to this definition"></a></dt>
<dd><p>Moment-0 (integrated-flux) map.</p>
<p>The moment-0 map is the flux map integrated along the velocity axis.
The default computed area is the one defined by <code class="docutils literal notranslate"><span class="pre">Cube.cutout()</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>is_originalsize</strong> (<em>bool</em><em>, </em><em>optional</em>) – If False, compute the moment-0 map
using the cutout region. If True, using the original-size data.
Defaults to False.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Two-dimensional moment-0 map.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">mom0</span> <span class="o">=</span> <span class="n">cube</span><span class="o">.</span><span class="n">moment0</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tokult.core.Cube.rms_moment0">
<span class="sig-name descname"><span class="pre">rms_moment0</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">is_originalsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tokult.core.Cube.rms_moment0" title="Permalink to this definition"></a></dt>
<dd><p>RMS noise of the moment 0 map.</p>
<p>RMS noise is computed using the region outside the cutout region, where
the object is located.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>is_originalsize</strong> (<em>bool</em><em>, </em><em>optional</em>) – If False, the moment-0 map is
computed using the cutout region. If True, using the original-
size data. Defaults to False.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>rms of the moment-0 map.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tokult.core.Cube.pixmoment1">
<span class="sig-name descname"><span class="pre">pixmoment1</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">thresh</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tokult.core.Cube.pixmoment1" title="Permalink to this definition"></a></dt>
<dd><p>Moment-1 (velocity) map.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>thresh</strong> (<em>float</em><em>, </em><em>optional</em>) – Threshold of the pixel values on the moment-</p></li>
<li><p><strong>threshold</strong> (<em>0 map. In the pixels below this</em>) – </p></li>
<li><p><strong>inserted.</strong> (<em>np.nan is</em>) – </p></li>
<li><p><strong>0.0.</strong> (<em>Defaults to</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Two-dimensional moment-1 map.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<p>To output pixels whose moment-0 values are two times higher than the
rms noise of the moment-0 map.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">mom1</span> <span class="o">=</span> <span class="n">cube</span><span class="o">.</span><span class="n">pixmoment1</span><span class="p">(</span><span class="n">thresh</span><span class="o">=</span><span class="mi">2</span> <span class="o">*</span> <span class="n">cube</span><span class="o">.</span><span class="n">rms_moment0</span><span class="p">())</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The units of the moment-1 map is <em>pixel</em>. You may change the units
by multiplying the results by the velocity-bin width.</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tokult.core.Cube.pixmoment2">
<span class="sig-name descname"><span class="pre">pixmoment2</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">thresh</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tokult.core.Cube.pixmoment2" title="Permalink to this definition"></a></dt>
<dd><p>Moment-2 (velocity-dispersion) map.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>thresh</strong> (<em>float</em><em>, </em><em>optional</em>) – Threshold of the pixel values on the moment-</p></li>
<li><p><strong>threshold</strong> (<em>0 map. In the pixels below this</em>) – </p></li>
<li><p><strong>inserted.</strong> (<em>np.nan is</em>) – </p></li>
<li><p><strong>0.0.</strong> (<em>Defaults to</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Two-dimensional moment-2 map.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<p>To output pixels whose moment-0 values are two times higher than the
rms noise of the moment-0 map.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">mom2</span> <span class="o">=</span> <span class="n">cube</span><span class="o">.</span><span class="n">pixmoment2</span><span class="p">(</span><span class="n">thresh</span><span class="o">=</span><span class="mi">2</span> <span class="o">*</span> <span class="n">cube</span><span class="o">.</span><span class="n">rms_moment0</span><span class="p">())</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The units of the moment-2 map is <em>pixel</em>. You may change the units
by multiplying the results by the velocity-bin width.</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tokult.core.Cube.noisy">
<span class="sig-name descname"><span class="pre">noisy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">rms</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">convolve</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">is_originalsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">uvcoverage</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rms_of_standardnoise</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tokult.core.Cube.noisy" title="Permalink to this definition"></a></dt>
<dd><p>Create a noisy mock data cube.</p>
<p>The noisy cube is created by adding noise to the contained 3D data cube.
This means that <code class="docutils literal notranslate"><span class="pre">convolve</span></code> should be the same as applied to the
contained data cube. This method is useful to perturb the data cube for
the Monte Carlo estiamtes of fitting errors.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>rms</strong> (<em>Union</em><em>[</em><em>float</em><em>, </em><em>np.ndarray</em><em>]</em>) – RMS of the added noise cube. The rms
is computed at each pixel (channel) along the velocity axis.</p></li>
<li><p><strong>convolve</strong> (<em>Optional</em><em>[</em><em>Callable</em><em>]</em><em>, </em><em>optional</em>) – Convolution function.
Defaults to None.</p></li>
<li><p><strong>seed</strong> (<em>Optional</em><em>[</em><em>int</em><em>]</em><em>, </em><em>optional</em>) – Random seed. Defaults to None.</p></li>
<li><p><strong>is_originalsize</strong> (<em>bool</em><em>, </em><em>optional</em>) – If False, the size of the noisy cube
the same as the cutout <code class="docutils literal notranslate"><span class="pre">imageplane</span></code>. If True, the cube is the
original size. Defaults to False.</p></li>
<li><p><strong>uvcoverage</strong> (<em>Optional</em><em>[</em><em>np.ndarray</em><em>]</em><em>, </em><em>optional</em>) – Mask on the uv plane. The
pixels with False are set to 0.0. Defaults to None.</p></li>
<li><p><strong>rms_of_standardnoise</strong> (<em>ndarray</em><em> | </em><em>None</em>) – </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tokult.core.Cube.rfft2">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">rfft2</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">zero_padding</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tokult.core.Cube.rfft2" title="Permalink to this definition"></a></dt>
<dd><p>Wrapper of misc.rfft2.</p>
<p>This method add the new argument <code class="docutils literal notranslate"><span class="pre">zero_padding</span></code> for observed data.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> (<em>np.ndarray</em>) – Data cube on the image plane.</p></li>
<li><p><strong>zero_padding</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, zero-padding the pixels with
<code class="docutils literal notranslate"><span class="pre">None</span></code>. Defaults to False.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Fourier-transformed data cube on the uv plane.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">uv</span> <span class="o">=</span> <span class="n">cube</span><span class="o">.</span><span class="n">rfft2</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="n">zero_padding</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tokult.core.Cube.create_noise">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">create_noise</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">rms</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shape</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">convolve</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">uvcoverage</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rms_of_standardnoise</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tokult.core.Cube.create_noise" title="Permalink to this definition"></a></dt>
<dd><p>Create a noise cube.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>rms</strong> (<em>Union</em><em>[</em><em>float</em><em>, </em><em>np.ndarray</em><em>]</em>) – RMS noise of the cube.</p></li>
<li><p><strong>shape</strong> (<em>tuple</em><em>[</em><em>int</em><em>, </em><em>...</em><em>]</em>) – Shape of the cube.</p></li>
<li><p><strong>convolve</strong> (<em>Optional</em><em>[</em><em>Callable</em><em>]</em><em>, </em><em>optional</em>) – Convolution function.
Defaults to None.</p></li>
<li><p><strong>seed</strong> (<em>Optional</em><em>[</em><em>int</em><em>]</em><em>, </em><em>optional</em>) – Random seed. Defaults to None.</p></li>
<li><p><strong>uvcoverage</strong> (<em>Optional</em><em>[</em><em>np.ndarray</em><em>]</em><em>, </em><em>optional</em>) – Mask on the uv plane.
Defaults to None.</p></li>
<li><p><strong>rms_of_standardnoise</strong> (<em>ndarray</em><em> | </em><em>None</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Noise cube.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">noise</span> <span class="o">=</span> <span class="n">cube</span><span class="o">.</span><span class="n">create_noise</span><span class="p">(</span><span class="n">rms</span><span class="p">,</span> <span class="n">shape</span><span class="p">,</span> <span class="n">func_convlution</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="tokult.core.DataCube">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">tokult.core.</span></span><span class="sig-name descname"><span class="pre">DataCube</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">imageplane</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">header</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xlim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ylim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vlim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tokult.core.DataCube" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#tokult.core.Cube" title="tokult.core.Cube"><code class="xref py py-class docutils literal notranslate"><span class="pre">Cube</span></code></a></p>
<p>Cube class to contain an observed datacube.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>imageplane</strong> (<em>np.ndarray</em>) – </p></li>
<li><p><strong>header</strong> (<em>Optional</em><em>[</em><em>fits.Header</em><em>]</em>) – </p></li>
<li><p><strong>xlim</strong> (<em>Optional</em><em>[</em><em>tuple</em><em>[</em><em>int</em><em>, </em><em>int</em><em>]</em><em>]</em>) – </p></li>
<li><p><strong>ylim</strong> (<em>Optional</em><em>[</em><em>tuple</em><em>[</em><em>int</em><em>, </em><em>int</em><em>]</em><em>]</em>) – </p></li>
<li><p><strong>vlim</strong> (<em>Optional</em><em>[</em><em>tuple</em><em>[</em><em>int</em><em>, </em><em>int</em><em>]</em><em>]</em>) – </p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="tokult.core.DataCube.perturbed">
<span class="sig-name descname"><span class="pre">perturbed</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">convolve</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">is_originalsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">uvcoverage</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rms_of_standardnoise</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tokult.core.DataCube.perturbed" title="Permalink to this definition"></a></dt>
<dd><p>Perturb the data cube with the same noise level and return it.</p>
<p>This method is useful to perturb the data cube for the Monte Carlo
estiamtes of fitting errors.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>convolve</strong> (<em>Optional</em><em>[</em><em>Callable</em><em>]</em><em>, </em><em>optional</em>) – Convolution function.
Defaults to None.</p></li>
<li><p><strong>seed</strong> (<em>Optional</em><em>[</em><em>int</em><em>]</em><em>, </em><em>optional</em>) – Random seed. Defaults to None.</p></li>
<li><p><strong>is_originalsize</strong> (<em>bool</em><em>, </em><em>optional</em>) – If False, the output is the
perturbed <code class="docutils literal notranslate"><span class="pre">imagepalne</span></code>. If True, the perturbed <code class="docutils literal notranslate"><span class="pre">original</span></code>
Defaults to False.</p></li>
<li><p><strong>uvcoverage</strong> (<em>Optional</em><em>[</em><em>np.ndarray</em><em>]</em><em>, </em><em>optional</em>) – Mask on the uv plane.
Defaults to None.</p></li>
<li><p><strong>rms_of_standardnoise</strong> (<em>ndarray</em><em> | </em><em>None</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Perturbed data cube.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">cube_perturbed</span> <span class="o">=</span> <span class="n">datacube</span><span class="o">.</span><span class="n">perturbed</span><span class="p">(</span><span class="n">convolve</span><span class="o">=</span><span class="n">func_fullconvolve</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tokult.core.DataCube.create">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">create</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data_or_fname</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">header</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">index_hdul</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tokult.core.DataCube.create" title="Permalink to this definition"></a></dt>
<dd><p>Constructer of <code class="docutils literal notranslate"><span class="pre">DataCube</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data_or_fname</strong> (<em>Union</em><em>[</em><em>np.ndarray</em><em>, </em><em>str</em><em>]</em>) – Data array or fits file name.</p></li>
<li><p><strong>header</strong> (<em>Optional</em><em>[</em><em>fits.Header</em><em>]</em><em>, </em><em>optional</em>) – Header of the fits file,
necessary if <code class="docutils literal notranslate"><span class="pre">data_or_fname</span></code> is a data array. Defaults to None.</p></li>
<li><p><strong>index_hdul</strong> (<em>int</em><em>, </em><em>optional</em>) – Index of fits extensions of the fits file.
Defaults to 0.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Data cube.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#tokult.core.DataCube" title="tokult.core.DataCube">DataCube</a></p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">datacube</span> <span class="o">=</span> <span class="n">DataCube</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="s1">&#39;data.fits&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>When the file name is give, the loaded data is squeezed; that is, the
axis with zero size is dropped. Specifically, the polarization axis of
the ALMA fits data may be dropped.</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tokult.core.DataCube.loadfits">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">loadfits</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fname</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">index_hdul</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tokult.core.DataCube.loadfits" title="Permalink to this definition"></a></dt>
<dd><p>Read a data cube from a fits file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>fname</strong> (<em>str</em>) – Fits file name.</p></li>
<li><p><strong>index_hdul</strong> (<em>int</em><em>, </em><em>optional</em>) – Index of fits extensions of the fits file.
Defaults to 0.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Tuple of the data and the fits header.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>tuple[np.ndarray, fits.Header]</p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>When the file name is give, the loaded data is squeezed; that is, the
axis with zero size is dropped. Specifically, the polarization axis of
the ALMA fits data may be dropped.</p>
</div>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="tokult.core.ModelCube">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">tokult.core.</span></span><span class="sig-name descname"><span class="pre">ModelCube</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">imageplane</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">raw</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xlim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ylim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vlim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tokult.core.ModelCube" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#tokult.core.Cube" title="tokult.core.Cube"><code class="xref py py-class docutils literal notranslate"><span class="pre">Cube</span></code></a></p>
<p>Cube class to contain a modeled datacube.</p>
<p>This class is especially for the best-fit model cube.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>imageplane</strong> (<em>np.ndarray</em>) – </p></li>
<li><p><strong>raw</strong> (<em>Optional</em><em>[</em><em>np.ndarray</em><em>]</em>) – </p></li>
<li><p><strong>xlim</strong> (<em>Optional</em><em>[</em><em>tuple</em><em>[</em><em>int</em><em>, </em><em>int</em><em>]</em><em>]</em>) – </p></li>
<li><p><strong>ylim</strong> (<em>Optional</em><em>[</em><em>tuple</em><em>[</em><em>int</em><em>, </em><em>int</em><em>]</em><em>]</em>) – </p></li>
<li><p><strong>vlim</strong> (<em>Optional</em><em>[</em><em>tuple</em><em>[</em><em>int</em><em>, </em><em>int</em><em>]</em><em>]</em>) – </p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="tokult.core.ModelCube.create">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">create</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">params</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">datacube</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lensing</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">convolve</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">create_interpolate_lensing</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">upsampling_rate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(1,</span> <span class="pre">1,</span> <span class="pre">1)</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tokult.core.ModelCube.create" title="Permalink to this definition"></a></dt>
<dd><p>Constructer of <code class="docutils literal notranslate"><span class="pre">ModelCube</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>params</strong> (<em>tuple</em><em>[</em><em>float</em><em>, </em><em>...</em><em>]</em>) – Input parameters.</p></li>
<li><p><strong>datacube</strong> (<a class="reference internal" href="#tokult.core.DataCube" title="tokult.core.DataCube"><em>DataCube</em></a>) – Data cube. The size of the model cube is based on
this data cube.</p></li>
<li><p><strong>lensing</strong> (<em>Optional</em><em>[</em><em>Callable</em><em>]</em><em>, </em><em>optional</em>) – Lensing function.
Defaults to None.</p></li>
<li><p><strong>convolve</strong> (<em>Optional</em><em>[</em><em>Callable</em><em>]</em><em>, </em><em>optional</em>) – Convolving function.
Defaults to None.</p></li>
<li><p><strong>create_interpolate_lensing</strong> (<em>Callable</em><em> | </em><em>None</em>) – </p></li>
<li><p><strong>upsampling_rate</strong> (<em>tuple</em><em>[</em><em>int</em><em>, </em><em>...</em><em>]</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Model cube.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#tokult.core.ModelCube" title="tokult.core.ModelCube">ModelCube</a></p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">model</span> <span class="o">=</span> <span class="n">ModelCube</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="n">params</span><span class="p">,</span> <span class="n">tok</span><span class="o">.</span><span class="n">datacube</span><span class="p">,</span>
<span class="go">                             lensing=tok.gravlens.lensing,</span>
<span class="go">                             convolve=tok.dirtybeam.fullconvolve)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tokult.core.ModelCube.to_mockcube">
<span class="sig-name descname"><span class="pre">to_mockcube</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">rms</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">convolve</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">is_originalsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">uvcoverage</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tokult.core.ModelCube.to_mockcube" title="Permalink to this definition"></a></dt>
<dd><p>Convert to and output noisy mock cube.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>rms</strong> (<em>Union</em><em>[</em><em>float</em><em>, </em><em>np.ndarray</em><em>]</em>) – RMS noise added to the model cube,
after convolution.</p></li>
<li><p><strong>convolve</strong> (<em>Optional</em><em>[</em><em>Callable</em><em>]</em><em>, </em><em>optional</em>) – Convolution function. This
convolve both <em>raw</em> model cube and noise. Defaults to None.</p></li>
<li><p><strong>seed</strong> (<em>Optional</em><em>[</em><em>int</em><em>]</em><em>, </em><em>optional</em>) – Random seed. Defaults to None.</p></li>
<li><p><strong>is_originalsize</strong> (<em>bool</em><em>, </em><em>optional</em>) – If False, the output mock cube is
the same size as <code class="docutils literal notranslate"><span class="pre">imageplane</span></code>. If True, the size is the same
as <code class="docutils literal notranslate"><span class="pre">original</span></code>. Defaults to False.</p></li>
<li><p><strong>uvcoverage</strong> (<em>Optional</em><em>[</em><em>np.ndarray</em><em>]</em><em>, </em><em>optional</em>) – Mask on the uv plane.
Defaults to None.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Mock data cube.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">mock</span> <span class="o">=</span> <span class="n">modelcube</span><span class="o">.</span><span class="n">to_mockcube</span><span class="p">(</span>
<span class="go">               tok.datacube.rms(),</span>
<span class="go">               tok.dirtybeam.fullconvolve,</span>
<span class="go">               is_original=True)</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="tokult.core.DirtyBeam">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">tokult.core.</span></span><span class="sig-name descname"><span class="pre">DirtyBeam</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">beam</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">header</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tokult.core.DirtyBeam" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Contains dirtybeam, i.e., Point Spread Functions (PSF) of Cube.</p>
<p>Contained data is dirtybeam images as a function of frequency.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>beam</strong> (<em>np.ndarray</em>) – </p></li>
<li><p><strong>header</strong> (<em>Optional</em><em>[</em><em>fits.Header</em><em>]</em>) – </p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="tokult.core.DirtyBeam.create">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">create</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data_or_fname</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">header</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">index_hdul</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tokult.core.DirtyBeam.create" title="Permalink to this definition"></a></dt>
<dd><p>Constructer of <code class="docutils literal notranslate"><span class="pre">DirtyBeam</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data_or_fname</strong> (<em>Union</em><em>[</em><em>np.ndarray</em><em>, </em><em>str</em><em>]</em>) – Data array or fits file name.</p></li>
<li><p><strong>header</strong> (<em>Optional</em><em>[</em><em>fits.Header</em><em>]</em><em>, </em><em>optional</em>) – Header of the fits file.
Defaults to None.</p></li>
<li><p><strong>index_hdul</strong> (<em>int</em><em>, </em><em>optional</em>) – Index of fits extensions of the fits file.
Defaults to 0.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>instance of <code class="docutils literal notranslate"><span class="pre">DirtyBeam</span></code>.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#tokult.core.DirtyBeam" title="tokult.core.DirtyBeam">DirtyBeam</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tokult.core.DirtyBeam.convolve">
<span class="sig-name descname"><span class="pre">convolve</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">image</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tokult.core.DirtyBeam.convolve" title="Permalink to this definition"></a></dt>
<dd><p>Convolve <code class="docutils literal notranslate"><span class="pre">imageplane</span></code> with dirtybeam (psf) in two dimension.</p>
<p>Perform two-dimensional convolution at each pixel (channel) along the
velocity axis.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>image</strong> (<em>np.ndarray</em>) – Image to be convolved. Note that the size must be
the same as the attribute <code class="docutils literal notranslate"><span class="pre">imageplane</span></code>.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>2D-convolved cube.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">convolved_image</span> <span class="o">=</span> <span class="n">dirtybeam</span><span class="o">.</span><span class="n">convole</span><span class="p">(</span><span class="n">image</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tokult.core.DirtyBeam.fullconvolve">
<span class="sig-name descname"><span class="pre">fullconvolve</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">image</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">uvcoverage</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">is_noise</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tokult.core.DirtyBeam.fullconvolve" title="Permalink to this definition"></a></dt>
<dd><p>Convolve <code class="docutils literal notranslate"><span class="pre">original</span></code> with dirtybeam (psf) in two dimension.</p>
<p>Difference between <code class="docutils literal notranslate"><span class="pre">convolve()</span></code> and <code class="docutils literal notranslate"><span class="pre">fullconvolve()</span></code> is the size of
the input <code class="docutils literal notranslate"><span class="pre">image</span></code>. This method <code class="docutils literal notranslate"><span class="pre">fullconvolve</span></code> treat the image with the
same size as the <code class="docutils literal notranslate"><span class="pre">dirtybeam.original</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>image</strong> (<em>np.ndarray</em>) – Image to be convolved. Note that the size must be
the same as the attribute <code class="docutils literal notranslate"><span class="pre">original</span></code>.</p></li>
<li><p><strong>uvcoverage</strong> (<em>Optional</em><em>[</em><em>np.ndarray</em><em>]</em><em>, </em><em>optional</em>) – Mask on the uv plane.
Defaults to None.</p></li>
<li><p><strong>is_noise</strong> (<em>bool</em><em>, </em><em>optional</em>) – True if <code class="docutils literal notranslate"><span class="pre">image</span></code> is data. False if noise.
Defaults to False.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>2D-convolved cube.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">convolved_image</span> <span class="o">=</span> <span class="n">dirtybeam</span><span class="o">.</span><span class="n">fullconvole</span><span class="p">(</span><span class="n">tok</span><span class="o">.</span><span class="n">modelcube</span><span class="o">.</span><span class="n">raw</span><span class="p">)</span>
</pre></div>
</div>
<p>How to create convolved noise.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">rng</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">default_rng</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">noise</span> <span class="o">=</span> <span class="n">rng</span><span class="o">.</span><span class="n">standard_normal</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="n">shape</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">noise</span> <span class="o">=</span> <span class="n">dirtybeam</span><span class="o">.</span><span class="n">fullconvolve</span><span class="p">(</span>
<span class="go">                noise, uvcoverage=uvcoverage, is_noise=True)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tokult.core.DirtyBeam.cutout">
<span class="sig-name descname"><span class="pre">cutout</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">xlim</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ylim</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vlim</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tokult.core.DirtyBeam.cutout" title="Permalink to this definition"></a></dt>
<dd><p>Cutout a cubic region from the dirty beam cube.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>xlim</strong> (<em>Union</em><em>[</em><em>tuple</em><em>[</em><em>int</em><em>, </em><em>int</em><em>]</em><em>, </em><em>slice</em><em>]</em>) – The limit of the x-axis.</p></li>
<li><p><strong>ylim</strong> (<em>Union</em><em>[</em><em>tuple</em><em>[</em><em>int</em><em>, </em><em>int</em><em>]</em><em>, </em><em>slice</em><em>]</em>) – The limit of the y-axis.</p></li>
<li><p><strong>vlim</strong> (<em>Union</em><em>[</em><em>tuple</em><em>[</em><em>int</em><em>, </em><em>int</em><em>]</em><em>, </em><em>slice</em><em>]</em>) – The limit of the v-axis.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tokult.core.DirtyBeam.cutout_to_match_with">
<span class="sig-name descname"><span class="pre">cutout_to_match_with</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cube</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tokult.core.DirtyBeam.cutout_to_match_with" title="Permalink to this definition"></a></dt>
<dd><p>Cutout a region with the same size of the input <code class="docutils literal notranslate"><span class="pre">cube</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>cube</strong> (<a class="reference internal" href="#tokult.core.DataCube" title="tokult.core.DataCube"><em>DataCube</em></a>) – Datacube. The size of <code class="docutils literal notranslate"><span class="pre">cube.original</span></code> must be the
same as the <code class="docutils literal notranslate"><span class="pre">dirtybeam.original</span></code>. This method makes the size of
the <code class="docutils literal notranslate"><span class="pre">dirtybeam.imageplane</span></code> the same as <code class="docutils literal notranslate"><span class="pre">cube.imageplane</span></code>.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tokult.core.DirtyBeam.loadfits">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">loadfits</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fname</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">index_hdul</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tokult.core.DirtyBeam.loadfits" title="Permalink to this definition"></a></dt>
<dd><p>Read the dirty beam from a fits file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>fname</strong> (<em>str</em>) – Fits file name.</p></li>
<li><p><strong>index_hdul</strong> (<em>int</em><em>, </em><em>optional</em>) – Index of fits extensions of the fits file.
Defaults to 0.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Tuple of the data and the fits header.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>tuple[np.ndarray, fits.Header]</p>
</dd>
</dl>
<div class="admonition caution">
<p class="admonition-title">Caution</p>
<p>The data shape of <code class="docutils literal notranslate"><span class="pre">DirtyBeam</span></code> must be the same as the <code class="docutils literal notranslate"><span class="pre">Datacube</span></code>.
This requirement is naturaly satisfied if the input dirty-beam and
the image-cube fits files are simulationsly created with CASA.</p>
</div>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="tokult.core.GravLens">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">tokult.core.</span></span><span class="sig-name descname"><span class="pre">GravLens</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x_arcsec_deflect</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_arcsec_deflect</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">header</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z_source</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z_lens</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z_assumed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tokult.core.GravLens" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Deal with gravitational lensing effects based on a given lens models.</p>
<p>Contents are lensing parameters depending on positions.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x_arcsec_deflect</strong> (<em>np.ndarray</em>) – </p></li>
<li><p><strong>y_arcsec_deflect</strong> (<em>np.ndarray</em>) – </p></li>
<li><p><strong>header</strong> (<em>fits.Header</em>) – </p></li>
<li><p><strong>z_source</strong> (<em>Optional</em><em>[</em><em>float</em><em>]</em>) – </p></li>
<li><p><strong>z_lens</strong> (<em>Optional</em><em>[</em><em>float</em><em>]</em>) – </p></li>
<li><p><strong>z_assumed</strong> (<em>Optional</em><em>[</em><em>float</em><em>]</em>) – </p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="tokult.core.GravLens.create">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">create</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_or_fname_xy_arcsec_deflect</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_or_fname_xy_pixel_deflect</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_or_fname_psi_arcsec</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">header</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">index_hdul</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z_source</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z_lens</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z_assumed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">inf</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tokult.core.GravLens.create" title="Permalink to this definition"></a></dt>
<dd><p>Constructer of <code class="docutils literal notranslate"><span class="pre">GravLens</span></code>.</p>
<p>Either of the first three arguments are required to construct <code class="docutils literal notranslate"><span class="pre">GravLens</span></code>.
If more thean one among the three are given, the earier argument take a priority
(i.e., xy_arcsec_deflect &gt; xy_pixel_deflect &gt; psi_arcsec).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>(</strong><strong>Optional</strong><strong>[</strong><strong>Union</strong><strong>[</strong><strong>tuple</strong><strong>[</strong><strong>np.ndarray</strong> (<em>data_or_fname_xy_arcsec_deflect</em>) – tuple[str, …]]]): Tuple of the data arrays or fits file names of
lensing parmeters, x-arcsec-deflect and y-arcsec-deflect.
Defaults to None.</p></li>
<li><p><strong>...</strong><strong>]</strong> – tuple[str, …]]]): Tuple of the data arrays or fits file names of
lensing parmeters, x-arcsec-deflect and y-arcsec-deflect.
Defaults to None.</p></li>
<li><p><strong>data_or_fname_xy_arcsec_deflect</strong> (<em>tuple</em><em>[</em><em>numpy.ndarray</em><em>, </em><em>...</em><em>] </em><em>| </em><em>tuple</em><em>[</em><em>str</em><em>, </em><em>...</em><em>] </em><em>| </em><em>None</em>) – </p></li>
<li><p><strong>data_or_fname_xy_pixel_deflect</strong> (<em>tuple</em><em>[</em><em>numpy.ndarray</em><em>, </em><em>...</em><em>] </em><em>| </em><em>tuple</em><em>[</em><em>str</em><em>, </em><em>...</em><em>] </em><em>| </em><em>None</em>) – </p></li>
<li><p><strong>data_or_fname_psi_arcsec</strong> (<em>ndarray</em><em> | </em><em>str</em><em> | </em><em>None</em>) – </p></li>
<li><p><strong>header</strong> (<em>Header</em><em> | </em><em>None</em>) – </p></li>
<li><p><strong>index_hdul</strong> (<em>int</em>) – </p></li>
<li><p><strong>z_source</strong> (<em>float</em><em> | </em><em>None</em>) – </p></li>
<li><p><strong>z_lens</strong> (<em>float</em><em> | </em><em>None</em>) – </p></li>
<li><p><strong>z_assumed</strong> (<em>float</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="#tokult.core.GravLens" title="tokult.core.GravLens"><em>GravLens</em></a></p>
</dd>
</dl>
<dl class="simple">
<dt>:param<span class="classifier">tuple[str, …]]]): Tuple of the data arrays or fits file names of</span></dt><dd><p>lensing parmeters, x-arcsec-deflect and y-arcsec-deflect.
Defaults to None.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>(</strong><strong>Optional</strong><strong>[</strong><strong>Union</strong><strong>[</strong><strong>tuple</strong><strong>[</strong><strong>np.ndarray</strong> (<em>data_or_fname_xy_pixel_deflect</em>) – tuple[str, …]]]): Tuple of the data arrays or fits file names of
lensing parmeters, x-pixel-deflect and y-pixel-deflect.
Defaults to None.</p></li>
<li><p><strong>...</strong><strong>]</strong> – tuple[str, …]]]): Tuple of the data arrays or fits file names of
lensing parmeters, x-pixel-deflect and y-pixel-deflect.
Defaults to None.</p></li>
<li><p><strong>data_or_fname_xy_arcsec_deflect</strong> (<em>tuple</em><em>[</em><em>numpy.ndarray</em><em>, </em><em>...</em><em>] </em><em>| </em><em>tuple</em><em>[</em><em>str</em><em>, </em><em>...</em><em>] </em><em>| </em><em>None</em>) – </p></li>
<li><p><strong>data_or_fname_xy_pixel_deflect</strong> (<em>tuple</em><em>[</em><em>numpy.ndarray</em><em>, </em><em>...</em><em>] </em><em>| </em><em>tuple</em><em>[</em><em>str</em><em>, </em><em>...</em><em>] </em><em>| </em><em>None</em>) – </p></li>
<li><p><strong>data_or_fname_psi_arcsec</strong> (<em>ndarray</em><em> | </em><em>str</em><em> | </em><em>None</em>) – </p></li>
<li><p><strong>header</strong> (<em>Header</em><em> | </em><em>None</em>) – </p></li>
<li><p><strong>index_hdul</strong> (<em>int</em>) – </p></li>
<li><p><strong>z_source</strong> (<em>float</em><em> | </em><em>None</em>) – </p></li>
<li><p><strong>z_lens</strong> (<em>float</em><em> | </em><em>None</em>) – </p></li>
<li><p><strong>z_assumed</strong> (<em>float</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="#tokult.core.GravLens" title="tokult.core.GravLens"><em>GravLens</em></a></p>
</dd>
</dl>
<dl class="simple">
<dt>:param<span class="classifier">tuple[str, …]]]): Tuple of the data arrays or fits file names of</span></dt><dd><p>lensing parmeters, x-pixel-deflect and y-pixel-deflect.
Defaults to None.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data_or_fname_psi_arcsec</strong> (<em>Optional</em><em>[</em><em>Union</em><em>[</em><em>np.ndarray</em><em>, </em><em>str</em><em>]</em><em>]</em>) – Data array
or fits file name of a lensing parmeter, psi. Note that this method
compute the gradient of psi to obtain the deflection angles, so that
significantly strong gravitational lensing might not be traced by psi.
Defaults to None.</p></li>
<li><p><strong>header</strong> (<em>Optional</em><em>[</em><em>fits.Header</em><em>]</em><em>, </em><em>optional</em>) – Header of the fits file.
This method assumes that lensing parameter maps, x-arcsec-deflect and
y-arcsec-deflect, have the same size and coordinates. Defaults to None.</p></li>
<li><p><strong>index_hdul</strong> (<em>int</em><em>, </em><em>optional</em>) – Index of fits extensions of the fits file.
Defaults to 0.</p></li>
<li><p><strong>z_source</strong> (<em>Optional</em><em>[</em><em>float</em><em>]</em><em>, </em><em>optional</em>) – The source (galaxy) redshift.
Defaults to None.</p></li>
<li><p><strong>z_lens</strong> (<em>Optional</em><em>[</em><em>float</em><em>]</em><em>, </em><em>optional</em>) – The lens (cluster) redshift.
Defaults to None.</p></li>
<li><p><strong>z_assumed</strong> (<em>float</em><em>, </em><em>optional</em>) – The redshift assumed in the gravitational
parameters. If D_s / D_L = 1, the value should be infinite (<code class="docutils literal notranslate"><span class="pre">np.inf</span></code>).
Defaults to np.inf.</p></li>
<li><p><strong>data_or_fname_xy_arcsec_deflect</strong> (<em>tuple</em><em>[</em><em>numpy.ndarray</em><em>, </em><em>...</em><em>] </em><em>| </em><em>tuple</em><em>[</em><em>str</em><em>, </em><em>...</em><em>] </em><em>| </em><em>None</em>) – </p></li>
<li><p><strong>data_or_fname_xy_pixel_deflect</strong> (<em>tuple</em><em>[</em><em>numpy.ndarray</em><em>, </em><em>...</em><em>] </em><em>| </em><em>tuple</em><em>[</em><em>str</em><em>, </em><em>...</em><em>] </em><em>| </em><em>None</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Instance of <code class="docutils literal notranslate"><span class="pre">GravLens</span></code>.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#tokult.core.GravLens" title="tokult.core.GravLens">GravLens</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tokult.core.GravLens.lensing">
<span class="sig-name descname"><span class="pre">lensing</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">xgrid</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ygrid</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tokult.core.GravLens.lensing" title="Permalink to this definition"></a></dt>
<dd><p>Convert coordinates (x, y) from the image plane to the source plane.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>xgrid</strong> (<em>np.ndarray</em>) – Array of the x coordinates on the image plane.</p></li>
<li><p><strong>ygrid</strong> (<em>np.ndarray</em>) – Array of the y coordinates on the image plane.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Tuple of coordinates on the source plane.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>tuple[np.ndarray, …]</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">xx_source</span><span class="p">,</span> <span class="n">yy_source</span> <span class="o">=</span> <span class="n">lensing</span><span class="p">(</span><span class="n">xx_image</span><span class="p">,</span> <span class="n">yy_image</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tokult.core.GravLens.create_interpolate_lensing">
<span class="sig-name descname"><span class="pre">create_interpolate_lensing</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">xgrid</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ygrid</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tokult.core.GravLens.create_interpolate_lensing" title="Permalink to this definition"></a></dt>
<dd><p>Retrun a LensingInterpolate instance.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>xgrid</strong> (<em>np.ndarray</em>) – 2D array of the x coordinate.</p></li>
<li><p><strong>ygrid</strong> (<em>np.ndarray</em>) – 2D array of the y coordinate.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>[description]</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#tokult.core.GravLens.LensingInterpolate" title="tokult.core.GravLens.LensingInterpolate">LensingInterpolate</a></p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">lensing_interp</span> <span class="o">=</span> <span class="n">gl</span><span class="o">.</span><span class="n">create_interpolate_lensing</span><span class="p">(</span><span class="n">xgrid</span><span class="p">,</span> <span class="n">ygrid</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x0_s</span><span class="p">,</span> <span class="n">y0_s</span> <span class="o">=</span> <span class="n">lensing_interp</span><span class="p">(</span><span class="n">x0_i</span><span class="p">,</span> <span class="n">y0_i</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="tokult.core.GravLens.LensingInterpolate">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">LensingInterpolate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">xx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">yy</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x_pixel_deflect</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_pixel_deflect</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tokult.core.GravLens.LensingInterpolate" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Interpolate lensing effects to a data point.</p>
<p>This class method is implemented to convert the center of the model disk to
the image plane.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>xx</strong> (<em>np.ndarray</em>) – </p></li>
<li><p><strong>yy</strong> (<em>np.ndarray</em>) – </p></li>
<li><p><strong>x_pixel_deflect</strong> (<em>np.ndarray</em>) – </p></li>
<li><p><strong>y_pixel_deflect</strong> (<em>np.ndarray</em>) – </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tokult.core.GravLens.match_wcs_with">
<span class="sig-name descname"><span class="pre">match_wcs_with</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cube</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tokult.core.GravLens.match_wcs_with" title="Permalink to this definition"></a></dt>
<dd><p>Match the world coordinate system with the input data cube.</p>
<p>Use the wcs of <code class="docutils literal notranslate"><span class="pre">cube.imageplane</span></code>; therefore, the matched lensing
parameter map become smaller than the original map.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>cube</strong> (<a class="reference internal" href="#tokult.core.DataCube" title="tokult.core.DataCube"><em>DataCube</em></a>) – <code class="docutils literal notranslate"><span class="pre">DataCube</span></code> including the header information. This
method uses the wcs included in the header of the data cube and
the <code class="docutils literal notranslate"><span class="pre">GravLens</span></code> instance.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">gravlens</span><span class="o">.</span><span class="n">match_wcs_with</span><span class="p">(</span><span class="n">datacube</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tokult.core.GravLens.use_redshifts">
<span class="sig-name descname"><span class="pre">use_redshifts</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">z_source</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z_lens</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z_assumed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">inf</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tokult.core.GravLens.use_redshifts" title="Permalink to this definition"></a></dt>
<dd><p>Correct the lensing parameters using the redshifts.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>z_source</strong> (<em>float</em>) – The source (galaxy) redshift.</p></li>
<li><p><strong>z_lens</strong> (<em>float</em>) – The lens (cluster) redshift.</p></li>
<li><p><strong>z_assumed</strong> (<em>float</em><em>, </em><em>optional</em>) – The redshift assumed in the
gravitational parameters. If D_s / D_L = 1, the value
should be infinite (<code class="docutils literal notranslate"><span class="pre">np.inf</span></code>). Defaults to <code class="docutils literal notranslate"><span class="pre">np.inf</span></code>.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tokult.core.GravLens.reset_redshifts">
<span class="sig-name descname"><span class="pre">reset_redshifts</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#tokult.core.GravLens.reset_redshifts" title="Permalink to this definition"></a></dt>
<dd><p>Reset the redshift infomation.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tokult.core.GravLens.compute_deflection_angles">
<span class="sig-name descname"><span class="pre">compute_deflection_angles</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#tokult.core.GravLens.compute_deflection_angles" title="Permalink to this definition"></a></dt>
<dd><p>Compute deflection angles in arcsec and pixels using redshifts</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tokult.core.GravLens.convert_xy_arcsec_to_pixel">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">convert_xy_arcsec_to_pixel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x_arcsec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_arcsec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">header</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tokult.core.GravLens.convert_xy_arcsec_to_pixel" title="Permalink to this definition"></a></dt>
<dd><p>Convert deflection angles of x and y in arcsec to in pixels.</p>
<p>Use the internal header “CDELT” for the conversion.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x_arcsec</strong> (<em>np.ndarray</em>) – Deflection angle of x given in arcsec.</p></li>
<li><p><strong>y_arcsec</strong> (<em>np.ndarray</em>) – Deflection angle of y given in arcsec.</p></li>
<li><p><strong>header</strong> (<em>fits.Header</em>) – Header including units information</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>Tuple of the deflection angles of x</dt><dd><p>and y in pixels.</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>tuple[np.ndarray, np.ndarray]</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">x_pix</span><span class="p">,</span> <span class="n">y_pix</span> <span class="o">=</span> <span class="n">gl</span><span class="o">.</span><span class="n">convert_xy_arcsec_to_pixel</span><span class="p">(</span><span class="n">x_arcsec</span><span class="p">,</span> <span class="n">y_arcsec</span><span class="p">)</span>
</pre></div>
</div>
<dl class="simple">
<dt>Nonte:</dt><dd><p>Assumes that the units of “CDELT1” and “CDELT2” are degree.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tokult.core.GravLens.convert_xy_pixel_to_arcsec">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">convert_xy_pixel_to_arcsec</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x_pixel</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_pixel</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">header</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tokult.core.GravLens.convert_xy_pixel_to_arcsec" title="Permalink to this definition"></a></dt>
<dd><p>Convert deflection angles of x and y in pixel to in arcsec.</p>
<p>Use the internal header “CDELT” for the conversion.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x_pixel</strong> (<em>np.ndarray</em>) – Deflection angle of x given in pixel.</p></li>
<li><p><strong>y_pixel</strong> (<em>np.ndarray</em>) – Deflection angle of y given in pixel.</p></li>
<li><p><strong>header</strong> (<em>fits.Header</em>) – Header including units information.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>Tuple of the deflection angles of x</dt><dd><p>and y in arcsec.</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>tuple[np.ndarray, np.ndarray]</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">x_arcsec</span><span class="p">,</span> <span class="n">y_arcsec</span> <span class="o">=</span> <span class="n">gl</span><span class="o">.</span><span class="n">convert_xy_pixel_to_arcsec</span><span class="p">(</span><span class="n">x_pix</span><span class="p">,</span> <span class="n">y_pix</span><span class="p">,</span> <span class="n">header</span><span class="p">)</span>
</pre></div>
</div>
<dl class="simple">
<dt>Nonte:</dt><dd><p>Assumes that the units of “CDELT1” and “CDELT2” are degree.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tokult.core.GravLens.gradient">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">gradient</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">psi</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">header</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tokult.core.GravLens.gradient" title="Permalink to this definition"></a></dt>
<dd><p>Compute gradient of 2D image.</p>
<p>This method is used to compute deflection angles from the deflection
potential psi.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>psi</strong> (<em>np.ndarray</em>) – 2D image of the deflection potential. The units are
given in arcsec, meaning that differentiation of psi with respect
to the angle in arcsec gives the deflection angles in arcsec.</p></li>
<li><p><strong>header</strong> (<em>fits.Header</em>) – Header including units information.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>Tuple of the deflection angles of y</dt><dd><p>and x. Note that the order is (y, x).</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>tuple[np.ndarray, np.ndarray]</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">y_arcsec</span><span class="p">,</span> <span class="n">x_arcsec</span> <span class="o">=</span> <span class="n">gl</span><span class="o">.</span><span class="n">gradient</span><span class="p">(</span><span class="n">psi</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="n">header</span><span class="p">)</span>
</pre></div>
</div>
<dl class="simple">
<dt>Nonte:</dt><dd><p>Assumes that the units of “CDELT1” and “CDELT2” are degree.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tokult.core.GravLens.get_angular_distance_ratio">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">get_angular_distance_ratio</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">z_source</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z_lens</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z_assumed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">inf</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tokult.core.GravLens.get_angular_distance_ratio" title="Permalink to this definition"></a></dt>
<dd><p>Angular distance ratio of D_LS to D_S, normalized by assumed D_LS/D_S.</p>
<p>Lensing parameter maps are distributed using some D_LS/D_S at specific
redshifts. This method provides a new factor that can be multiplied by
the lensing parameter maps to correct the redshift dependency.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>z_source</strong> (<em>float</em>) – The source (galaxy) redshift.</p></li>
<li><p><strong>z_lens</strong> (<em>float</em>) – The lens (cluster) redshift.</p></li>
<li><p><strong>z_assumed</strong> (<em>float</em><em>, </em><em>optional</em>) – The redshift assumed in the
gravitational parameters. If D_s / D_L = 1, the value
should be infinite (<code class="docutils literal notranslate"><span class="pre">np.inf</span></code>). Defaults to <code class="docutils literal notranslate"><span class="pre">np.inf</span></code>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Angular distance ratio, D_LS/D_S</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">distance_ratio</span> <span class="o">=</span> <span class="n">gravlens</span><span class="o">.</span><span class="n">get_angular_distance_ratio</span><span class="p">(</span><span class="mf">6.2</span><span class="p">,</span> <span class="mf">0.9</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x_deflect_new</span> <span class="o">=</span> <span class="n">x_deflect_old</span> <span class="o">*</span> <span class="n">distance_ratio</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tokult.core.GravLens.loadfits">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">loadfits</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fname_x_deflect</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fname_y_deflect</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">index_hdul</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tokult.core.GravLens.loadfits" title="Permalink to this definition"></a></dt>
<dd><p>Read gravlens from fits file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>fname_x_deflect</strong> (<em>str</em>) – Fits file name of the deflect map of x.</p></li>
<li><p><strong>fname_y_deflect</strong> (<em>str</em>) – Fits file name of the deflect map of y.</p></li>
<li><p><strong>index_hdul</strong> (<em>int</em><em>, </em><em>optional</em>) – Index of fits extensions of the fits file.
Assumes that all the fits files include the lensing parameter maps
at the same extension index. Defaults to 0.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>Tuple of three objects;</dt><dd><p>deflection angles (x and y) and header.</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>tuple[np.ndarray, np.ndarray, fits.Header]</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="module-tokult.example">
<span id="tokult-example-module"></span><h2>tokult.example module<a class="headerlink" href="#module-tokult.example" title="Permalink to this heading"></a></h2>
<p>example documents</p>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="modules.html" class="btn btn-neutral float-left" title="tokult" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2022, sugayu.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>